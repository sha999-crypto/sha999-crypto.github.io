<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/title.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="RSA介绍 数学基础 RSA算法是现今使用最广泛的公钥密码算法，也是号称地球上最安全的加密算法。 模运算与同余式 两个整数a，b，若它们除以正整数m所得的余数相等，则称a，b对于模m同余，记作: a ≡ b mod m；例如：26 ≡ 14 mod 12。">
<meta property="og:type" content="article">
<meta property="og:title" content="螺丝网安工作室第二次例会：RSA">
<meta property="og:url" content="http://example.com/2022/06/01/%E8%9E%BA%E4%B8%9D%E7%BD%91%E5%AE%89%E5%B7%A5%E4%BD%9C%E5%AE%A4%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BE%8B%E4%BC%9A%EF%BC%9ARSA/index.html">
<meta property="og:site_name" content="sha &amp; CTF记录">
<meta property="og:description" content="RSA介绍 数学基础 RSA算法是现今使用最广泛的公钥密码算法，也是号称地球上最安全的加密算法。 模运算与同余式 两个整数a，b，若它们除以正整数m所得的余数相等，则称a，b对于模m同余，记作: a ≡ b mod m；例如：26 ≡ 14 mod 12。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-06-01T08:56:14.000Z">
<meta property="article:modified_time" content="2022-06-01T15:51:47.949Z">
<meta property="article:author" content="sha&amp;blog">
<meta property="article:tag" content="RSA">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2022/06/01/%E8%9E%BA%E4%B8%9D%E7%BD%91%E5%AE%89%E5%B7%A5%E4%BD%9C%E5%AE%A4%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BE%8B%E4%BC%9A%EF%BC%9ARSA/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>螺丝网安工作室第二次例会：RSA | sha & CTF记录</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">sha & CTF记录</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">一个密码学菜狗</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/01/%E8%9E%BA%E4%B8%9D%E7%BD%91%E5%AE%89%E5%B7%A5%E4%BD%9C%E5%AE%A4%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BE%8B%E4%BC%9A%EF%BC%9ARSA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/111.jpg">
      <meta itemprop="name" content="sha&blog">
      <meta itemprop="description" content="请务必休息一天">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="sha & CTF记录">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          螺丝网安工作室第二次例会：RSA
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-06-01 16:56:14 / 修改时间：23:51:47" itemprop="dateCreated datePublished" datetime="2022-06-01T16:56:14+08:00">2022-06-01</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Crypto/" itemprop="url" rel="index"><span itemprop="name">Crypto</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>28k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>31 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="rsa介绍">RSA介绍</h1>
<h2 id="数学基础">数学基础</h2>
<p>RSA算法是现今使用最广泛的公钥密码算法，也是号称地球上最安全的加密算法。</p>
<h3 id="模运算与同余式">模运算与同余式</h3>
<p>两个整数a，b，若它们除以正整数m所得的余数相等，则称a，b对于模m同余，记作: a ≡ b mod m；例如：26 ≡ 14 mod 12。</p>
<span id="more"></span>
<h3 id="互质关系">互质关系</h3>
<p>如果两个正整数，除了1以外，没有其他公因子，我们就称这两个数是互质关系。比如，15和32没有公因子，所以它们是互质关系。这说明，不是质数也可以构成互质关系。</p>
<h3 id="欧拉函数">欧拉函数</h3>
<p>φ(n)的值表示小于等于n的正整数之中，有多少个数与n构成互质关系。</p>
<ol type="1">
<li>如果n=1，则 φ(1) = 1 。因为1与任何数都构成互质关系。</li>
<li>如果n是质数，则 φ(n)=n-1 。因为质数与小于它的每一个数，都构成互质关系。比如5与1、2、3、4都构成互质关系。</li>
<li>如果n是质数的某次方，即 n = p^k (p为质数，k为大于等于1的整数)，则 <span class="math display">\[ φ(p^k) = p^k-p^{k-1}=p^k*(1-\frac{1}{p}) \]</span> 因为只有当一个数不包含质数p，才可能与n互质。而包含质数p的数一共有p<sup>(k-1)个，即1×p、2×p、3×p、…、p</sup>(k-1)×p，把它们去除，剩下的就是与n互质的数。</li>
<li>如果n可以分解成两个互质的整数之积，即n = p1 × p2，则φ(n) = φ(p1p2) = φ(p1)φ(p2)。</li>
</ol>
<h3 id="欧拉定理">欧拉定理</h3>
<p>如果两个正整数a和n互质，则n的欧拉函数 φ(n) 可以让下面的等式成立： <span class="math display">\[ a^{φ(n)}≡1 mod n \]</span> 当n为质数时，欧拉定理可以化为： <span class="math display">\[ a^{n-1}≡1 mod n \]</span> 这就是费马小定理，它是欧拉定理的特例。</p>
<h3 id="模反元素">模反元素</h3>
<p>当ab ≡ 1 mod n时，称b为a的模反元素，也称b为a在模n域下的逆。</p>
<h2 id="rsa公私钥生成">RSA公私钥生成</h2>
<ol type="1">
<li>加密者随机选择两个足够大的质数p和q（实际中通常选择512位）。</li>
<li>计算n = p*q。</li>
<li>计算φ(n) = (p-1)*(q-1)。</li>
<li>随机选择一个小于φ(n)且与φ(n)互质的e。</li>
<li>计算e在模n下的逆d，即e*d ≡ 1 mod φ(n)。</li>
<li>(n, e)封装为公钥，(p, q, d)封装为私钥。</li>
</ol>
<p>至此所有数据计算完成。</p>
<h2 id="加密与解密">加密与解密</h2>
<ol type="1">
<li>将密文转码为十六进制数据m。</li>
<li>c ≡ m^e mod n，c 即为密文。</li>
<li>m ≡ c^d mod n。</li>
</ol>
<h2 id="解密算法证明">解密算法证明</h2>
<p><span class="math display">\[  m^{φ(n)}≡1 modn\ m^{kφ(n)+1}≡m modn\ m^{ed}≡ c^d≡ m modn \]</span></p>
<h2 id="各种题型介绍">各种题型介绍</h2>
<h3 id="已知nec直接分解">已知n,e,c（直接分解）</h3>
<blockquote>
<p>n = 5221752478228507746817749923851271656160818214576859501288944132584319293315684653488045907979899837193635911723726962945029941498626499202969421505409311</p>
</blockquote>
<blockquote>
<p>c = 3508639296102512450759730723246544089341766434632407076573093985251751867216058996957915991315405129764052410967805084651073059790045344575535583118277973</p>
</blockquote>
<blockquote>
<p>e = 65537</p>
</blockquote>
<p>在线分解大整数：<a href="https://security.feishu.cn/link/safety?target=http://www.factordb.com/&amp;scene=ccm&amp;logParams=%7B%22location%22:%22ccm_drive%22%7D&amp;lang=zh-CN">http://www.factordb.com/</a></p>
<p>本地分解：yafu</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">n = <span class="number">5221752478228507746817749923851271656160818214576859501288944132584319293315684653488045907979899837193635911723726962945029941498626499202969421505409311</span></span><br><span class="line">p = <span class="number">72261694404632581565900073275105451175333931206466294424742649423557055375657</span></span><br><span class="line">q = <span class="number">72261694404632581565900073275105451175333931206466294424742649423557055375623</span></span><br><span class="line">c = <span class="number">3508639296102512450759730723246544089341766434632407076573093985251751867216058996957915991315405129764052410967805084651073059790045344575535583118277973</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="keyword">assert</span> n == p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, n)))</span><br></pre></td></tr></table></figure>
<h3 id="已知ncpq爆破e">已知n,c,p,q(爆破e)</h3>
<blockquote>
<p>n = 117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127 c = 41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128 p = 139916095583110895133596833227506693679306709873174024876891023355860781981175916446323044732913066880786918629089023499311703408489151181886568535621008644997971982182426706592551291084007983387911006261442519635405457077292515085160744169867410973960652081452455371451222265819051559818441257438021073941183 q = 842868045681390934539739959201847552284980179958879667933078453950968566151662147267006293571765463137270594151138695778986165111380428806545593588078365331313084230014618714412959584843421586674162688321942889369912392031882620994944241987153078156389470370195514285850736541078623854327959382156753458569</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127</span></span><br><span class="line">c = <span class="number">41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128</span></span><br><span class="line">p = <span class="number">139916095583110895133596833227506693679306709873174024876891023355860781981175916446323044732913066880786918629089023499311703408489151181886568535621008644997971982182426706592551291084007983387911006261442519635405457077292515085160744169867410973960652081452455371451222265819051559818441257438021073941183</span></span><br><span class="line">q = <span class="number">842868045681390934539739959201847552284980179958879667933078453950968566151662147267006293571765463137270594151138695778986165111380428806545593588078365331313084230014618714412959584843421586674162688321942889369912392031882620994944241987153078156389470370195514285850736541078623854327959382156753458569</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">2</span></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):</span><br><span class="line">    <span class="keyword">if</span> isPrime(e):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            d = invert(e, phi)</span><br><span class="line">            flag = long_to_bytes(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line">            flag = <span class="built_in">str</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;CTF&quot;</span> <span class="keyword">in</span> flag <span class="keyword">or</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> flag:</span><br><span class="line">                <span class="built_in">print</span>(e, <span class="string">&#x27;\n&#x27;</span>, flag)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> ZeroDivisionError:</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>
<h3 id="已知necdpdp-d-modp-1">已知n,e,c,dp(dp ≡ d mod(p-1))</h3>
<blockquote>
<p>e = 65537 n = 156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847 c = 108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869 dp = 734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825</p>
</blockquote>
<p>数学推导 $$ 已知dp ≡ d mod (p-1), e*d ≡ 1 mod(p-1)(q-1).<br />
</p>
<p>可得edp ≡ ed mod(p-1).<br />
</p>
<p>展开可得ed = edp +k_1(p-1) = 1 + k_2(p-1)(q-1).<br />
</p>
<p>dp &lt; p-1, e&gt; k_2*(q-1)-k_1. $$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847</span></span><br><span class="line">c = <span class="number">108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869</span></span><br><span class="line">dp = <span class="number">734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">    <span class="keyword">if</span> (e * dp - <span class="number">1</span>) % i == <span class="number">0</span> <span class="keyword">and</span> n % ((e * dp - <span class="number">1</span>) // i + <span class="number">1</span>) == <span class="number">0</span>:</span><br><span class="line">        q = n // ((e * dp - <span class="number">1</span>) // i + <span class="number">1</span>)</span><br><span class="line">        phi = (q - <span class="number">1</span>) * ((e * dp - <span class="number">1</span>) // i)</span><br><span class="line">        d = gmpy2.invert(e, phi)</span><br><span class="line">        m = gmpy2.powmod(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h3 id="提取公钥flag信息">提取公钥/flag信息</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line">path = <span class="string">r&#x27;C:\public.key&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(path) <span class="keyword">as</span> f:</span><br><span class="line">    key = RSA.import_key(f.read())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;e = %d&#x27;</span> % key.e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n = %d&#x27;</span> % key.n)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"><span class="built_in">print</span>(f)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">tmp = <span class="built_in">int</span>.from_bytes(f, byteorder=<span class="string">&#x27;big&#x27;</span>)  <span class="comment"># 高位存储</span></span><br><span class="line"><span class="built_in">print</span>(tmp)</span><br></pre></td></tr></table></figure>
<p>在线工具：<a href="https://security.feishu.cn/link/safety?target=http://www.hiencode.com/pub_asys.html&amp;scene=ccm&amp;logParams=%7B%22location%22:%22ccm_drive%22%7D&amp;lang=zh-CN">http://www.hiencode.com/pub_asys.html</a> 解析公钥</p>
<h3 id="共模攻击">共模攻击</h3>
<blockquote>
<p>n = 22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</p>
</blockquote>
<blockquote>
<p>c1 = 22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361 e1 = 11187289 c2 = 18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397 e2 = 9647291</p>
</blockquote>
<h4 id="数学基础扩展欧几里得算法">数学基础：扩展欧几里得算法</h4>
<p>$$ 扩展欧几里得算法可以在求出a,b的最大公约数的同时，求出满足ax+by = gcd(a, b)的x,y。<br />
</p>
<p>求最大公约数：欧几里得算法(辗转相除)<br />
</p>
<p>在到达辗转相除的递归边界时，b==0，a=gcd(a,b)。这时，a+b*0=gcd(a,b)，x=1,y=0<br />
</p>
<p>从递归的下一层往上一层推导，假设我们已知x_1,y_1使b<em>x_1+(a mod b)</em>y_1=gcd(b, (a mod b))=gcd(a,b)<br />
</p>
<p>首先已知a mod b = a - a // b * b<br />
</p>
<p>带回上一个式子： b<em>x_1 + (a-(a//b)b)y_1= bx_1 + ay_1 – (a//b)by_1= a*y_1 + b</em>(x_1 – (a//b)*y_1) = gcd(a,b)<br />
</p>
<p>x = y_1, y = x_1 - (a//b)*y_1 $$</p>
<h4 id="解题推导">解题推导</h4>
<p><span class="math display">\[ 首先可知gcd(e_1, e_2) = 1，使用扩展欧几里得可以求出满足e_1*s_1+e_2*s_2 = 1的s_1和s_2。\ 又已知c_1 ≡ m^{e_1} mod n, c_2 ≡ m^{e_2} mod n,可得c_1^{s_1}*c_2^{s_2} mod n ≡ m^{(e_1*s_1+e_2*s_2)} ≡ m。 \]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> a, <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x, y = egcd(b, a % b)</span><br><span class="line">        <span class="keyword">return</span> y, x - (a // b) * y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gongmo</span>(<span class="params">n, c1, c2, e1, e2</span>):</span><br><span class="line">    s = egcd(e1, e2)</span><br><span class="line">    s1 = s[<span class="number">0</span>]</span><br><span class="line">    s2 = s[<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># 求模反元素</span></span><br><span class="line">    <span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">        s1 = - s1</span><br><span class="line">        c1 = invert(c1, n)</span><br><span class="line">    <span class="keyword">elif</span> s2 &lt; <span class="number">0</span>:</span><br><span class="line">        s2 = - s2</span><br><span class="line">        c2 = invert(c2, n)</span><br><span class="line">    m = <span class="built_in">pow</span>(c1, s1, n) * <span class="built_in">pow</span>(c2, s2, n) % n</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line">c1 = <span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line">n = <span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line">e1 = <span class="number">11187289</span></span><br><span class="line">c2 = <span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line">e2 = <span class="number">9647291</span></span><br><span class="line">result = gongmo(n, c1, c2, e1, e2)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(result))</span><br></pre></td></tr></table></figure>
<h3 id="广播攻击">广播攻击</h3>
<p>特点：给出多组n,c，使用同一个e加密。</p>
<h4 id="解题思路1遍历每对n寻找是否有公约数">解题思路1：遍历每对n,寻找是否有公约数</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">n = [n0, n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12, n13, n14, n15, n16, n17, n18, n19]</span><br><span class="line">c = [c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">        <span class="keyword">if</span> i != j:</span><br><span class="line">            <span class="keyword">if</span> gmpy2.gcd(n[i], n[j]) != <span class="number">1</span>:</span><br><span class="line">                <span class="built_in">print</span>(i, j)  <span class="comment"># 输出对应的n的序号</span></span><br><span class="line">                p = gmpy2.gcd(n[i], n[j])</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;p = &quot;</span>, p)</span><br><span class="line">                q = n[i] // p</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;q = &quot;</span>, q)</span><br><span class="line">                d = gmpy2.invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;d = &quot;</span>, d)</span><br><span class="line">                m = <span class="built_in">pow</span>(c[i], d, n[i])</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;m = &quot;</span>, m)</span><br></pre></td></tr></table></figure>
<h4 id="解题思路2中国剩余定理">解题思路2：中国剩余定理</h4>
<h5 id="数学基础-1">数学基础</h5>
<p><span class="math display">\[ 假设整数m_1,m_2,...m_n两两互素，则对于任意的整数a_1,a_2,...a_n，方程组\ \begin{equation} \begin{cases} x ≡ a_1 mod m_1 \ x ≡ a_2 mod m_2 \ ... \ x ≡ a_n mod m_n \end{cases} \end{equation} \]</span></p>
<p><span class="math display">\[ 都存在整数解，若X ,Y都满足该方程组，X ≡ Y modN，其中N=m_1*m_2*...*m_n。具体而言，\ x ≡ \sum_{i=1}^na_i\*\frac{N}{m_i}*[(\frac{N}{m_i})^{-1}]_{m_i}modN \]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line">N1 = <span class="number">331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004</span></span><br><span class="line">c1 = <span class="number">310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243</span></span><br><span class="line"></span><br><span class="line">N2 = <span class="number">302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114</span></span><br><span class="line">c2 = <span class="number">112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344</span></span><br><span class="line"></span><br><span class="line">N3 = <span class="number">332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323</span></span><br><span class="line">c3 = <span class="number">10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242</span></span><br><span class="line"></span><br><span class="line">N = []</span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    <span class="comment"># 将题目给的所有值转成十进制并放进列表中</span></span><br><span class="line">    N.append(<span class="built_in">int</span>(<span class="built_in">str</span>(<span class="built_in">eval</span>(<span class="string">&#x27;N&#x27;</span> + <span class="built_in">str</span>(i + <span class="number">1</span>))), <span class="number">5</span>))</span><br><span class="line">    c.append(<span class="built_in">int</span>(<span class="built_in">str</span>(<span class="built_in">eval</span>(<span class="string">&#x27;c&#x27;</span> + <span class="built_in">str</span>(i + <span class="number">1</span>))), <span class="number">5</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;N&#x27;</span> + <span class="built_in">str</span>(i + <span class="number">1</span>), <span class="string">&#x27;=&#x27;</span>, N[i])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;c&#x27;</span> + <span class="built_in">str</span>(i + <span class="number">1</span>), <span class="string">&#x27;=&#x27;</span>, c[i])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chinese_remainder</span>(<span class="params">modulus, remainders</span>):</span><br><span class="line">    Sum = <span class="number">0</span></span><br><span class="line">    prod = reduce(<span class="keyword">lambda</span> a, b: a * b, modulus)</span><br><span class="line">    <span class="keyword">for</span> m_i, r_i <span class="keyword">in</span> <span class="built_in">zip</span>(modulus, remainders):</span><br><span class="line">        p = prod // m_i</span><br><span class="line">        Sum += r_i * (inverse(p, m_i) * p)</span><br><span class="line">    <span class="keyword">return</span> Sum % prod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"><span class="comment"># print(chinese_remainder(N,c))</span></span><br><span class="line">pow_m_e = chinese_remainder(N, c)</span><br><span class="line"><span class="comment"># pow_m_e = 17446992834638639179129969961058029457462398677361658450137832328330435503838651797276948890990069700515669656391607670623897280684064423087023742140145529356863469816868212911716782075239982647322703714504545802436551322108638975695013439206776300941300053940942685511792851350404139366581130688518772175108412341696958930756520037</span></span><br><span class="line">m = iroot(pow_m_e, <span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h3 id="维纳攻击低解密指数">维纳攻击(低解密指数)</h3>
<h4 id="数学基础连分数展开">数学基础：连分数展开</h4>
<p><span class="math display">\[ a = a_0+\frac{1}{a_1+\frac{1}{a2+\frac{1}{...}}} \]</span></p>
<p>简化为a=[a0;a1,a2,...an]记作对a的连分数展开。</p>
<p>连分数定理： <span class="math display">\[ 当\mid x-\frac{a}{b} \mid&lt;\frac{1}{2b^2}时，\frac{a}{b}是x的一个连分数近似。 \]</span></p>
<h3 id="推导">推导</h3>
<p><span class="math display">\[ 当满足d&lt;\frac{1}{3}N^{\frac{1}{4}}时，一定能分解N。\ 令λ(N)=lcm(p−1,q−1)=\frac{φ(N)}{g}，s = 1-p-q,\ 已知e*d = 1 + k*λ(N),则edg-kN=g+ks.\ 两边同除dgN得\frac{e}{N}-\frac{k}{dg}=(\frac{k}{dg})(\frac{s}{N})+\frac{1}{dN},\ 所以当d&lt;\frac{\sqrt{2}}{2g}N^{\frac{1}{4}}时，\frac{k}{dg}是\frac{e}{N}的连分数近似。 \]</span></p>
<p>脚本：<a href="https://security.feishu.cn/link/safety?target=https://github.com/pablocelayes/rsa-wiener-attack&amp;scene=ccm&amp;logParams=%7B%22location%22:%22ccm_drive%22%7D&amp;lang=zh-CN">GitHub - pablocelayes/rsa-wiener-attack: A Python implementation of the Wiener attack on RSA public-key encryption scheme.</a></p>
<h3 id="多项式rsa">多项式RSA</h3>
<blockquote>
<p>Prime: 43753 Modulus: 34036<em>y^177 + 23068</em>y^176 + 13147<em>y^175 + 36344</em>y^174 + 10045<em>y^173 + 41049</em>y^172 + 17786<em>y^171 + 16601</em>y^170 + 7929<em>y^169 + 37570</em>y^168 + 990<em>y^167 + 9622</em>y^166 + 39273<em>y^165 + 35284</em>y^164 + 15632<em>y^163 + 18850</em>y^162 + 8800<em>y^161 + 33148</em>y^160 + 12147<em>y^159 + 40487</em>y^158 + 6407<em>y^157 + 34111</em>y^156 + 8446<em>y^155 + 21908</em>y^154 + 16812<em>y^153 + 40624</em>y^152 + 43506<em>y^151 + 39116</em>y^150 + 33011<em>y^149 + 23914</em>y^148 + 2210<em>y^147 + 23196</em>y^146 + 43359<em>y^145 + 34455</em>y^144 + 17684<em>y^143 + 25262</em>y^142 + 982<em>y^141 + 24015</em>y^140 + 27968<em>y^139 + 37463</em>y^138 + 10667<em>y^137 + 39519</em>y^136 + 31176<em>y^135 + 27520</em>y^134 + 32118<em>y^133 + 8333</em>y^132 + 38945<em>y^131 + 34713</em>y^130 + 1107<em>y^129 + 43604</em>y^128 + 4433<em>y^127 + 18110</em>y^126 + 17658<em>y^125 + 32354</em>y^124 + 3219<em>y^123 + 40238</em>y^122 + 10439<em>y^121 + 3669</em>y^120 + 8713<em>y^119 + 21027</em>y^118 + 29480<em>y^117 + 5477</em>y^116 + 24332<em>y^115 + 43480</em>y^114 + 33406<em>y^113 + 43121</em>y^112 + 1114<em>y^111 + 17198</em>y^110 + 22829<em>y^109 + 24424</em>y^108 + 16523<em>y^107 + 20424</em>y^106 + 36206<em>y^105 + 41849</em>y^104 + 3584<em>y^103 + 26500</em>y^102 + 31897<em>y^101 + 34640</em>y^100 + 27449<em>y^99 + 30962</em>y^98 + 41434<em>y^97 + 22125</em>y^96 + 24314<em>y^95 + 3944</em>y^94 + 18400<em>y^93 + 38476</em>y^92 + 28904<em>y^91 + 27936</em>y^90 + 41867<em>y^89 + 25573</em>y^88 + 25659<em>y^87 + 33443</em>y^86 + 18435<em>y^85 + 5934</em>y^84 + 38030<em>y^83 + 17563</em>y^82 + 24086<em>y^81 + 36782</em>y^80 + 20922<em>y^79 + 38933</em>y^78 + 23448<em>y^77 + 10599</em>y^76 + 7156<em>y^75 + 29044</em>y^74 + 23605<em>y^73 + 7657</em>y^72 + 28200<em>y^71 + 2431</em>y^70 + 3860<em>y^69 + 23259</em>y^68 + 14590<em>y^67 + 33631</em>y^66 + 15673<em>y^65 + 36049</em>y^64 + 29728<em>y^63 + 22413</em>y^62 + 18602<em>y^61 + 18557</em>y^60 + 23505<em>y^59 + 17642</em>y^58 + 12595<em>y^57 + 17255</em>y^56 + 15316<em>y^55 + 8948</em>y^54 + 38<em>y^53 + 40329</em>y^52 + 9823<em>y^51 + 5798</em>y^50 + 6379<em>y^49 + 8662</em>y^48 + 34640<em>y^47 + 38321</em>y^46 + 18760<em>y^45 + 13135</em>y^44 + 15926<em>y^43 + 34952</em>y^42 + 28940<em>y^41 + 13558</em>y^40 + 42579<em>y^39 + 38015</em>y^38 + 33788<em>y^37 + 12381</em>y^36 + 195<em>y^35 + 13709</em>y^34 + 31500<em>y^33 + 32994</em>y^32 + 30486<em>y^31 + 40414</em>y^30 + 2578<em>y^29 + 30525</em>y^28 + 43067<em>y^27 + 6195</em>y^26 + 36288<em>y^25 + 23236</em>y^24 + 21493<em>y^23 + 15808</em>y^22 + 34500<em>y^21 + 6390</em>y^20 + 42994<em>y^19 + 42151</em>y^18 + 19248<em>y^17 + 19291</em>y^16 + 8124<em>y^15 + 40161</em>y^14 + 24726<em>y^13 + 31874</em>y^12 + 30272<em>y^11 + 30761</em>y^10 + 2296<em>y^9 + 11017</em>y^8 + 16559<em>y^7 + 28949</em>y^6 + 40499<em>y^5 + 22377</em>y^4 + 33628<em>y^3 + 30598</em>y^2 + 4386<em>y + 23814 Ciphertext: 5209</em>x^176 + 10881<em>x^175 + 31096</em>x^174 + 23354<em>x^173 + 28337</em>x^172 + 15982<em>x^171 + 13515</em>x^170 + 21641<em>x^169 + 10254</em>x^168 + 34588<em>x^167 + 27434</em>x^166 + 29552<em>x^165 + 7105</em>x^164 + 22604<em>x^163 + 41253</em>x^162 + 42675<em>x^161 + 21153</em>x^160 + 32838<em>x^159 + 34391</em>x^158 + 832<em>x^157 + 720</em>x^156 + 22883<em>x^155 + 19236</em>x^154 + 33772<em>x^153 + 5020</em>x^152 + 17943<em>x^151 + 26967</em>x^150 + 30847<em>x^149 + 10306</em>x^148 + 33966<em>x^147 + 43255</em>x^146 + 20342<em>x^145 + 4474</em>x^144 + 3490<em>x^143 + 38033</em>x^142 + 11224<em>x^141 + 30565</em>x^140 + 31967<em>x^139 + 32382</em>x^138 + 9759<em>x^137 + 1030</em>x^136 + 32122<em>x^135 + 42614</em>x^134 + 14280<em>x^133 + 16533</em>x^132 + 32676<em>x^131 + 43070</em>x^130 + 36009<em>x^129 + 28497</em>x^128 + 2940<em>x^127 + 9747</em>x^126 + 22758<em>x^125 + 16615</em>x^124 + 14086<em>x^123 + 13038</em>x^122 + 39603<em>x^121 + 36260</em>x^120 + 32502<em>x^119 + 17619</em>x^118 + 17700<em>x^117 + 15083</em>x^116 + 11311<em>x^115 + 36496</em>x^114 + 1300<em>x^113 + 13601</em>x^112 + 43425<em>x^111 + 10376</em>x^110 + 11551<em>x^109 + 13684</em>x^108 + 14955<em>x^107 + 6661</em>x^106 + 12674<em>x^105 + 21534</em>x^104 + 32132<em>x^103 + 34135</em>x^102 + 43684<em>x^101 + 837</em>x^100 + 29311<em>x^99 + 4849</em>x^98 + 26632<em>x^97 + 26662</em>x^96 + 10159<em>x^95 + 32657</em>x^94 + 12149<em>x^93 + 17858</em>x^92 + 35805<em>x^91 + 19391</em>x^90 + 30884<em>x^89 + 42039</em>x^88 + 17292<em>x^87 + 4694</em>x^86 + 1497<em>x^85 + 1744</em>x^84 + 31071<em>x^83 + 26246</em>x^82 + 24402<em>x^81 + 22068</em>x^80 + 39263<em>x^79 + 23703</em>x^78 + 21484<em>x^77 + 12241</em>x^76 + 28821<em>x^75 + 32886</em>x^74 + 43075<em>x^73 + 35741</em>x^72 + 19936<em>x^71 + 37219</em>x^70 + 33411<em>x^69 + 8301</em>x^68 + 12949<em>x^67 + 28611</em>x^66 + 42654<em>x^65 + 6910</em>x^64 + 18523<em>x^63 + 31144</em>x^62 + 21398<em>x^61 + 36298</em>x^60 + 27158<em>x^59 + 918</em>x^58 + 38601<em>x^57 + 4269</em>x^56 + 5699<em>x^55 + 36444</em>x^54 + 34791<em>x^53 + 37978</em>x^52 + 32481<em>x^51 + 8039</em>x^50 + 11012<em>x^49 + 11454</em>x^48 + 30450<em>x^47 + 1381</em>x^46 + 32403<em>x^45 + 8202</em>x^44 + 8404<em>x^43 + 37648</em>x^42 + 43696<em>x^41 + 34237</em>x^40 + 36490<em>x^39 + 41423</em>x^38 + 35792<em>x^37 + 36950</em>x^36 + 31086<em>x^35 + 38970</em>x^34 + 12439<em>x^33 + 7963</em>x^32 + 16150<em>x^31 + 11382</em>x^30 + 3038<em>x^29 + 20157</em>x^28 + 23531<em>x^27 + 32866</em>x^26 + 5428<em>x^25 + 21132</em>x^24 + 13443<em>x^23 + 28909</em>x^22 + 42716<em>x^21 + 6567</em>x^20 + 24744<em>x^19 + 8727</em>x^18 + 14895<em>x^17 + 28172</em>x^16 + 30903<em>x^15 + 26608</em>x^14 + 27314<em>x^13 + 42224</em>x^12 + 42551<em>x^11 + 37726</em>x^10 + 11203<em>x^9 + 36816</em>x^8 + 5537<em>x^7 + 20301</em>x^6 + 17591<em>x^5 + 41279</em>x^4 + 7999<em>x^3 + 33753</em>x^2 + 34551*x + 9659</p>
</blockquote>
<p>分解N为p和q后，p,q的欧拉函数为prime的p和q最高次方-1。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">R.&lt;y&gt; = PolynomialRing(GF(43753))</span><br><span class="line">N = 34036*y^177 + 23068*y^176 + 13147*y^175 + 36344*y^174 + 10045*y^173 + 41049*y^172 + 17786*y^171 + 16601*y^170 + 7929*y^169 + 37570*y^168 + 990*y^167 + 9622*y^166 + 39273*y^165 + 35284*y^164 + 15632*y^163 + 18850*y^162 + 8800*y^161 + 33148*y^160 + 12147*y^159 + 40487*y^158 + 6407*y^157 + 34111*y^156 + 8446*y^155 + 21908*y^154 + 16812*y^153 + 40624*y^152 + 43506*y^151 + 39116*y^150 + 33011*y^149 + 23914*y^148 + 2210*y^147 + 23196*y^146 + 43359*y^145 + 34455*y^144 + 17684*y^143 + 25262*y^142 + 982*y^141 + 24015*y^140 + 27968*y^139 + 37463*y^138 + 10667*y^137 + 39519*y^136 + 31176*y^135 + 27520*y^134 + 32118*y^133 + 8333*y^132 + 38945*y^131 + 34713*y^130 + 1107*y^129 + 43604*y^128 + 4433*y^127 + 18110*y^126 + 17658*y^125 + 32354*y^124 + 3219*y^123 + 40238*y^122 + 10439*y^121 + 3669*y^120 + 8713*y^119 + 21027*y^118 + 29480*y^117 + 5477*y^116 + 24332*y^115 + 43480*y^114 + 33406*y^113 + 43121*y^112 + 1114*y^111 + 17198*y^110 + 22829*y^109 + 24424*y^108 + 16523*y^107 + 20424*y^106 + 36206*y^105 + 41849*y^104 + 3584*y^103 + 26500*y^102 + 31897*y^101 + 34640*y^100 + 27449*y^99 + 30962*y^98 + 41434*y^97 + 22125*y^96 + 24314*y^95 + 3944*y^94 + 18400*y^93 + 38476*y^92 + 28904*y^91 + 27936*y^90 + 41867*y^89 + 25573*y^88 + 25659*y^87 + 33443*y^86 + 18435*y^85 + 5934*y^84 + 38030*y^83 + 17563*y^82 + 24086*y^81 + 36782*y^80 + 20922*y^79 + 38933*y^78 + 23448*y^77 + 10599*y^76 + 7156*y^75 + 29044*y^74 + 23605*y^73 + 7657*y^72 + 28200*y^71 + 2431*y^70 + 3860*y^69 + 23259*y^68 + 14590*y^67 + 33631*y^66 + 15673*y^65 + 36049*y^64 + 29728*y^63 + 22413*y^62 + 18602*y^61 + 18557*y^60 + 23505*y^59 + 17642*y^58 + 12595*y^57 + 17255*y^56 + 15316*y^55 + 8948*y^54 + 38*y^53 + 40329*y^52 + 9823*y^51 + 5798*y^50 + 6379*y^49 + 8662*y^48 + 34640*y^47 + 38321*y^46 + 18760*y^45 + 13135*y^44 + 15926*y^43 + 34952*y^42 + 28940*y^41 + 13558*y^40 + 42579*y^39 + 38015*y^38 + 33788*y^37 + 12381*y^36 + 195*y^35 + 13709*y^34 + 31500*y^33 + 32994*y^32 + 30486*y^31 + 40414*y^30 + 2578*y^29 + 30525*y^28 + 43067*y^27 + 6195*y^26 + 36288*y^25 + 23236*y^24 + 21493*y^23 + 15808*y^22 + 34500*y^21 + 6390*y^20 + 42994*y^19 + 42151*y^18 + 19248*y^17 + 19291*y^16 + 8124*y^15 + 40161*y^14 + 24726*y^13 + 31874*y^12 + 30272*y^11 + 30761*y^10 + 2296*y^9 + 11017*y^8 + 16559*y^7 + 28949*y^6 + 40499*y^5 + 22377*y^4 + 33628*y^3 + 30598*y^2 + 4386*y + 23814</span><br><span class="line">print(factor(N))</span><br><span class="line">S.&lt;x&gt; = R.quotient(N)</span><br><span class="line">e = 65537</span><br><span class="line">phi = (43753^65-1)*(43753^112-1)# phi是不高于P(y)幂级的环内所有多项式中，与P(y)无公因式的其他多项式的个数</span><br><span class="line">d = inverse_mod(e, phi)</span><br><span class="line">c = 5209*x^176 + 10881*x^175 + 31096*x^174 + 23354*x^173 + 28337*x^172 + 15982*x^171 + 13515*x^170 + 21641*x^169 + 10254*x^168 + 34588*x^167 + 27434*x^166 + 29552*x^165 + 7105*x^164 + 22604*x^163 + 41253*x^162 + 42675*x^161 + 21153*x^160 + 32838*x^159 + 34391*x^158 + 832*x^157 + 720*x^156 + 22883*x^155 + 19236*x^154 + 33772*x^153 + 5020*x^152 + 17943*x^151 + 26967*x^150 + 30847*x^149 + 10306*x^148 + 33966*x^147 + 43255*x^146 + 20342*x^145 + 4474*x^144 + 3490*x^143 + 38033*x^142 + 11224*x^141 + 30565*x^140 + 31967*x^139 + 32382*x^138 + 9759*x^137 + 1030*x^136 + 32122*x^135 + 42614*x^134 + 14280*x^133 + 16533*x^132 + 32676*x^131 + 43070*x^130 + 36009*x^129 + 28497*x^128 + 2940*x^127 + 9747*x^126 + 22758*x^125 + 16615*x^124 + 14086*x^123 + 13038*x^122 + 39603*x^121 + 36260*x^120 + 32502*x^119 + 17619*x^118 + 17700*x^117 + 15083*x^116 + 11311*x^115 + 36496*x^114 + 1300*x^113 + 13601*x^112 + 43425*x^111 + 10376*x^110 + 11551*x^109 + 13684*x^108 + 14955*x^107 + 6661*x^106 + 12674*x^105 + 21534*x^104 + 32132*x^103 + 34135*x^102 + 43684*x^101 + 837*x^100 + 29311*x^99 + 4849*x^98 + 26632*x^97 + 26662*x^96 + 10159*x^95 + 32657*x^94 + 12149*x^93 + 17858*x^92 + 35805*x^91 + 19391*x^90 + 30884*x^89 + 42039*x^88 + 17292*x^87 + 4694*x^86 + 1497*x^85 + 1744*x^84 + 31071*x^83 + 26246*x^82 + 24402*x^81 + 22068*x^80 + 39263*x^79 + 23703*x^78 + 21484*x^77 + 12241*x^76 + 28821*x^75 + 32886*x^74 + 43075*x^73 + 35741*x^72 + 19936*x^71 + 37219*x^70 + 33411*x^69 + 8301*x^68 + 12949*x^67 + 28611*x^66 + 42654*x^65 + 6910*x^64 + 18523*x^63 + 31144*x^62 + 21398*x^61 + 36298*x^60 + 27158*x^59 + 918*x^58 + 38601*x^57 + 4269*x^56 + 5699*x^55 + 36444*x^54 + 34791*x^53 + 37978*x^52 + 32481*x^51 + 8039*x^50 + 11012*x^49 + 11454*x^48 + 30450*x^47 + 1381*x^46 + 32403*x^45 + 8202*x^44 + 8404*x^43 + 37648*x^42 + 43696*x^41 + 34237*x^40 + 36490*x^39 + 41423*x^38 + 35792*x^37 + 36950*x^36 + 31086*x^35 + 38970*x^34 + 12439*x^33 + 7963*x^32 + 16150*x^31 + 11382*x^30 + 3038*x^29 + 20157*x^28 + 23531*x^27 + 32866*x^26 + 5428*x^25 + 21132*x^24 + 13443*x^23 + 28909*x^22 + 42716*x^21 + 6567*x^20 + 24744*x^19 + 8727*x^18 + 14895*x^17 + 28172*x^16 + 30903*x^15 + 26608*x^14 + 27314*x^13 + 42224*x^12 + 42551*x^11 + 37726*x^10 + 11203*x^9 + 36816*x^8 + 5537*x^7 + 20301*x^6 + 17591*x^5 + 41279*x^4 + 7999*x^3 + 33753*x^2 + 34551*x + 9659</span><br><span class="line">print(c^d)</span><br><span class="line"># 125*x^62 + 111*x^61 + 114*x^60 + 117*x^59 + 53*x^58 + 51*x^57 + 51*x^56 + 100*x^55 + 106*x^54 + 110*x^53 + 102*x^52 + 106*x^51 + 100*x^50 + 104*x^49 + 101*x^48 + 117*x^47 + 52*x^46 + 52*x^45 + 57*x^44 + 48*x^43 + 50*x^42 + 107*x^41 + 35*x^40 + 101*x^39 + 114*x^38 + 117*x^37 + 99*x^36 + 101*x^35 + 115*x^34 + 110*x^33 + 105*x^32 + 95*x^31 + 116*x^30 + 117*x^29 + 98*x^28 + 95*x^27 + 110*x^26 + 117*x^25 + 102*x^24 + 95*x^23 + 115*x^22 + 105*x^21 + 95*x^20 + 97*x^19 + 101*x^18 + 107*x^17 + 105*x^16 + 95*x^15 + 109*x^14 + 111*x^13 + 114*x^12 + 102*x^11 + 95*x^10 + 65*x^9 + 83*x^8 + 82*x^7 + 123*x^6 + 114*x^5 + 118*x^4 + 101*x^3 + 116*x^2 + 97*x + 119</span><br></pre></td></tr></table></figure>
<h3 id="coppersmith攻击已知p高位">coppersmith攻击:已知p高位</h3>
<h4 id="数学基础格基规约">数学基础：格基规约</h4>
<p><a href="https://security.feishu.cn/link/safety?target=https://blog.csdn.net/qq_42667481/article/details/117883231&amp;scene=ccm&amp;logParams=%7B%22location%22:%22ccm_drive%22%7D&amp;lang=zh-CN">格基规约算法：数学基础_随缘懂点密码学的博客-CSDN博客_格基约化算法</a></p>
<p><a href="https://security.feishu.cn/link/safety?target=https://blog.csdn.net/qq_42667481/article/details/118332181&amp;scene=ccm&amp;logParams=%7B%22location%22:%22ccm_drive%22%7D&amp;lang=zh-CN">格基规约算法：算法详解_随缘懂点密码学的博客-CSDN博客_格基规约</a></p>
<p>[LLL算法在RSA安全分析中的应用][LLL算法在RSA安全性分析中的应用_知网百科 (cnki.net)](https://security.feishu.cn/link/safety?target=https://xuewen.cnki.net/ArticleCatalog.aspx?filename=1013353564.nh&amp;dbtype=CMFD&amp;dbname=CMFD201401&amp;scene=ccm&amp;logParams={"location":"ccm_drive"}&amp;lang=zh-CN)</p>
<p>p为1024位时，需最高知道p的高位的576位，位数不够时需爆破。 <span class="math display">\[ 在这个问题中，我们的目标是找到模N意义下多项式f所有的根，通过LLL算法，我们能找到\ 与该多项式具有相同的根x_0,\ 更小系数，\ 定义在整数域，\ 上的多项式g。从而我们就得到了原多项式在模意义下的整数根. \]</span></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from sage.all import *</span><br><span class="line">n = 25348605574630284342864323710011622959543974652863854537355760576386763162531478272446867731299572532294812374775121121761898206639041068156270466457595336452690367719842145233764550634280981441631262047763246059814963741143303914063537003244814908763379320576260885158458898112416692583017869283284022878603506583499699525249773663841642694427307104140944360804367072787670581252816486834658346431010523135392357008103555699542414687172408709153334263858639251735462278292703380745537045458408951791720967957274781161667526873251066303708008043058246747534357368350540174588670636827470901518225473676343782182718627</span><br><span class="line">p4 =0x3e67e7cacd2584224fb2026b40afbcc4281bd59f72f7801239d95c61c48ded7649924f794592fce806e032f16c2f4a90466905fc30037317074a6424d8bf078e959a1ed2d8e5c000 </span><br><span class="line">e = 0x10001</span><br><span class="line">pbits = 1024</span><br><span class="line">for i in range(0,4096):</span><br><span class="line">    p4=0x3e67e7cacd2584224fb2026b40afbcc4281bd59f72f7801239d95c61c48ded7649924f794592fce806e032f16c2f4a90466905fc30037317074a6424d8bf078e959a1ed2d8e5c000</span><br><span class="line">    p4=p4+int(hex(i),16)</span><br><span class="line">    kbits = pbits - p4.nbits()</span><br><span class="line">    p4 = p4 &lt;&lt; kbits</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    f = x + p4</span><br><span class="line">    roots = f.small_roots(X=2^kbits, beta=0.4)</span><br><span class="line">    if roots:</span><br><span class="line">        p = p4+int(roots[0])</span><br><span class="line">        print( &quot;n: &quot;, n)</span><br><span class="line">        print(&quot;p: &quot;, p)</span><br><span class="line">        print (&quot;q: &quot;, n//p)</span><br><span class="line">        break</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/RSA/" rel="tag"># RSA</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item"></div>
      <div class="post-nav-item">
    <a href="/2022/06/03/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%EF%BC%9A%5Bpasecactf_2019%5Dtornado_casino/" rel="next" title="buu刷题记录：[pasecactf_2019]tornado_casino">
      buu刷题记录：[pasecactf_2019]tornado_casino <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#rsa%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.</span> <span class="nav-text">RSA介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80"><span class="nav-number">1.1.</span> <span class="nav-text">数学基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E8%BF%90%E7%AE%97%E4%B8%8E%E5%90%8C%E4%BD%99%E5%BC%8F"><span class="nav-number">1.1.1.</span> <span class="nav-text">模运算与同余式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%92%E8%B4%A8%E5%85%B3%E7%B3%BB"><span class="nav-number">1.1.2.</span> <span class="nav-text">互质关系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0"><span class="nav-number">1.1.3.</span> <span class="nav-text">欧拉函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AC%A7%E6%8B%89%E5%AE%9A%E7%90%86"><span class="nav-number">1.1.4.</span> <span class="nav-text">欧拉定理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%8F%8D%E5%85%83%E7%B4%A0"><span class="nav-number">1.1.5.</span> <span class="nav-text">模反元素</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rsa%E5%85%AC%E7%A7%81%E9%92%A5%E7%94%9F%E6%88%90"><span class="nav-number">1.2.</span> <span class="nav-text">RSA公私钥生成</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86"><span class="nav-number">1.3.</span> <span class="nav-text">加密与解密</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95%E8%AF%81%E6%98%8E"><span class="nav-number">1.4.</span> <span class="nav-text">解密算法证明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%84%E7%A7%8D%E9%A2%98%E5%9E%8B%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.5.</span> <span class="nav-text">各种题型介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%B2%E7%9F%A5nec%E7%9B%B4%E6%8E%A5%E5%88%86%E8%A7%A3"><span class="nav-number">1.5.1.</span> <span class="nav-text">已知n,e,c（直接分解）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%B2%E7%9F%A5ncpq%E7%88%86%E7%A0%B4e"><span class="nav-number">1.5.2.</span> <span class="nav-text">已知n,c,p,q(爆破e)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%B2%E7%9F%A5necdpdp-d-modp-1"><span class="nav-number">1.5.3.</span> <span class="nav-text">已知n,e,c,dp(dp ≡ d mod(p-1))</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%90%E5%8F%96%E5%85%AC%E9%92%A5flag%E4%BF%A1%E6%81%AF"><span class="nav-number">1.5.4.</span> <span class="nav-text">提取公钥&#x2F;flag信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="nav-number">1.5.5.</span> <span class="nav-text">共模攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95"><span class="nav-number">1.5.5.1.</span> <span class="nav-text">数学基础：扩展欧几里得算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E9%A2%98%E6%8E%A8%E5%AF%BC"><span class="nav-number">1.5.5.2.</span> <span class="nav-text">解题推导</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB"><span class="nav-number">1.5.6.</span> <span class="nav-text">广播攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF1%E9%81%8D%E5%8E%86%E6%AF%8F%E5%AF%B9n%E5%AF%BB%E6%89%BE%E6%98%AF%E5%90%A6%E6%9C%89%E5%85%AC%E7%BA%A6%E6%95%B0"><span class="nav-number">1.5.6.1.</span> <span class="nav-text">解题思路1：遍历每对n,寻找是否有公约数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF2%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86"><span class="nav-number">1.5.6.2.</span> <span class="nav-text">解题思路2：中国剩余定理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-1"><span class="nav-number">1.5.6.2.1.</span> <span class="nav-text">数学基础</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%B4%E7%BA%B3%E6%94%BB%E5%87%BB%E4%BD%8E%E8%A7%A3%E5%AF%86%E6%8C%87%E6%95%B0"><span class="nav-number">1.5.7.</span> <span class="nav-text">维纳攻击(低解密指数)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E8%BF%9E%E5%88%86%E6%95%B0%E5%B1%95%E5%BC%80"><span class="nav-number">1.5.7.1.</span> <span class="nav-text">数学基础：连分数展开</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A8%E5%AF%BC"><span class="nav-number">1.5.8.</span> <span class="nav-text">推导</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Frsa"><span class="nav-number">1.5.9.</span> <span class="nav-text">多项式RSA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#coppersmith%E6%94%BB%E5%87%BB%E5%B7%B2%E7%9F%A5p%E9%AB%98%E4%BD%8D"><span class="nav-number">1.5.10.</span> <span class="nav-text">coppersmith攻击:已知p高位</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E6%A0%BC%E5%9F%BA%E8%A7%84%E7%BA%A6"><span class="nav-number">1.5.10.1.</span> <span class="nav-text">数学基础：格基规约</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="sha&blog"
      src="/images/111.jpg">
  <p class="site-author-name" itemprop="name">sha&blog</p>
  <div class="site-description" itemprop="description">请务必休息一天</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">sha&blog</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">37k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">41 分钟</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

</body>
</html>
